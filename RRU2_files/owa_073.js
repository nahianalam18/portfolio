self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.WorkloadScenarioSettings.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[460],{2374:function(e,t,n){"use strict";n.r(t);var r=n(3897);n.d(t,"loadWorkloadScenarioSettings",function(){return r.a});n(5764),n(4468),n(4711)},2444:function(e,t,n){"use strict";function r(e){void 0===e&&(e={}),function(e){e.timeBetweenRetryInMS=e.timeBetweenRetryInMS||function(){return 6e4}}(e);var t=e.maximumAttempts,n=e.timeBetweenRetryInMS;return function(e){var r=0,a=!1,i=function(c,u){a?u(new Error("The function retry was cancelled")):(r++,e().then(function(e){return c(e)}).catch(function(e){t&&r>=t?u(e):setTimeout(function(){return i(c,u)},n(r))}))};return{retriableFunc:function(){return new Promise(function(e,t){return i(e,t)})},cancel:function(){return a=!0}}}}function a(e){return function(t){return Math.pow(2,t)*e}}n.d(t,"b",function(){return r}),n.d(t,"a",function(){return a})},356:function(e,t,n){"use strict";t.a=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},3897:function(e,t,n){"use strict";var r=n(0),a=n(2),i=Object(a.action)("LOAD_WORKLOAD_SCENARIO_SETTINGS"),c=Object(a.action)("WORKLOAD_SCENARIO_SETTINGS_LOADED",function(e){return{settings:e}}),u=Object(a.action)("LOADING_WORKLOAD_SCENARIO_SETTINGS_FAILED"),o=n(65);function s(e){switch(e){case 1:return"Mail";case 2:return"Calendar";case 64:return"FilesHub";case 4:return"People";default:throw new Error("getWorkloadScenarioType: The workload type is not supported")}}var l="ows/beta/ScenarioSettings";var d=71;function f(e){return 0!=(e&d)}var v=n(392);function b(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n,a,i,c;return r.__generator(this,function(r){switch(r.label){case 0:return e=["Owa"],f(t=Object(v.b)())&&(n=s(t),e.push(n)),a=function(e){var t=e.join(",");return l+"/?Scenarios="+t}(e),[4,Object(o.b)(a,void 0,void 0,void 0,!0,void 0,"GET_WORKLOAD_SCENARIO_SETTINGS")];case 1:return i=r.sent(),c={timePanelSelectedView:null,timePanelCalendarIds:[],timePanelSelectedCalendarView:null},i.settings&&i.settings.forEach(function(e){var t;(t=e).calendarIds&&"TimePanelCalendarIds"===t.settingName?c.timePanelCalendarIds=e.calendarIds:!function(e){return!!e.selectedView&&"TimePanelSelectedView"===e.settingName}(e)?function(e){return!!e.selectedView&&"SelectedCalendarListView"===e.settingName}(e)&&(c.timePanelSelectedCalendarView=e.selectedView):c.timePanelSelectedView=e.selectedView}),[2,c]}})})}var w=n(2444),O=Object(w.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(w.a)(1e4)}),m=null;Object(a.orchestrator)(i,function(){return r.__awaiter(void 0,void 0,void 0,function(){var e;return r.__generator(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),m&&m.cancel(),[4,(m=O(b)).retriableFunc()];case 1:return e=t.sent(),c(e),[3,3];case 2:return t.sent(),u(),[3,3];case 3:return m=null,[2]}})})});function p(e,t){return l+"/"+e+"/"+t}function S(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,a,i;return r.__generator(this,function(r){switch(r.label){case 0:return f(t=Object(v.b)())?(n=s(t),a=p(n,"TimePanelSelectedView"),i={ViewType:e},[4,Object(o.c)(a,i,void 0,void 0,void 0,!0,void 0)]):[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}})})}function j(e,t){return r.__awaiter(this,void 0,void 0,function(){var t,n;return r.__generator(this,function(r){switch(r.label){case 0:return t=p("Owa","TimePanelCalendarIds"),n={CalendarIds:e},[4,Object(o.c)(t,n,void 0,void 0,void 0,!0,void 0)];case 1:return r.sent(),[2]}})})}function h(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,a,i;return r.__generator(this,function(r){switch(r.label){case 0:return f(t=Object(v.b)())?(n=s(t),a=p(n,"SelectedCalendarListView"),i={ViewType:e},[4,Object(o.c)(a,i,void 0,void 0,void 0,!0,void 0)]):[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}})})}n.d(t,"a",function(){return i}),n.d(t,"e",function(){return c}),n.d(t,"d",function(){return S}),n.d(t,"c",function(){return j}),n.d(t,"b",function(){return h})},421:function(e,t,n){"use strict";var r=n(478).a.Symbol;t.a=r},4468:function(e,t,n){"use strict";var r=n(3897),a=n(2);function i(e,t){if(0===t.length)return null;t[t.length-1]=e}var c=n(392),u=Object(a.createStore)("timePanelSettingStore",{panelViewStack:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return{stack:e||[]}}(2!==Object(c.b)()?"Calendar":"Tasks")});Object(a.mutator)(r.e,function(e){var t=e.settings;t.timePanelSelectedView&&i(t.timePanelSelectedView,u().panelViewStack.stack)});var o=Object(a.action)("pushTimePanelView",function(e){return{newView:e}}),s=Object(a.action)("updateTopTimePanelView",function(e){return{updatedView:e}}),l=Object(a.action)("popTimePanelView");Object(a.mutator)(o,function(e){var t;t=e.newView,u().panelViewStack.stack.push(t)}),Object(a.mutator)(s,function(e){i(e.updatedView,u().panelViewStack.stack)}),Object(a.mutator)(l,function(){var e=u().panelViewStack;e.stack.pop()});var d=n(0),f=n(2444),v=n(11),b=Object(f.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(f.a)(1e3)}),w=null;Object(a.orchestrator)(s,function(e){return d.__awaiter(void 0,void 0,void 0,function(){var t,n;return d.__generator(this,function(a){switch(a.label){case 0:if(t=e.updatedView,"Tasks"!==(i=t)&&"Calendar"!==i)return[3,5];a.label=1;case 1:return a.trys.push([1,3,,4]),w&&w.cancel(),[4,(w=b(function(){return Object(r.d)(t)})).retriableFunc()];case 2:return a.sent(),[3,4];case 3:return n=a.sent(),v.d.warn("viewStackOrchestrator: updateTimePanelSelectedViewService with retry failed: "+n),[3,4];case 4:w=null,a.label=5;case 5:return[2]}var i})})});var O={Conflicts:"Calendar",EventDetails:"Calendar",AttendeeTracking:"Calendar",Calendar:"Calendar",ComposeForm:"Calendar",Tasks:"Tasks"};function m(e){return e?O[e]:null}function p(){return m(S())}function S(){var e,t=u().panelViewStack;return 0===(e=t.stack).length?null:e[e.length-1]}function j(){return u().panelViewStack.stack.length}function h(){return-1!==u().panelViewStack.stack.indexOf("Conflicts")}function _(){return-1!==u().panelViewStack.stack.indexOf("AttendeeTracking")}function g(){var e=u().panelViewStack;return j()>=2?e.stack[j()-2]:null}n.d(t,"i",function(){return o}),n.d(t,"j",function(){return s}),n.d(t,"h",function(){return l}),n.d(t,"b",function(){return p}),n.d(t,"a",function(){return S}),n.d(t,"e",function(){return j}),n.d(t,"g",function(){return h}),n.d(t,"f",function(){return _}),n.d(t,"d",function(){return g}),n.d(t,"c",function(){return m})},4711:function(e,t,n){"use strict";var r=n(2),a=Object(r.action)("updateSelectedCalendarView",function(e){return{updatedView:e}}),i=Object(r.createStore)("calendarListSettingsStore",{selectedView:"Agenda"});function c(){return i().selectedView}var u=Object(r.action)("updateSelectedCalendarViewInStore",function(e){return{updatedView:e}}),o=(Object(r.mutator)(u,function(e){var t=e.updatedView;i().selectedView=t}),n(0)),s=n(3897),l=n(2444),d=n(11),f=Object(l.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(l.a)(1e3)}),v=null;Object(r.orchestrator)(a,function(e){return o.__awaiter(void 0,void 0,void 0,function(){var t,n;return o.__generator(this,function(r){switch(r.label){case 0:t=e.updatedView,u(t),r.label=1;case 1:return r.trys.push([1,3,,4]),v&&v.cancel(),[4,(v=f(function(){return Object(s.b)(t)})).retriableFunc()];case 2:return r.sent(),[3,4];case 3:return n=r.sent(),d.d.warn("updateSelectedCalendarViewOrchestrator: updateSelectedCalendarView with retry failed: "+n),[3,4];case 4:return v=null,[2]}})})});Object(r.orchestrator)(s.e,function(e){var t=e.settings;t.timePanelSelectedCalendarView&&u(t.timePanelSelectedCalendarView)});n.d(t,"b",function(){return a}),n.d(t,"a",function(){return c})},478:function(e,t,n){"use strict";var r=n(950),a="object"==typeof self&&self&&self.Object===Object&&self,i=r.a||a||Function("return this")();t.a=i},523:function(e,t,n){"use strict";var r=n(356),a=n(848),i=n(892),c="Expected a function",u=Math.max,o=Math.min;t.a=function(e,t,n){var s,l,d,f,v,b,w=0,O=!1,m=!1,p=!0;if("function"!=typeof e)throw new TypeError(c);function S(t){var n=s,r=l;return s=l=void 0,w=t,f=e.apply(r,n)}function j(e){var n=e-b;return void 0===b||n>=t||n<0||m&&e-w>=d}function h(){var e=Object(a.a)();if(j(e))return _(e);v=setTimeout(h,function(e){var n=t-(e-b);return m?o(n,d-(e-w)):n}(e))}function _(e){return v=void 0,p&&s?S(e):(s=l=void 0,f)}function g(){var e=Object(a.a)(),n=j(e);if(s=arguments,l=this,b=e,n){if(void 0===v)return function(e){return w=e,v=setTimeout(h,t),O?S(e):f}(b);if(m)return v=setTimeout(h,t),S(b)}return void 0===v&&(v=setTimeout(h,t)),f}return t=Object(i.a)(t)||0,Object(r.a)(n)&&(O=!!n.leading,d=(m="maxWait"in n)?u(Object(i.a)(n.maxWait)||0,t):d,p="trailing"in n?!!n.trailing:p),g.cancel=function(){void 0!==v&&clearTimeout(v),w=0,s=b=l=v=void 0},g.flush=function(){return void 0===v?f:_(Object(a.a)())},g}},5537:function(e,t,n){"use strict";var r=n(0),a=n(34),i=n(41),c=n(1112),u=n(865);function o(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n,o;return r.__generator(this,function(r){switch(r.label){case 0:return e=0,(t=Object(c.a)()).forEach(function(t,n){t&&(e+=t.length)}),0!=e?[3,2]:(n=Object(a.e)().primarySmtpAddress,[4,Object(u.c)(u.a.Outlook)]);case 1:r.sent(),(o=Object(i.u)(n))&&t.set(n,[o.id.id]),r.label=2;case 2:return[2,t]}})})}n.d(t,"a",function(){return o})},5764:function(e,t,n){"use strict";var r=n(2),a=Object(r.action)("UPDATE_SELECTED_TIME_PANEL_CALENDARIDS",function(e,t){return{calendarIds:e,primarySmtpAddress:t}}),i=Object(r.action)("ON_SELECTED_TIME_PANEL_CALENDARIDS_UPDATED",function(e,t){return{calendarIds:e,primarySmtpAddress:t}}),c=n(0),u=n(7),o=Object(r.createStore)("timePanelSelectedCalendarIdsStore",{calendarIdsMap:new u.ObservableMap});function s(){var e,t,n=o().calendarIdsMap,r=0;try{for(var a=c.__values(n.values()),i=a.next();!i.done;i=a.next()){var u=i.value;u&&(r+=u.length)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}return r>0}var l=n(971),d=(Object(r.orchestrator)(l.c,function(e){var t=e.calendarIds,n=e.primarySmtpAddress;s()||i(t,n)}),n(2444)),f=n(3897),v=n(11),b=Object(d.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(d.a)(1e3)}),w=null,O=(Object(r.orchestrator)(a,function(e){return c.__awaiter(void 0,void 0,void 0,function(){var t,n,r;return c.__generator(this,function(a){switch(a.label){case 0:t=e.calendarIds,n=e.primarySmtpAddress,a.label=1;case 1:return a.trys.push([1,3,,4]),w&&w.cancel(),[4,(w=b(function(){return Object(f.c)(t,n)})).retriableFunc()];case 2:return a.sent(),i(t,n),[3,4];case 3:return r=a.sent(),v.d.warn("updateSelectedCalendarIdsOrchestrator: updateTimePanelCalendarIdsService with retry failed: "+r),[3,4];case 4:return w=null,[2]}})})}),n(25)),m=(Object(r.mutator)(f.e,function(e){var t=e.settings;t.timePanelCalendarIds&&t.timePanelCalendarIds.length>0&&o().calendarIdsMap.set(Object(O.i)(),t.timePanelCalendarIds)}),Object(r.mutator)(a,function(e){var t=e.calendarIds,n=e.primarySmtpAddress;o().calendarIdsMap.set(n,t)}),n(5537));function p(){return c.__awaiter(this,void 0,void 0,function(){var e;return c.__generator(this,function(t){switch(t.label){case 0:return s()?(e=o().calendarIdsMap,[2,Promise.resolve(e)]):[3,1];case 1:return[4,Object(m.a)()];case 2:return[2,t.sent()]}})})}n.d(t,"b",function(){return i}),n.d(t,"a",function(){return p})},613:function(e,t,n){"use strict";t.a=function(e){return null!=e&&"object"==typeof e}},645:function(e,t,n){"use strict";var r=n(421),a=Object.prototype,i=a.hasOwnProperty,c=a.toString,u=r.a?r.a.toStringTag:void 0;var o=function(e){var t=i.call(e,u),n=e[u];try{e[u]=void 0;var r=!0}catch(e){}var a=c.call(e);return r&&(t?e[u]=n:delete e[u]),a},s=Object.prototype.toString;var l=function(e){return s.call(e)},d="[object Null]",f="[object Undefined]",v=r.a?r.a.toStringTag:void 0;t.a=function(e){return null==e?void 0===e?f:d:v&&v in Object(e)?o(e):l(e)}},848:function(e,t,n){"use strict";var r=n(478);t.a=function(){return r.a.Date.now()}},871:function(e,t,n){"use strict";var r=n(645),a=n(613),i="[object Symbol]";t.a=function(e){return"symbol"==typeof e||Object(a.a)(e)&&Object(r.a)(e)==i}},892:function(e,t,n){"use strict";var r=n(356),a=n(871),i=NaN,c=/^\s+|\s+$/g,u=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,s=/^0o[0-7]+$/i,l=parseInt;t.a=function(e){if("number"==typeof e)return e;if(Object(a.a)(e))return i;if(Object(r.a)(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Object(r.a)(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(c,"");var n=o.test(e);return n||s.test(e)?l(e.slice(2),n?2:8):u.test(e)?i:+e}},950:function(e,t,n){"use strict";(function(e){var n="object"==typeof e&&e&&e.Object===Object&&e;t.a=n}).call(this,n(101))}},0,[514,105,24,116,495]]);
//# sourceMappingURL=owa.WorkloadScenarioSettings.js.map
self.scriptsLoaded['owa.WorkloadScenarioSettings.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.WorkloadScenarioSettings.js'] = (new Date()).getTime();