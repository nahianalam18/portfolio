self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.SharingData.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[413],{11558:function(e,n,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=i(56),t=i(8842);n.default=function(e,n){return void 0===e||e.__type||(e=t.default(e)),r.makeServiceRequest("GetSharingInformation",e,n)}},11559:function(e){e.exports={b:"rza",a:"sza"}},11560:function(e){e.exports={h:"cza",i:"dza",j:"eza",d:"fza",k:"gza",e:"hza",g:"iza",n:"jza",o:"kza",f:"lza",l:"mza",m:"nza",a:"oza",c:"pza",b:"qza"}},2441:function(e,n,i){"use strict";var r;i.d(n,"a",function(){return r}),function(e){e[e.None=0]="None",e[e.InProgress=1]="InProgress",e[e.Failed=2]="Failed",e[e.SucceededWithDLOrGroupMembers=3]="SucceededWithDLOrGroupMembers",e[e.SucceededWithoutDLOrGroupMembers=4]="SucceededWithoutDLOrGroupMembers"}(r||(r={}))},3623:function(e,n,i){"use strict";var r;i.d(n,"a",function(){return r}),function(e){e[e.None=0]="None",e[e.To=1]="To",e[e.Cc=2]="Cc",e[e.Bcc=3]="Bcc"}(r||(r={}))},4464:function(e,n,i){"use strict";i.r(n);var r=i(0),t=i(65),a="ows/api/beta/sharinglink/info";function s(e,n){return void 0===n&&(n=!1),r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(i){switch(i.label){case 0:return[4,Object(t.d)(a,{url:e},void 0,n)];case 1:return[2,i.sent()]}})})}var o,c,u=i(75),l=i(6),f=i(207),d=i(8842),g=i.n(d),h=i(7732),m=i.n(h),p=i(11558),b=i.n(p),S=i(11);function O(e){return Object(l.e)("doc-attachment-sharingLinkInfoOWSPrimeService")?function(e){return r.__awaiter(this,void 0,void 0,function(){var n,i,t,a,u,l,d,g,h,p,b,O;return r.__generator(this,function(j){switch(j.label){case 0:return[4,s(e,!0)];case 1:return n=j.sent(),Object(f.a)(n.status)?(a=(t=JSON).parse,[4,n.text()]):[3,3];case 2:if(function(e){return e.providerType===o.OneDrivePro}(i=a.apply(t,[j.sent()])))return u=r.__read(i.sharingLinks.filter(function(e){return e.type===c.AnonymousEdit}),1),l=u[0],d=r.__read(i.sharingLinks.filter(function(e){return e.type===c.AnonymousView}),1),g=d[0],h=r.__read(i.sharingLinks.filter(function(e){return e.type===c.OrganizationEdit}),1),p=h[0],b=r.__read(i.sharingLinks.filter(function(e){return e.type===c.OrganizationView}),1),O=b[0],[2,m()({AccessRequestMode:i.accessRequestMode,AnonymousEditLink:l?l.url:void 0,AnonymousViewLink:g?g.url:void 0,CanCreateAnonymousEditLink:i.canCreateAnonymousEditLink,CanCreateAnonymousViewLink:i.canCreateAnonymousViewLink,CanCreateOrganizationEditLink:i.canCreateOrganizationEditLink,CanCreateOrganizationViewLink:i.canCreateOrganizationViewLink,CanShareExternally:i.canShareExternally,CanShareInternally:i.canShareInternally,CanonicalUrl:i.canonicalUrl,ExpirationDate:i.expirationTime,FileName:i.name,IsAnonymousEditLinkAvailable:!!l,IsAnonymousViewLinkAvailable:!!g,IsOrganizationEditLinkAvailable:!!p,IsOrganizationViewLinkAvailable:!!O,MimeType:void 0,OrganizationEditLink:p?p.url:void 0,OrganizationViewLink:O?O.url:void 0,ResultCode:0,SharingLinkKind:v(i.linkType)})];throw new Error("Invalid response from OWS` from sharing link info");case 3:return 404===n.status?[2,m()({ResultCode:4})]:400===n.status?[2,m()({ResultCode:24})]:(S.d.warn("Invalid response for OWS' get share info. Status code: "+n.status),[2,m()({ResultCode:1})]);case 4:return[2]}})})}(e):b()(function(e){return g()({attachmentUrl:e})}(e))}function v(e){switch(e){case c.None:return 0;case c.View:case c.Edit:return 1;case c.AnonymousView:return 4;case c.AnonymousEdit:return 5;case c.OrganizationView:return 2;case c.OrganizationEdit:return 3;default:return Object(u.a)(e)}}!function(e){e.OneDrivePro="OneDrivePro"}(o||(o={})),function(e){e.None="None",e.View="View",e.Edit="Edit",e.AnonymousView="AnonymousView",e.AnonymousEdit="AnonymousEdit",e.OrganizationView="OrganizationView",e.OrganizationEdit="OrganizationEdit"}(c||(c={}));var j=i(4),L=i(11559),x=i(3545);var I=i(6275),y=i(5418),E=i(3668);function P(e,n,i){if(1!==e.length||null===i)return null;switch(n){case x.a.noPermissionToShare:case x.a.noPermissionToShareExternally:case x.a.externalRecipientCSL:case x.a.sharingWithLargeDL:return e[0].supportsDownsell?[i(e[0].id)]:null;case x.a.getSharingInfoFailed:case x.a.noPermissionSet:return null;case x.a.linkHasExpired:case x.a.linkWillExpire:return function(e){return[{text:Object(j.a)(y.a),action:function(){Object(E.a)(e.id)}},{text:Object(j.a)(I.a),action:function(){e.sharingTipsIgnored.push(x.a.linkHasExpired),e.sharingTipsIgnored.push(x.a.linkWillExpire)}}]}(e[0]);default:return Object(u.a)(n)}}var k=i(518);function w(e,n){return n.filter(function(e){return e.externalMemberCount>0}).length>0&&e.sharingInfo&&!e.sharingInfo.canShareExternally&&(2===e.currentPermissionLevel||1===e.currentPermissionLevel)}var C=i(3566);function A(e){return e.some(function(e){return e.totalMemberCount>C.g})}function F(e,n){return A(n)&&e.sharingInfo&&(2===e.currentPermissionLevel||1===e.currentPermissionLevel)}function T(e){return e.sharingInfo&&!e.sharingInfo.getSharingInfoSucceeded}function R(e,n){return n.filter(function(e){return e.externalMemberCount>0}).length>0&&(6===e.currentPermissionLevel||5===e.currentPermissionLevel)}var z=i(5);function _(e){return e&&e.sharingInfo&&!!e.sharingInfo.expirationDate&&Object(z.Bb)(e.sharingInfo.expirationDate,Object(z.Jb)())}function D(e){return e&&e.sharingInfo&&!!e.sharingInfo.expirationDate&&Object(z.zb)(e.sharingInfo.expirationDate,Object(z.Jb)())}var W=i(3656);function M(e){return e.recipientPermissionInfos.some(function(e){return e.getPermissionInfoStatus===W.a.Failed})}var V=i(4545);function G(e){switch(e){case C.m:case C.l:case C.c:case C.o:return!0;default:return!1}}function N(e){return e.filter(function(e){return e.totalMemberCount<=C.g&&G(e.recipient.persona.EmailAddress.MailboxType)})}function H(e){return N(e).some(function(e){return e.recipient.expansionStatus===V.a.Failed||e.recipient.expansionStatus===V.a.SucceededWithDLOrGroupMembers})}function q(e,n){return U(e.sharingRecipientsInfo,n)?0===e.currentPermissionLevel&&e.sharingInfo&&e.sharingInfo.getSharingInfoSucceeded:0===e.currentPermissionLevel&&e.sharingRecipientsInfo.recipientPermissionInfos.some(function(e){return!e.hasAccess&&e.getPermissionInfoStatus===W.a.Succeeded})||(1===e.currentPermissionLevel||2===e.currentPermissionLevel)&&function(e){return e.recipientPermissionInfos.some(function(e){return!e.hasAccess&&!e.canHaveAccess&&e.getPermissionInfoStatus===W.a.Succeeded})}(e.sharingRecipientsInfo)}function U(e,n){return!Object(l.e)("doc-attachment-contextualSharingTips")||A(n)||H(n)||M(e)}function B(e){return e.sharingInfo&&e.sharingInfo.getSharingInfoSucceeded&&!e.sharingInfo.canShareInternally&&(2===e.currentPermissionLevel||1===e.currentPermissionLevel)}var J=i(3667);var Y=i(18),$=i(11560);var K=function(e){return e?e.filter(function(e){return e.totalMemberCount>100}).map(function(e){return e.recipient.persona.EmailAddress.Name}).join(", "):""};function Q(e,n,i){if(U(e,n))return Object(j.a)($.o);var r=e.recipientPermissionInfos,t=null,a=!1;if(0===i?(t=r.filter(function(e){return!e.hasAccess&&e.getPermissionInfoStatus===W.a.Succeeded}),Object(Y.o)("RecipientCanNotAccess",{numOfRecipients:t.length})):1!==i&&2!==i||(a=!0,t=r.filter(function(e){return!e.hasAccess&&!e.canHaveAccess&&e.getPermissionInfoStatus===W.a.Succeeded}),Object(Y.o)("RecipientCanNotHaveAccess",{numOfRecipients:t.length})),null!==t){var s=t.length,o=function(e){return e.map(function(e){return e.name?e.name:e.emailAddress}).join(", ")}(t.slice(0,3));return 1===s?Object(j.b)(Object(j.a)(a?$.c:$.l),o,"{0}"):s<4?Object(j.b)(Object(j.a)(a?$.c:$.m),o,"{0}"):Object(j.b)(Object(j.a)(a?$.b:$.a),o,"{0}")}return Object(j.a)($.o)}function X(e,n,i,r,t){if(!function(e){switch(e){case x.a.noPermissionToShare:case x.a.noPermissionToShareExternally:case x.a.externalRecipientCSL:case x.a.noPermissionSet:case x.a.sharingWithLargeDL:return!0;case x.a.getSharingInfoFailed:return Object(l.e)("doc-attachment-sharingInfoFailureTip");case x.a.linkWillExpire:case x.a.linkHasExpired:return Object(l.e)("doc-attachment-contextualSharingTips");default:return Object(u.a)(e)}}(n))return null;var a=function(e){switch(e){case x.a.noPermissionToShare:return B;case x.a.getSharingInfoFailed:return T;case x.a.linkHasExpired:return _;case x.a.linkWillExpire:return D;case x.a.externalRecipientCSL:return R;case x.a.noPermissionToShareExternally:return w;case x.a.noPermissionSet:return q;case x.a.sharingWithLargeDL:return F;default:return Object(u.a)(e)}}(n),s=e.filter(function(e){return a(e,i)});if(0===s.length)return null;var o=s.filter(function(e){return!Object(j.g)(e.name)}).map(function(e){return e.name}).join(", "),c=function(e,n,i){switch(e){case x.a.noPermissionToShare:return{singleFile:Object(j.a)($.h),multipleFiles:Object(j.a)($.h)};case x.a.getSharingInfoFailed:return{singleFile:Object(j.a)($.i),multipleFiles:Object(j.a)($.i)};case x.a.linkHasExpired:return{singleFile:Object(j.a)($.j),multipleFiles:Object(j.a)($.d)};case x.a.linkWillExpire:return{singleFile:Object(j.a)($.k),multipleFiles:Object(j.a)($.e)};case x.a.noPermissionToShareExternally:return{singleFile:Object(j.a)($.g),multipleFiles:Object(j.a)($.g)};case x.a.externalRecipientCSL:return{singleFile:Object(j.a)($.n),multipleFiles:Object(j.a)($.n)};case x.a.noPermissionSet:return{singleFile:Q(i[0].sharingRecipientsInfo,n,i[0].currentPermissionLevel),multipleFiles:Object(j.a)($.o)};case x.a.sharingWithLargeDL:var r=K(n);return{singleFile:Object(j.b)(Object(j.a)($.f),r,"{0}","{1}"),multipleFiles:Object(j.b)(Object(j.a)($.f),r,"{0}","{1}")};default:return Object(u.a)(e)}}(n,i,s),f=s.length>1?c.multipleFiles:c.singleFile;o&&0!==o.length||!f||0===f.length||S.d.error("file names should not be null or empty if the infobarStringTemplate is not");var d,g=P(s,n,t),h=function(e){switch(e){case x.a.noPermissionToShare:case x.a.noPermissionToShareExternally:return[J.a.ignore,J.a.attachAsACopy];case x.a.getSharingInfoFailed:return[J.a.ignore];case x.a.externalRecipientCSL:case x.a.noPermissionSet:case x.a.sharingWithLargeDL:return[J.a.ignore,J.a.changePermission,J.a.attachAsACopy];case x.a.linkWillExpire:case x.a.linkHasExpired:return[J.a.ignore,J.a.refreshExpiration];default:return Object(u.a)(e)}}(n);if(r||null!==g&&0!==g.length)d=Object(j.b)(f,o);else{var m="",p=function(e){switch(e){case x.a.noPermissionToShare:case x.a.noPermissionToShareExternally:case x.a.externalRecipientCSL:return{singleFile:Object(j.a)(L.b),multipleFiles:Object(j.a)(L.a)};case x.a.getSharingInfoFailed:case x.a.linkHasExpired:case x.a.linkWillExpire:case x.a.noPermissionSet:case x.a.sharingWithLargeDL:return null;default:return Object(u.a)(e)}}(n);null!==p&&(m=s.length>1?p.multipleFiles:p.singleFile),d=Object(j.b)(f,o,m)}return{id:n,sharingTipString:d,actions:g,sharingTipActions:h,messageRank:function(e){switch(e){case x.a.noPermissionToShare:case x.a.noPermissionToShareExternally:case x.a.sharingWithLargeDL:case x.a.linkHasExpired:case x.a.externalRecipientCSL:case x.a.noPermissionSet:return k.b.Error;case x.a.linkWillExpire:case x.a.getSharingInfoFailed:return k.b.Info;default:return Object(u.a)(e)}}(n)}}function Z(e,n,i,r,t){var a=X(e,n,i,r,t);if(null===a)return null;var s={key:n,source:k.c.Compose,rank:a.messageRank,messageParts:[a.sharingTipString]};return null!==a.actions&&a.actions.map(function(e){s.messageParts.push(e)}),function(e){return s}}var ee=new Map;function ne(e){var n=[];ee.has(e)&&(n=ee.get(e)),ie(n,[],e,"deleteLink")}function ie(e,n,i,r){void 0===r&&(r=null);var t=n.filter(function(n){return-1===e.indexOf(n)}),a=e.filter(function(e){return-1===n.indexOf(e)}),s=r||"UnknownActionSource";t.unshift(s),a.unshift(s),t.length>1&&Object(Y.o)("LinkSharingTipsAdded",t,{cosmosOnlyData:i}),a.length>1&&Object(Y.o)("LinkSharingTipsRemoved",a,{cosmosOnlyData:i})}function re(e,n){var i,r,t,a=Object(x.b)().filter(function(n){return-1===e.sharingTipsIgnored.indexOf(n)}).map(function(i){return X([e],i,n,!0)}).filter(function(e){return null!==e});if("string"==typeof e.id){var s=a.map(function(e){return e.id});i=e.id,r=s,t=[],ee.has(i)&&(t=ee.get(i)),ie(t,r,i),ee.set(i,r)}return a}function te(e){switch(e){case C.f:case C.b:case C.i:case C.j:case C.a:case C.d:case C.h:return!0;default:return G(e)||function(e){switch(e){case C.n:case C.k:case C.p:return!0;default:return!1}}(e)||S.d.error("UnknownMailboxType: "+e),!1}}function ae(e){return e.filter(function(e){return e.totalMemberCount===C.e&&te(e.recipient.persona.EmailAddress.MailboxType)})}i.d(n,"getSharingInformation",function(){return O}),i.d(n,"getInfoBarCreator",function(){return Z}),i.d(n,"getSharingIssuesForSharingData",function(){return re}),i.d(n,"hasGetRecipientPermissionFailed",function(){return M}),i.d(n,"hasLargeDLRecipient",function(){return A}),i.d(n,"hasRecipientExpansionFailure",function(){return H}),i.d(n,"getGroupsAndSmallDLs",function(){return N}),i.d(n,"getInvididualRecipients",function(){return ae}),i.d(n,"logSharingTipChangesForLinkRemoval",function(){return ne})},4545:function(e,n,i){"use strict";i.d(n,"c",function(){return o}),i.d(n,"d",function(){return c});var r=i(3),t=i(3623);i.d(n,"b",function(){return t.a});var a=i(2441);i.d(n,"a",function(){return a.a});var s=new r.c(function(){return i.e(381).then(i.bind(null,6574))}),o=new r.a(s,function(e){return e.setMembersToRecipientViewState}),c=new r.a(s,function(e){return e.setRecipientExpansionStatus})},518:function(e,n,i){"use strict";var r,t,a;i.d(n,"c",function(){return r}),i.d(n,"b",function(){return t}),i.d(n,"a",function(){return a}),function(e){e[e.Compose=0]="Compose",e[e.Extensibility=1]="Extensibility",e[e.ReadingPane=2]="ReadingPane",e[e.Fileshub=3]="Fileshub",e[e.Txp=4]="Txp"}(r||(r={})),function(e){e[e.SmimeSignature=0]="SmimeSignature",e[e.Safety=1]="Safety",e[e.Error=2]="Error",e[e.Info=3]="Info",e[e.Encryption=4]="Encryption",e[e.Translation=5]="Translation",e[e.Sensitivity=6]="Sensitivity"}(t||(t={})),function(e){e[e.Grey=0]="Grey",e[e.Red=1]="Red",e[e.Green=2]="Green",e[e.Yellow=3]="Yellow",e[e.Orange=4]="Orange",e[e.Green20=5]="Green20"}(a||(a={}))},5418:function(e){e.exports={a:"uza"}},6275:function(e){e.exports={a:"tza"}},7732:function(e,n,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=i(0);n.default=function(e){return r.__assign({__type:"GetSharingInfoResponse:#Exchange"},e)}},8842:function(e,n,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=i(0);n.default=function(e){return r.__assign({__type:"GetSharingInfoRequest:#Exchange"},e)}}},0,[514,105,24,116]]);
//# sourceMappingURL=owa.SharingData.js.map
self.scriptsLoaded['owa.SharingData.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.SharingData.js'] = (new Date()).getTime();