self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailMessageActions.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[316],{1047:function(e,n,t){"use strict";var r;t.d(n,"a",function(){return r}),function(e){e[e.disabled=0]="disabled",e[e.available=1]="available",e[e.saving=2]="saving",e[e.succeeded=3]="succeeded",e[e.failed=4]="failed"}(r||(r={}))},1050:function(e,n,t){"use strict";n.a={TabViewAddTab:{name:"TabViewAddTab",customData:function(e,n,t,r){return[e,n,t]}},TabViewCloseTab:{name:"TabViewCloseTab",customData:function(e,n){return[e.type,e.isShown,e.isActive,n,e.startTime?(new Date).getTime()-e.startTime:0]}},TabViewActivateTab:{name:"TabViewActivateTab",customData:function(e,n){return[e.type,n]},options:{isVerbose:!0}}}},1101:function(e,n,t){"use strict";function r(e){return e&&e.recipients?e.recipients.length:0}t.d(n,"a",function(){return r})},1140:function(e,n,t){"use strict";t.d(n,"a",function(){return a});var r=t(501);function a(e,n){return e.map(function(e){return Object(r.getInstrumentationContext)(e,n)}).filter(function(e){return e})}},1150:function(e,n,t){"use strict";var r=t(0);function a(e,n,t,a,i,o,c,u){return{folderId:null,type:1,listViewType:i,searchNumber:e,queryString:n,searchScope:t,pillSuggestions:r.__spread(a.values()),includeAttachments:o,fromDate:c,toDate:u,scenarioType:"mail"}}function i(e){var n=e;return 1==e.type?n.scenarioType:void 0}var o=t(20),c=t(37),u=t(27),s=t(58);function l(e){var n=e;return Object(c.z)(n.folderId)?Object(s.e)(n.searchScope,Object(s.c)({folderId:Object(u.a)(o.b),kind:"ArchiveMailbox"})):Object(s.e)(n.searchScope,Object(s.O)({folderId:Object(u.a)(o.i),kind:"PrimaryMailbox"}))}t.d(n,"a",function(){return a}),t.d(n,"b",function(){return i}),t.d(n,"c",function(){return l})},1228:function(e,n,t){"use strict";var r;t.d(n,"a",function(){return r}),function(e){e[e.Initial=0]="Initial",e[e.Adaptive=1]="Adaptive",e[e.Show=2]="Show",e[e.Hide=3]="Hide",e[e.AlwaysHide=4]="AlwaysHide"}(r||(r={}))},1229:function(e,n,t){"use strict";var r;t.d(n,"a",function(){return r}),function(e){e[e.Blank=0]="Blank",e[e.Loading=1]="Loading",e[e.Error=2]="Error",e[e.Custom=3]="Custom",e[e.Image=4]="Image",e[e.Wac=5]="Wac",e[e.Audio=6]="Audio",e[e.Video=7]="Video",e[e.Text=8]="Text",e[e.NativePdf=9]="NativePdf",e[e.PdfJs=10]="PdfJs",e[e.IFrame=11]="IFrame"}(r||(r={}))},1258:function(e,n,t){"use strict";t.d(n,"a",function(){return a}),t.d(n,"b",function(){return i}),t.d(n,"c",function(){return o}),t.d(n,"d",function(){return c}),t.d(n,"l",function(){return u}),t.d(n,"q",function(){return s}),t.d(n,"r",function(){return l}),t.d(n,"p",function(){return d}),t.d(n,"k",function(){return f}),t.d(n,"h",function(){return m}),t.d(n,"g",function(){return b}),t.d(n,"f",function(){return p}),t.d(n,"e",function(){return v}),t.d(n,"i",function(){return w}),t.d(n,"o",function(){return g}),t.d(n,"m",function(){return h}),t.d(n,"n",function(){return S}),t.d(n,"j",function(){return y});var r=t(2),a=Object(r.action)("closeComposeInSxS",function(e){return{composeViewState:e}}),i=Object(r.action)("editAndReply",function(e,n,t){return{loadDraftToCompose:e,createReply:n,trySaveAndCloseCompose:t}}),o=Object(r.action)("editInDraft",function(e){return{loadDraftToCompose:e}}),c=Object(r.action)("forceCloseSxS",function(e){return{closingSource:e}}),u=Object(r.action)("openComposeInSxS",function(e){return{composeViewState:e}}),s=Object(r.action)("tryCloseSxS",function(e){return{closingSource:e}}),l=Object(r.action)("tryExitSxSEditMode"),d=Object(r.action)("showSxS",function(e,n,t,r){return{customization:e,extendedViewState:n,editState:t,selectedLinkId:r}}),f=Object(r.action)("onSxSReadingPaneChange",function(e){return{readingPaneState:e}}),m=Object(r.action)("onPreviewOperationStart",function(e){return{pendingPreviewOperation:e}}),b=Object(r.action)("onPreviewOperationFinished"),p=Object(r.action)("onPendingNavigation",function(e){return{attachmentId:e}}),v=Object(r.action)("onChangeByImageGallery"),w=Object(r.action)("onShowCustomPreview",function(e){return{customPreviewState:e}}),g=Object(r.action)("saveToCloud",function(e){return{entryPoint:e}}),h=Object(r.action)("openSxSInANewWindow",function(e,n,t){return{parentItemId:e,attachmentId:n,isEdit:t}}),S=Object(r.action)("reloadReadingPaneAfterClosingSxS"),y=Object(r.action)("onSxSChangeOrClose",function(e,n){return{selectedLinkId:e,isSelectedLinkReadOnly:n}})},13746:function(e,n,t){"use strict";t.r(n);var r=t(2735),a=t(0),i=t(6763),o=t(1933),c=t(4),u=t(253),s=t(160),l=t(2607);function d(e,n,t){var r=s.a.items.get(e),a=Object(l.a)(r);return!(n.PrintAllowed&&!a.PrintAllowed||n.ForwardAllowed&&!a.ForwardAllowed||n.ReplyAllowed&&!a.ReplyAllowed||n.ReplyAllAllowed&&!a.ReplyAllAllowed)||(Object(u.b)(null,t,!1,{hideCancelButton:!0}),!1)}var f=t(2631),m=t(535),b=t(703),p=t(746),v=t(37),w=function(e,n){var t=v.H.items.get(e);if(!Object(p.a)(t))return!0;var r=Object(c.b)(Object(c.a)(i.a),n);return Object(u.b)(null,r,!1,{hideCancelButton:!0}),!1},g=t(8),h=Object(g.action)("forwardConversation")(function(e,n,t,r){return a.__awaiter(this,void 0,void 0,function(){var u,s;return a.__generator(this,function(a){switch(a.label){case 0:return[4,Object(f.a)(e)];case 1:return(u=a.sent())&&u.Id&&(s={ForwardAllowed:!0},d(u.Id,s,Object(c.b)(Object(c.a)(i.a),Object(c.a)(o.a)))&&w(u.Id,Object(c.a)(o.a))&&(m.m.importAndExecute(u,n,t,r),b.c.importAndExecute())),[2]}})})}),S=t(6),y=t(44),O=t(1226),j=t(7490),C=function(e,n){return a.__awaiter(void 0,void 0,void 0,function(){var t,r;return a.__generator(this,function(a){switch(a.label){case 0:return Object(y.a)()?[2,!0]:(t=v.H.items.get(e),Object(S.e)("rp-smime")&&Object(S.e)("cmp-smime")?[4,O.k.import()]:(Object(j.a)(n),[2,!1]));case 1:return[4,a.sent()(t)];case 2:return(r=a.sent())&&Object(j.a)(n),[2,!r]}})})},I=t(5658),A=Object(g.action)("forwardItem")(function(e,n,t,r){return a.__awaiter(this,void 0,void 0,function(){var i,u,s,l;return a.__generator(this,function(a){switch(a.label){case 0:return i={ForwardAllowed:!0},u=v.H.items.get(e.Id),(l=!Object(p.a)(u))?[3,2]:[4,C(e.Id,Object(c.a)(o.a))];case 1:l=a.sent(),a.label=2;case 2:return s=l,d(e.Id,i,Object(c.b)(Object(c.a)(I.a),Object(c.a)(o.a)))&&s&&(m.m.importAndExecute(e,n,t,r),b.c.importAndExecute()),[2]}})})}),P=t(4180),M=t(289),T=Object(g.action)("printConversation")(function(e,n){return a.__awaiter(this,void 0,void 0,function(){var t,r;return a.__generator(this,function(a){switch(a.label){case 0:return[4,Object(f.a)(e)];case 1:return(t=a.sent())&&t.Id&&(r={PrintAllowed:!0},d(t.Id,r,Object(c.b)(Object(c.a)(i.a),Object(c.a)(P.a)))&&(M.i.importAndExecute(t,n),Object(b.h)())),[2]}})})}),x=Object(g.action)("printItem")(function(e,n){return a.__awaiter(this,void 0,void 0,function(){var t;return a.__generator(this,function(r){return t={PrintAllowed:!0},d(e.Id,t,Object(c.b)(Object(c.a)(I.a),Object(c.a)(P.a)))&&(M.i.importAndExecute(e,n),Object(b.h)()),[2]})})}),R=t(1689),E=t(1690),N=Object(g.action)("replyToConversation")(function(e,n,t,r,o,u,s,l){return a.__awaiter(this,void 0,void 0,function(){var p,v,g,h;return a.__generator(this,function(a){switch(a.label){case 0:return[4,Object(f.a)(e)];case 1:return(p=a.sent())&&p.Id&&(v={ReplyAllAllowed:n,ReplyAllowed:!n},g=n?Object(c.a)(R.a):Object(c.a)(E.a),d(p.Id,v,Object(c.b)(Object(c.a)(i.a),g))&&w(p.Id,g))?(h=m.v.importAndExecute({referenceItemId:p,isReplyAll:n,useFullCompose:o,actionSource:t,instrumentationContexts:r,conversationId:o?null:e.Id,initialComposeLogTraceId:s,onComposeViewStateCreated:l,suppressServerMarkReadOnReplyOrForward:u}),b.c.importAndExecute(),[2,h]):[2]}})})}),_=Object(g.action)("replyToItem")(function(e,n,t,r,i){return a.__awaiter(this,void 0,void 0,function(){var o,u,s,l,f;return a.__generator(this,function(a){switch(a.label){case 0:return o={ReplyAllAllowed:n,ReplyAllowed:!n},u=n?Object(c.a)(R.a):Object(c.a)(E.a),s=v.H.items.get(e.Id),(f=!Object(p.a)(s))?[3,2]:[4,C(e.Id,u)];case 1:f=a.sent(),a.label=2;case 2:return l=f,d(e.Id,o,Object(c.b)(Object(c.a)(I.a),u))&&l&&(m.v.importAndExecute({referenceItemId:e,isReplyAll:n,useFullCompose:!0,actionSource:r,instrumentationContexts:t,suppressServerMarkReadOnReplyOrForward:i}),b.c.importAndExecute()),[2]}})})}),k=t(6093),L=t(5031),F=t(239),D=t(12),H=t(1767),V=t(11),U="userQuote",G="smartReply",B=Object(g.action)("replyWithText")(function(e,n,t,r){return a.__awaiter(this,void 0,void 0,function(){var i,o,c,u,s,l,d,f,b,p,v;return a.__generator(this,function(a){switch(a.label){case 0:return i=function(e){switch(e){case 0:return U;case 1:case 2:return G;default:return V.d.warn("replyWithText_getElementClassName: Unsupported feature inputted"),""}}(r),o=i+Math.round(1e6*Math.random()).toString(),c=Object(m.c)()===m.a,u=function(e,n,t){switch(e){case 0:return function(e,n){n=Object(k.a)(n);var t=document.createElement("blockquote");t.id=e,t.className=U,t.style.borderLeft="3px solid #C8C8C8",t.style.paddingLeft="1ex",t.style.marginLeft="0.8ex",t.style.color="#666666",t.innerHTML=n;var r=document.createElement("div");return r.appendChild(document.createElement("br")),r.appendChild(t),r.appendChild(document.createElement("br")),r}(n,t);case 1:case 2:return function(e,n){var t=document.createElement("span");t.id=e,t.innerText=n;var r=document.createElement("div");return r.appendChild(t),r}(n,t);default:return V.d.warn("[createHtmlForText] Unsupported feature"),null}}(r,o,t),s="\n"+t+"\n",c?l=s:((d=Object(L.a)()).appendChild(u),l=d.outerHTML),f=Object(m.b)(n),b=null,f?(b=f,[3,4]):[3,1];case 1:return[4,m.w.import()];case 2:return[4,a.sent()({referenceItemOrId:e,isReplyAll:!0,useFullCompose:1==z()||Object(F.a)()||Object(H.a)(),conversationId:n,body:l,instrumentationContexts:[],useCortanaSchedulingAssistant:2==r})];case 3:b=a.sent(),a.label=4;case 4:return b?[4,m.l.import()]:[3,6];case 5:(p=a.sent())&&(v=p(b))&&v.contentOperationPlugin&&(f?v.contentOperationPlugin.insertContentIntoEditor(c?s:u.outerHTML,function(e){switch(e){case 0:return"UserHighlighting";case 1:case 2:return"SmartReply";default:return V.d.warn("replyWithText_getEventName: Unsupported feature inputted"),""}}(r),!1,!0):c||v.contentOperationPlugin.moveCaretBelowHtmlElement(o)),a.label=6;case 6:return[2,b]}})})});function z(){var e=null,n=Object(D.C)();return n&&n.tableQuery&&(e=n.tableQuery.listViewType),e}var W=t(2122),K=Object(g.action)("showConversationInImmersiveReader")(function(e,n){return a.__awaiter(this,void 0,void 0,function(){var t;return a.__generator(this,function(r){switch(r.label){case 0:return[4,Object(f.a)(e)];case 1:return(t=r.sent())&&Object(W.a)(t,n),[2]}})})});t.d(n,"newMessage",function(){return r.a}),t.d(n,"forwardConversation",function(){return h}),t.d(n,"forwardItem",function(){return A}),t.d(n,"printConversation",function(){return T}),t.d(n,"printItem",function(){return x}),t.d(n,"replyToConversation",function(){return N}),t.d(n,"replyToItem",function(){return _}),t.d(n,"replyWithText",function(){return B}),t.d(n,"showConversationInImmersiveReader",function(){return K})},1407:function(e,n,t){"use strict";var r=t(493),a=t(8);n.a=Object(a.action)("setItemReadingPaneViewState")(function(e){r.a.itemReadingPaneViewState=e})},1409:function(e,n,t){"use strict";var r=t(493),a=t(8);n.a=Object(a.action)("setItemPrintPaneViewState")(function(e){r.a.itemPrintPaneViewState=e})},1413:function(e,n,t){"use strict";t.d(n,"a",function(){return i});var r=t(1228),a=t(1229);function i(){return{previewPane:{downloadUrl:null,mode:a.a.Blank},hideRightPane:!1,rightPaneSize:0,leftPaneSizePixels:0,rightPaneSizePixels:0,rightPaneDisplay:r.a.Initial}}},1430:function(e,n,t){"use strict";t.d(n,"a",function(){return a});var r=t(171);function a(e,n,t){var a={pathname:e+n,search:t};return r.format(a)}},1516:function(e,n,t){"use strict";t.d(n,"a",function(){return i});var r=t(10),a=t(6);function i(){var e=Object(r.a)(),n=e&&e.SessionSettings&&e.SessionSettings.IsExplicitLogon;return(Object(a.e)("rp-3SPeopleSuggestions")||Object(a.e)("rp-linkedInPeopleSuggestions"))&&!n&&e.SessionSettings.IsSubstrateSearchServiceAvailable}},152:function(e,n,t){"use strict";var r;t.d(n,"a",function(){return r}),function(e){e[e.Primary=0]="Primary",e[e.OverflowMenu=1]="OverflowMenu",e[e.SecondaryReadingPane=2]="SecondaryReadingPane",e[e.Compose=3]="Compose",e[e.FloatingChat=4]="FloatingChat"}(r||(r={}))},1525:function(e,n,t){"use strict";t.d(n,"c",function(){return a}),t.d(n,"a",function(){return i}),t.d(n,"b",function(){return o});var r=t(1101);function a(e){return e.isDirty||e.toRecipientWell&&e.toRecipientWell.isDirty||e.ccRecipientWell&&e.ccRecipientWell.isDirty||e.bccRecipientWell&&e.bccRecipientWell.isDirty}function i(e){return Object(r.a)(e.toRecipientWell)+Object(r.a)(e.ccRecipientWell)+Object(r.a)(e.bccRecipientWell)}function o(e){return function(e){return!!e.groupId}(e)&&(2==(n=e).operation||n.toRecipientWell.recipients.some(function(e){return e.persona.EmailAddress.EmailAddress.toLowerCase()===n.groupId.toLowerCase()}));var n}},1526:function(e,n,t){"use strict";var r=t(3),a=t(0),i=t(1527),o=t(8),c=Object(o.action)("addSessionMaskedRecipient")(function(e){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(n){return i.a.sessionMaskedRecipients[e]=!0,[2]})})});t.d(n,"b",function(){return s}),t.d(n,"a",function(){return c});var u=new r.c(function(){return t.e(425).then(t.bind(null,13960))}),s=new r.a(u,function(e){return e.execute3SPrimeCall})},1527:function(e,n,t){"use strict";t.d(n,"b",function(){return a});var r=t(2),a=Object(r.createStore)("substratepeoplesuggestions",{sessionMaskedRecipients:[]}),i=a();n.a=i},1531:function(e,n,t){"use strict";t.d(n,"a",function(){return a});var r=t(0);function a(e){var n,t,a=[];if(e&&e.recipients)try{for(var i=r.__values(e.recipients),o=i.next();!o.done;o=i.next()){var c=o.value,u=c.persona.EmailAddress;u&&u.ItemId&&"PrivateDL"==u.MailboxType?a.push({Name:u.Name,RoutingType:u.RoutingType,MailboxType:u.MailboxType,ItemId:{Id:u.ItemId.Id,ChangeKey:null},EmailAddressIndex:u.EmailAddressIndex,RelevanceScore:u.RelevanceScore||0}):a.push(c.persona.EmailAddress)}}catch(e){n={error:e}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(n)throw n.error}}return a}},1532:function(e,n,t){"use strict";var r=t(219),a=t.n(r),i=t(8);function o(e){e&&(e.isDirty=!1)}n.a=Object(i.action)("updateComposeItemId")(function(e,n,t,r){e&&(e.itemId?e.itemId.ChangeKey=t:e.itemId=a()({Id:n,ChangeKey:t}),r&&(e.lastSaveTimeStamp=r,e.isDirty=!1,o(e.toRecipientWell),o(e.ccRecipientWell),o(e.bccRecipientWell)))})},1533:function(e,n,t){"use strict";t.d(n,"a",function(){return i});var r=t(0),a=t(1560);function i(e){return r.__awaiter(this,void 0,void 0,function(){var n;return r.__generator(this,function(t){switch(t.label){case 0:return[4,a.c.import()];case 1:return n=t.sent(),e&&n(e.referenceItemId&&e.referenceItemId.Id),[2]}})})}},1534:function(e,n,t){"use strict";var r=t(2),a=Object(r.createStore)("MRUAttachmentStore",{attachments:[]});n.a=a},1541:function(e,n,t){"use strict";t.d(n,"a",function(){return a});var r=t(2),a=Object(r.action)("messageBeingSent")},1542:function(e,n,t){"use strict";t.d(n,"a",function(){return c});var r=t(0),a=t(367),i=t(284),o=t(299);function c(e,n){var t,c,u=Object(o.b)();try{for(var s=r.__values(Object(i.a)().tabs),l=s.next();!l.done;l=s.next()){var d=l.value;if(d.type==a.a.Compose&&!d.isShown){var f=u.viewStates.get(d.data);if(f&&f.isInlineCompose&&f.conversationId==e&&(0==f.asyncSendState||n&&6==f.asyncSendState))return f}}}catch(e){t={error:e}}finally{try{l&&!l.done&&(c=s.return)&&c.call(s)}finally{if(t)throw t.error}}return null}},1543:function(e,n,t){"use strict";var r=t(2);n.a=Object(r.action)("onInlineComposeSendStateChange",function(e,n){return{viewState:e,isSendPending:n}})},1550:function(e,n,t){"use strict";var r;t.d(n,"a",function(){return r}),function(e){e[e.View=0]="View",e[e.EnteringEdit=1]="EnteringEdit",e[e.Edit=2]="Edit",e[e.Saving=3]="Saving"}(r||(r={}))},1551:function(e,n,t){"use strict";t.r(n),t.d(n,"EnteredEditModeEvent",function(){return r}),t.d(n,"ExitedEditModeEvent",function(){return a}),t.d(n,"PreviewLoadEvent",function(){return i}),t.d(n,"PreviewErrorEvent",function(){return o}),t.d(n,"PreviewLoadOrErrorEvent",function(){return c}),t.d(n,"CloseEvent",function(){return u}),t.d(n,"AnimationEndEvent",function(){return s});var r="EnteredEditMode",a="ExitedEditMode",i="PreviewLoad",o="PreviewError",c="PreviewLoadOrError",u="Close",s="AnimationEnd"},1557:function(e,n,t){"use strict";var r;!function(e){e[e.MailList=0]="MailList",e[e.ReadingPane=1]="ReadingPane",e[e.FilesHub=2]="FilesHub",e[e.PhotoHub=3]="PhotoHub",e[e.GroupFilesHub=4]="GroupFilesHub",e[e.ConversationAttachmentWell=5]="ConversationAttachmentWell",e[e.Deeplink=6]="Deeplink",e[e.FileSuggestion=7]="FileSuggestion",e[e.LinkSuggestion=8]="LinkSuggestion",e[e.ComposeDocLink=9]="ComposeDocLink",e[e.ReadingPaneDocLink=10]="ReadingPaneDocLink",e[e.ConsumerGroupFilesHub=11]="ConsumerGroupFilesHub"}(r||(r={})),n.a=r},1558:function(e,n,t){"use strict";var r;t.d(n,"a",function(){return r}),function(e){e[e.ConversationReadingPane=0]="ConversationReadingPane",e[e.ItemReadingPane=1]="ItemReadingPane"}(r||(r={}))},1559:function(e,n,t){"use strict";var r;!function(e){e[e.None=0]="None",e[e.Edit=1]="Edit",e[e.Selected=2]="Selected",e[e.SelectedAndPending=3]="SelectedAndPending",e[e.SelectedAndSaving=4]="SelectedAndSaving",e[e.NotSelectedAndSaving=5]="NotSelectedAndSaving",e[e.OtherSaving=6]="OtherSaving",e[e.PendingNavigation=7]="PendingNavigation"}(r||(r={})),n.a=r},1560:function(e,n,t){"use strict";t.d(n,"c",function(){return o}),t.d(n,"b",function(){return c});var r=t(3),a=t(1534);t.d(n,"a",function(){return a.a});var i=new r.c(function(){return t.e(124).then(t.bind(null,2516))}),o=new r.b(i,function(e){return e.getAttachmentSuggestionsAction}),c=new r.b(i,function(e){return e.createCloudFileFromAttachmentData})},1563:function(e,n,t){"use strict";var r=t(617),a=t(8),i=t(284);n.a=Object(a.action)("setTabIsShown")(function(e,n){if(e.isShown!=n&&(e.isShown=n,e.blink=n,e.isActive&&!n)){var t=Object(i.a)(),a=t.tabs.indexOf(e),o=t.tabs.filter(function(n){return n.id==e.parentTabId&&n.isShown})[0]||function(e,n){n<0&&(n=0);for(var t=n;t<e.length;t++)if(e[t].isShown)return e[t];for(t=n-1;t>=0;t--)if(e[t].isShown)return e[t];return null}(t.tabs,a);o&&Object(r.a)(o)}})},1565:function(e,n,t){"use strict";var r=t(0),a=t(617),i=t(1050),o=t(777),c=t(152),u=t(23),s=t(284),l=1;n.a=Object(u.b)("addTab",i.a.TabViewAddTab)(function(e,n,t,i){var u=Object(o.a)(),d=Object(s.a)(),f={id:c.a[e]+(l++).toString(),isShown:n,isActive:!1,startTime:(new Date).getTime(),parentTabId:u?u.id:null,blink:n,data:i},m=null;switch(e){case c.a.Primary:m=r.__assign({},f,{type:c.a.Primary});break;case c.a.OverflowMenu:m=r.__assign({},f,{type:c.a.OverflowMenu,data:i});break;case c.a.SecondaryReadingPane:m=r.__assign({},f,{type:c.a.SecondaryReadingPane,data:i});break;case c.a.Compose:m=r.__assign({},f,{type:c.a.Compose,data:i});break;case c.a.FloatingChat:m=r.__assign({},f,{type:c.a.FloatingChat,data:i,isChatActive:!1})}d.tabs.push(m),t&&Object(a.a)(d.tabs[d.tabs.length-1])})},1566:function(e,n,t){"use strict";var r=t(8);n.a=Object(r.action)("toggleChatTab")(function(e){e.isChatActive=!e.isChatActive,e.isActive=e.isChatActive,e.blink=!1})},161:function(e,n,t){"use strict";var r;t.d(n,"a",function(){return r}),function(e){e[e.Mail=1]="Mail",e[e.Calendar=2]="Calendar",e[e.FilesHub=3]="FilesHub",e[e.FilesPicker=4]="FilesPicker"}(r||(r={})),n.b=r},1666:function(e,n,t){"use strict";t.d(n,"d",function(){return c}),t.d(n,"b",function(){return u}),t.d(n,"e",function(){return s}),t.d(n,"c",function(){return l}),t.d(n,"a",function(){return d});var r=t(3),a=t(22),i=new r.c(function(){return Promise.all([t.e(5),t.e(521),t.e(141)]).then(t.bind(null,2529))}),o=new r.a(i,function(e){return e.loadCLPUserLabels}),c=new r.b(i,function(e){return e.showJustificationModal}),u=new r.a(i,function(e){return e.loadItemCLPInfo}),s=new r.b(i,function(e){return e.updateItemCLPInfo}),l=new r.b(i,function(e){return e.logReadCLPLabel}),d=Object(r.d)(i,function(e){return e.CLPSubjectHeaderLabel});Object(a.d)(function(){o.importAndExecute()})},1667:function(e,n,t){"use strict";t.d(n,"a",function(){return o});var r=t(3),a=t(22),i=new r.c(function(){return t.e(331).then(t.bind(null,2510))}),o=new r.a(i,function(e){return e.loadSignatureInUserOptions});Object(a.d)(function(){o.importAndExecute()})},1689:function(e){e.exports={a:"PSa"}},1690:function(e){e.exports={a:"OSa"}},1767:function(e,n,t){"use strict";var r=t(2443);t(774),t(32),t(1430);t(2074),t(2241);t.d(n,"a",function(){return r.a})},1905:function(e,n,t){"use strict";t.d(n,"a",function(){return a});var r=t(2),a=Object(r.action)("exitSearch",function(e){return{actionSource:e}})},1933:function(e){e.exports={a:"QSa"}},1946:function(e,n,t){"use strict";t.d(n,"a",function(){return i});var r=t(160),a=t(10);function i(e){var n=r.a.conversations.get(e);if(n){var t=Object(a.a)().UserOptions.ConversationSortOrderReact;return n.conversationNodeIds.length>0&&!n.loadingState.hasLoadFailed&&n.conversationSortOrder==t}return!1}},199:function(e,n,t){"use strict";var r;!function(e){e[e.NoAction=0]="NoAction",e[e.Preview=1]="Preview",e[e.Download=2]="Download",e[e.OpenInNewTab=3]="OpenInNewTab"}(r||(r={})),n.a=r},2074:function(e,n,t){"use strict";var r=t(774),a=t(32),i=t(1430),o=t(66);function c(e,n){if(n){var t=n.displayName?n.displayName+"<"+n.smtpAddress+">":n.smtpAddress;return e?"&"+e+"="+t:t}return""}function u(e,n){return n?"&"+e+"="+n:""}function s(e){if(!e.to||!e.to.smtpAddress)return"";var n=o.parse(Object(a.a)().search.substr(1));return n.mailtouri=function(e){if(!e.to||!e.to.smtpAddress)return"";var n="mailto:"+c(null,e.to),t="";return t+=c("cc",e.cc),t+=c("bcc",e.bcc),t+=u("subject",e.subject),(t+=u("body",e.body))?n+"?"+t.slice(1):n}(e),Object(i.a)(r.e,r.b,"?"+o.stringify(n))}t.d(n,"a",function(){return s})},2122:function(e,n,t){"use strict";var r=t(2);n.a=Object(r.action)("SHOW_IN_IMMERSIVE_READER",function(e,n,t){return{itemId:e,actionSource:n,subActionSource:t}})},2241:function(e,n,t){"use strict";t.d(n,"a",function(){return o});var r=t(774),a=t(32),i=t(1430);function o(e){return e?Object(i.a)(r.e,r.f+"/"+encodeURIComponent(e),Object(a.a)().search):""}},2443:function(e,n,t){"use strict";t.d(n,"a",function(){return a});var r=t(774);function a(){return(location?location.pathname:"").split("/").indexOf(r.c)>=0}},2607:function(e,n,t){"use strict";function r(e){var n=e?e.RightsManagementLicenseData:null,t={ReplyAllowed:!0,ReplyAllAllowed:!0,ForwardAllowed:!0,PrintAllowed:!0,CopyAllowed:!0};!n||n.RightsManagedMessageDecryptionStatus&&0!=n.RightsManagedMessageDecryptionStatus||(t={ReplyAllowed:n.ReplyAllowed,ReplyAllAllowed:n.ReplyAllAllowed,ForwardAllowed:n.ForwardAllowed,PrintAllowed:n.PrintAllowed,CopyAllowed:n.ExtractAllowed});var r=e&&e.DoNotForwardMeeting;return t.ForwardAllowed=t.ForwardAllowed&&!r,t}t.d(n,"a",function(){return r})},2631:function(e,n,t){"use strict";var r=t(0),a=t(80),i=t(289);n.a=function(e){return r.__awaiter(this,void 0,void 0,function(){var n,t;return r.__generator(this,function(r){switch(r.label){case 0:return[4,i.b.import()];case 1:return(n=r.sent())(e)?[3,4]:(t=a.a.conversationItems.get(e.Id))?[4,i.d.import()]:[3,4];case 2:return[4,r.sent()(e,null,t.subject)];case 3:r.sent(),r.label=4;case 4:return[2,n(e)]}})})}},2735:function(e,n,t){"use strict";var r=t(0),a=t(1696),i=t(535),o=t(703),c=t(23),u=t(18),s=t(92),l=(t(226),t(53));n.a=Object(c.b)("newMessage",a.a.MailComposeNew)(function(e,n,t,a,c,d){return r.__awaiter(this,void 0,void 0,function(){var f,m,b,p,v,w;return r.__generator(this,function(g){switch(g.label){case 0:return 0!==(f=d?2:Object(l.u)()?0:1)?[3,2]:[4,i.z.importAndExecute(null)];case 1:g.sent(),g.label=2;case 2:return m=Object(i.c)(),b=[],t&&b.push.apply(b,r.__spread(t)),p=Object(s.a)(),(v=Object(u.q)())&&v.addCustomData({composeTraceId:p,actionSource:e}),w={operation:0,bodyType:m,to:b,preferAsyncSend:!0,subject:a,newContent:c,logTraceId:p},[4,i.s.importAndExecute(w,f,n)];case 3:return g.sent(),Object(o.g)(1===f),[2]}})})})},284:function(e,n,t){"use strict";t.d(n,"a",function(){return o}),t.d(n,"b",function(){return c});var r=t(152),a=t(2),i={tabs:[{id:"primaryTab",type:r.a.Primary,isShown:!0,isActive:!0,blink:!1}],tabBarWidth:0,isOverflowMenuShown:!1},o=Object(a.createStore)("tab",i),c=(o(),o().tabs[0])},289:function(e,n,t){"use strict";t.d(n,"d",function(){return s}),t.d(n,"a",function(){return l}),t.d(n,"l",function(){return d}),t.d(n,"m",function(){return f}),t.d(n,"h",function(){return m}),t.d(n,"e",function(){return b}),t.d(n,"i",function(){return p}),t.d(n,"k",function(){return v}),t.d(n,"f",function(){return w}),t.d(n,"g",function(){return g}),t.d(n,"b",function(){return S}),t.d(n,"c",function(){return y}),t.d(n,"j",function(){return O});var r=t(3),a=t(873),i=t(1237),o=t(1238),c=(t(1407),t(1409),t(493));t.d(n,"n",function(){return c.a});var u=new r.c(function(){return Promise.all([t.e(2),t.e(4),t.e(8),t.e(15),t.e(378)]).then(t.bind(null,2583))}),s=new r.a(u,function(e){return e.loadConversationReadingPane}),l=(new r.a(u,function(e){return e.reloadReadingPane}),new r.a(u,function(e){return e.applyConversationFlagInReadingPane})),d=new r.a(u,function(e){return e.updateLoadedConversation}),f=new r.a(u,function(e){return e.updateOnItemMandatoryPropertiesChange}),m=new r.a(u,function(e){return e.moveReadingPaneToTab}),b=new r.a(u,function(e){return e.loadConversationReadingPaneForSingleMailItemSelected}),p=new r.a(u,function(e){return e.print}),v=new r.a(u,function(e){return e.setItemIdToScrollTo}),w=new r.a(u,function(e){return e.loadItemReadingPane}),g=new r.a(u,function(e){return e.loadItemReadingPaneForSingleMailItemSelected}),h=new r.a(u,function(e){return e.initializeStitches});Object(r.f)(a.a,u,function(e){return e.deleteItemsStoreUpdateOrchestrator}),Object(r.f)(i.a,u,function(e){return e.markConversationsAsReadStoreUpdateOrchestrator}),Object(r.f)(o.a,u,function(e){return e.markItemsAsReadStoreUpdateOrchestrator});var S=new r.b(u,function(e){return e.getLastestNonDraftItemId}),y=new r.b(u,function(e){return e.isUnsupportedItem}),O=(new r.a(u,function(e){return e.setCalendarInlineComposeViewState}),new r.a(u,function(e){return e.replyByMeeting}));h.importAndExecute()},299:function(e,n,t){"use strict";var r=t(7),a=t(2),i={viewStates:new r.ObservableMap,primaryComposeId:null,complianceConfigurations:new r.ObservableMap,messageClassifications:new r.ObservableMap,newMessageCreationInProgress:!1},o=Object(a.createStore)("compose",i),c=o();t.d(n,"a",function(){return c}),t.d(n,"b",function(){return o})},333:function(e,n,t){"use strict";var r,a=t(1559),i=t(1557),o=t(1550),c=t(1047),u=t(1558);!function(e){e[e.Mail=0]="Mail",e[e.FilesHub=1]="FilesHub",e[e.DeepLink=2]="DeepLink",e[e.GroupFilesHub=3]="GroupFilesHub"}(r||(r={}));var s=t(1551),l=t(687);function d(){return Object(l.a)()}t(519);var f=t(3),m=t(1258);t(0);var b=t(547);t.d(n,"A",function(){return v}),t.d(n,"m",function(){return w}),t.d(n,"n",function(){return g}),t.d(n,"o",function(){return h}),t.d(n,"p",function(){return S}),t.d(n,"q",function(){return y}),t.d(n,"r",function(){return O}),t.d(n,"s",function(){return j}),t.d(n,"t",function(){return C}),t.d(n,"x",function(){return I}),t.d(n,"u",function(){return A}),t.d(n,"v",function(){return P}),t.d(n,"w",function(){return M}),t.d(n,"y",function(){return T}),t.d(n,"z",function(){return x}),t.d(n,"B",function(){return R}),t.d(n,"D",function(){return m.n}),t.d(n,"C",function(){return m.j}),t.d(n,"E",function(){return b.a}),t.d(n,"a",function(){return a.a}),t.d(n,"b",function(){return o.a}),t.d(n,"h",function(){return d}),t.d(n,"i",function(){return l.a}),t.d(n,"j",function(){return l.b}),t.d(n,"k",function(){return l.c}),t.d(n,"l",function(){return l.d}),t.d(n,"c",function(){return i.a}),t.d(n,"d",function(){return c.a}),t.d(n,"e",function(){return r}),t.d(n,"f",function(){return s}),t.d(n,"g",function(){return u.a});var p=new f.c(function(){return Promise.all([t.e(576),t.e(12),t.e(19),t.e(28),t.e(430)]).then(t.bind(null,13668))}),v=new f.b(p,function(e){return e}),w=new f.b(p,function(e){return e.canCloseSxS}),g=new f.b(p,function(e){return e.closeComposeInSxS}),h=new f.b(p,function(e){return e.createImageGalleryFromAttachmentViewStateIds}),S=new f.b(p,function(e){return e.editAndReply}),y=new f.b(p,function(e){return e.editInDraft}),O=new f.b(p,function(e){return e.forceCloseSxS}),j=new f.b(p,function(e){return e.onBeforeImageGalleryItemSelected}),C=new f.b(p,function(e){return e.onChangeByImageGallery}),I=new f.b(p,function(e){return e.onSxSReadingPaneChange}),A=new f.b(p,function(e){return e.onPendingNavigation}),P=new f.b(p,function(e){return e.onPreviewOperationFinished}),M=new f.b(p,function(e){return e.onPreviewOperationStart}),T=new f.b(p,function(e){return e.openComposeInSxS}),x=new f.b(p,function(e){return e.showSxS}),R=new f.b(p,function(e){return e.tryCloseSxS});new f.b(p,function(e){return e.tryExitSxSEditMode})},367:function(e,n,t){"use strict";var r=t(899),a=t(152),i=t(0),o=t(284);function c(e){var n,t,r=Object(o.a)();try{for(var c=i.__values(r.tabs),u=c.next();!u.done;u=c.next()){var s=u.value;if(s.type!==a.a.Primary&&s.data==e)return s}}catch(e){n={error:e}}finally{try{u&&!u.done&&(t=c.return)&&t.call(c)}finally{if(n)throw n.error}}return null}var u=t(777),s=t(3),l=t(617),d=t(1565),f=t(874),m=t(2);Object(m.mutator)(f.a,function(e){var n,t;try{for(var r=i.__values(Object(o.a)().tabs),c=r.next();!c.done;c=r.next()){var u=c.value;if(u.type==a.a.FloatingChat&&u.data==e.chatConversationId)return void Object(l.a)(u,!0)}}catch(e){n={error:e}}finally{try{c&&!c.done&&(t=r.return)&&t.call(r)}finally{if(n)throw n.error}}Object(d.a)(a.a.FloatingChat,!0,!0,e.chatConversationId)});var b=t(88);Object(m.orchestrator)(b.B,function(){Object(l.a)(o.b)}),t.d(n,"e",function(){return v}),t.d(n,"f",function(){return w}),t.d(n,"g",function(){return g}),t.d(n,"h",function(){return h}),t.d(n,"a",function(){return a.a}),t.d(n,"b",function(){return c}),t.d(n,"c",function(){return u.a}),t.d(n,"d",function(){return o.a}),t.d(n,"i",function(){return o.b}),t.d(n,"j",function(){return r.b});var p=new s.c(function(){return Promise.all([t.e(51),t.e(69),t.e(434)]).then(t.bind(null,13555))}),v=new s.a(p,function(e){return e.activateTab}),w=new s.a(p,function(e){return e.addTab}),g=new s.a(p,function(e){return e.closeTab}),h=new s.a(p,function(e){return e.setTabIsShown})},3883:function(e,n,t){"use strict";function r(e){return e.localizedName?e.localizedName:e.name}var a=[{name:"Arial",family:"Arial,Helvetica,sans-serif"},{name:"Arial Black",family:"'Arial Black',Arial,sans-serif"},{name:"Calibri",family:"Calibri,Helvetica,sans-serif"},{name:"Calibri Light",family:"'Calibri Light','Helvetica Light',sans-serif"},{name:"Cambria",family:"Cambria,Georgia,serif"},{name:"Candara",family:"Candara,Optima,sans-serif"},{name:"Century Gothic",family:"'Century Gothic',sans-serif"},{name:"Comic Sans MS",family:"'Comic Sans MS',Chalkboard,cursive"},{name:"Consolas",family:"Consolas,Courier,monospace"},{name:"Constantia",family:"Constantia,'Hoefler Text',serif"},{name:"Corbel",family:"Corbel,Skia,sans-serif"},{name:"Courier New",family:"'Courier New',monospace"},{name:"Franklin Gothic Book",family:"'Franklin Gothic Book','Avenir Next Condensed',sans-serif"},{name:"Franklin Gothic Demi",family:"'Franklin Gothic Demi','Avenir Next Condensed Demi Bold',sans-serif"},{name:"Franklin Gothic Medium",family:"'Franklin Gothic Medium','Avenir Next Condensed Medium',sans-serif"},{name:"Garamond",family:"Garamond,Georgia,serif"},{name:"Georgia",family:"Georgia,serif"},{name:"Impact",family:"Impact,Charcoal,sans-serif"},{name:"Lucida Console",family:"'Lucida Console',Monaco,monospace"},{name:"Lucida Handwriting",family:"'Lucida Handwriting','Apple Chancery',cursive"},{name:"Lucida Sans Unicode",family:"'Lucida Sans Unicode','Lucida Grande',sans-serif"},{name:"Palatino Linotype",family:"'Palatino Linotype','Book Antiqua',Palatino,serif"},{name:"Segoe UI",family:"'Segoe UI','Helvetica Neue',sans-serif"},{name:"Sitka Heading",family:"'Sitka Heading',Cochin,serif"},{name:"Sitka Text",family:"'Sitka Text',Cochin,serif"},{name:"Tahoma",family:"Tahoma,Geneva,sans-serif"},{name:"Times",family:"Times,'Times New Roman',serif"},{name:"Times New Roman",family:"'Times New Roman',Times,serif"},{name:"Trebuchet MS",family:"'Trebuchet MS',Trebuchet,sans-serif"},{name:"TW Cen MT",family:"'TW Cen MT','Century Gothic',sans-serif"},{name:"Verdana",family:"Verdana,Geneva,sans-serif"},{name:"-",family:"-"},{name:"Microsoft YaHei",family:"'Microsoft YaHei','微软雅黑',STHeiti,sans-serif",localizedName:"微软雅黑"},{name:"SimHei",family:"SimHei,'黑体',STHeiti,sans-serif",localizedName:"黑体"},{name:"NSimSun",family:"NSimSun,'新宋体',SimSun,'宋体',SimSun-ExtB,'宋体-ExtB',STSong,serif",localizedName:"新宋体"},{name:"FangSong",family:"FangSong,'仿宋',STFangsong,serif",localizedName:"仿宋"},{name:"SimLi",family:"SimLi,'隶书','Baoli SC',serif",localizedName:"隶书"},{name:"KaiTi",family:"KaiTi,'楷体',STKaiti,serif",localizedName:"楷体"},{name:"-",family:"-"},{name:"Microsoft JhengHei",family:"'Microsoft JhengHei','微軟正黑體','Apple LiGothic',sans-serif",localizedName:"微軟正黑體"},{name:"PMingLiU",family:"PMingLiU,'新細明體',PMingLiU-ExtB,'新細明體-ExtB','Apple LiSung',serif",localizedName:"新細明體"},{name:"DFKai-SB",family:"DFKai-SB,'標楷體','BiauKai',serif",localizedName:"標楷體"},{name:"-",family:"-"},{name:"Meiryo",family:"Meiryo,'メイリオ','Hiragino Sans',sans-serif",localizedName:"メイリオ"},{name:"MS PGothic",family:"'MS PGothic','ＭＳ Ｐゴシック','MS Gothic','ＭＳ ゴシック','Hiragino Kaku Gothic ProN',sans-serif",localizedName:"ＭＳ Ｐゴシック"},{name:"MS PMincho",family:"'MS PMincho','ＭＳ Ｐ明朝','MS Mincho','ＭＳ 明朝','Hiragino Mincho ProN',serif",localizedName:"ＭＳ Ｐ明朝"},{name:"Yu Gothic",family:"'Yu Gothic','游ゴシック','YuGothic',sans-serif",localizedName:"游ゴシック"},{name:"Yu Mincho",family:"'Yu Mincho','游明朝','YuMincho',serif",localizedName:"游明朝"},{name:"-",family:"-"},{name:"Malgun Gothic",family:"'Malgun Gothic','맑은 고딕',AppleGothic,sans-serif",localizedName:"맑은 고딕"},{name:"Gulim",family:"Gulim,'굴림','Nanum Gothic',sans-serif",localizedName:"굴림"},{name:"Dotum",family:"Dotum,'돋움',AppleGothic,sans-serif",localizedName:"돋움"},{name:"Batang",family:"Batang,'바탕',AppleMyungjo,serif",localizedName:"바탕"},{name:"BatangChe",family:"BatangChe,'바탕체',AppleMyungjo,serif",localizedName:"바탕체"},{name:"Gungsuh",family:"Gungsuh,'궁서',GungSeo,serif",localizedName:"궁서"},{name:"-",family:"-"},{name:"Leelawadee UI",family:"'Leelawadee UI',Thonburi,sans-serif"},{name:"Angsana New",family:"'Angsana New','Leelawadee UI',Sathu,serif"},{name:"Cordia New",family:"'Cordia New','Leelawadee UI',Silom,sans-serif"},{name:"DaunPenh",family:"DaunPenh,'Leelawadee UI','Khmer MN',sans-serif"},{name:"-",family:"-"},{name:"Nirmala UI",family:"'Nirmala UI',sans-serif"},{name:"Gautami",family:"Gautami,'Nirmala UI','Telugu MN',sans-serif"},{name:"Iskoola Pota",family:"'Iskoola Pota','Nirmala UI','Sinhala MN',sans-serif"},{name:"Kalinga",family:"Kalinga,'Nirmala UI','Oriya MN',sans-serif"},{name:"Kartika",family:"Kartika,'Nirmala UI','Malayalam MN',sans-serif"},{name:"Latha",family:"Latha,'Nirmala UI','Tamil MN',sans-serif"},{name:"Mangal",family:"Mangal,'Nirmala UI','Devanagari Sangam MN',sans-serif"},{name:"Raavi",family:"Raavi,'Nirmala UI','Gurmukhi MN',sans-serif"},{name:"Shruti",family:"Shruti,'Nirmala UI','Gujarati Sangam MN',sans-serif"},{name:"Tunga",family:"Tunga,'Nirmala UI','Kannada MN',sans-serif"},{name:"Vrinda",family:"Vrinda,'Nirmala UI','Bangla MN',sans-serif"},{name:"-",family:"-"},{name:"Nyala",family:"Nyala,Kefa,sans-serif"},{name:"Sylfaen",family:"Sylfaen,Mshtakan,Menlo,serif"}];function i(e){for(var n=e.toUpperCase(),t=0;t<a.length;t++){var r=a[t];if(r.name.toUpperCase()==n||r.localizedName&&r.localizedName.toUpperCase()==n)return r.family}return null}var o="pt",c=[8,10,12,14,18,24,36],u=[8,9,10,11,12,14,16,18,20,22,24,26,28,36,48,72],s=u.map(function(e){return e.toString()});function l(e){return"number"==typeof e&&e<=7?c[e-1]:e}function d(e){var n=l(e).toString();return n?n+o:n}t.d(n,"g",function(){return r}),t.d(n,"a",function(){return a}),t.d(n,"d",function(){return i}),t.d(n,"b",function(){return u}),t.d(n,"c",function(){return s}),t.d(n,"e",function(){return l}),t.d(n,"f",function(){return d})},4140:function(e,n,t){"use strict";t.d(n,"a",function(){return c}),t.d(n,"b",function(){return u});var r=t(0),a=t(10),i=t(3883),o={fontFamily:"Calibri,Arial,Helvetica,sans-serif",fontSize:"11pt",textColor:"#000000",bold:!1,italic:!1,underline:!1};function c(){var e=Object(a.a)().UserOptions;return e?u(e.ComposeFontName,e.ComposeFontSize,e.ComposeFontColor,e.ComposeFontFlags):o}function u(e,n,t,a){var c=r.__assign({},o),u=e?Object(i.d)(e):null;u&&(c.fontFamily=u);var s=n?Object(i.f)(n):null;return s&&(c.fontSize=s),t&&(c.textColor=t),a&&(c.bold=1==(1&a),c.italic=2==(2&a),c.underline=4==(4&a)),c}},4180:function(e){e.exports={a:"ZSa"}},493:function(e,n,t){"use strict";t.d(n,"b",function(){return i});var r=t(730),a=t(2),i=Object(a.createStore)("readingpane",{conversationReadingPaneViewState:null,floatingActionBarViewState:{isVisible:!1,itemId:""},itemReadingPaneViewState:null,itemPreviewPaneViewState:null,itemPrintPaneViewState:null,deeplinkId:null}),o=i();r.a.registerReference(function(){return o.conversationReadingPaneViewState&&o.conversationReadingPaneViewState.conversationId.Id}),n.a=o},5031:function(e,n,t){"use strict";t.d(n,"a",function(){return a});var r=t(4140);function a(){var e=document.createElement("div"),n=e.style,t=Object(r.a)();return t.fontFamily&&(n.fontFamily=t.fontFamily),t.fontSize&&(n.fontSize=t.fontSize),t.textColor&&(n.color=t.textColor),t.bold&&(n.fontWeight="bold"),t.italic&&(n.fontStyle="italic"),t.underline&&(n.textDecoration="underline"),e}n.b=function(){return(e=a()).appendChild(document.createElement("br")),e.outerHTML;var e}},519:function(e,n,t){"use strict";var r=t(199),a=t(221),i=t(254),o=t(6);function c(e,n,t,c){if(Object(i.e)(t))return function(e){return 2===Object(i.c)(e)?l():u()}(t);if(3===Object(i.c)(t)&&!c)return s();var d;switch(n){case 2:d={allowEdit:!1,previewMethod:a.a.Image,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 3:d={allowEdit:!1,previewMethod:a.a.NativeView,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 6:d={allowEdit:!1,previewMethod:a.a.GoogleDoc,supportedOpenActions:[r.a.Preview]};break;case 4:d={allowEdit:e.wacEdit,previewMethod:a.a.Wac,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 5:d={allowEdit:!1,previewMethod:a.a.Audio,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 7:d={allowEdit:!1,previewMethod:a.a.PdfJs,supportedOpenActions:[r.a.Preview]};break;case 8:case 9:case 10:d=l();break;case 11:d={allowEdit:!1,previewMethod:a.a.Text,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 12:d={allowEdit:!1,previewMethod:a.a.Video,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 1:d={allowEdit:!1,previewMethod:a.a.Unsupported,supportedOpenActions:[]};break;case 13:d=Object(o.e)("cal-ics-preview")?{allowEdit:!1,previewMethod:a.a.CalendarEvent,supportedOpenActions:[r.a.Preview,r.a.Download]}:u();break;default:d=function(e){return e.__type===i.a.attachmentTypes.REFERENCE_ATTACHMENT_TYPE||e.__type===i.a.attachmentTypes.LINK_ATTACHMENT_TYPE}(t)?s():u()}return d}function u(){return{allowEdit:!1,previewMethod:a.a.Unsupported,supportedOpenActions:[r.a.Download]}}function s(){return{allowEdit:!1,previewMethod:a.a.Unsupported,supportedOpenActions:[r.a.OpenInNewTab]}}function l(){return{allowEdit:!1,previewMethod:a.a.ItemAttachment,supportedOpenActions:[r.a.Preview,r.a.Download]}}var d=t(8),f=(Object(d.action)("setPreviewLoaded")(function(e,n){e.previewLoaded=n}),Object(d.action)("setIsPlaceholderAttachment")(function(e,n){e.isPlaceholderAttachment=n})),m=Object(d.action)("setThumbnailLoadState")(function(e,n){e.thumbnailLoadState=n});function b(e,n,t,r,i,o){return void 0===o&&(o=null),{attachmentId:e,thumbnailLoadState:0,previewLoaded:!1,isCloudy:t,isReadOnly:n,isPlaceholderAttachment:r,strategy:{allowEdit:!1,previewMethod:a.a.Unsupported,supportedOpenActions:[]},parentItemId:o,fileType:i}}var p=t(10);function v(){return Object(p.a)().SessionSettings.CompanyName}function w(e){return e.supportedOpenActions.length&&e.supportedOpenActions[0]||r.a.NoAction}t.d(n,"d",function(){return c}),t.d(n,"g",function(){return f}),t.d(n,"h",function(){return m}),t.d(n,"c",function(){return b}),t.d(n,"f",function(){return v}),t.d(n,"e",function(){return w}),t.d(n,"a",function(){return r.a}),t.d(n,"b",function(){return a.a})},535:function(e,n,t){"use strict";t(1541);var r=t(3),a=(t(1667),t(1666),t(22)),i=t(1526),o=t(1516),c=new r.c(function(){return t.e(380).then(t.bind(null,13839))}),u=new r.a(c,function(e){return e.initializeCache});Object(a.c)(function(){u.importAndExecute(),Object(o.a)()&&i.b.importAndExecute(!0)});var s=t(952),l=t(1525),d=(t(1532),t(1531)),f=t(1542),m=t(1533),b=t(2),p=Object(b.action)("onComposeAddinsInitialized",function(e){return{hostItemIndex:e}}),v=t(1543),w=t(299),g=t(367);function h(){var e=Object(g.c)(),n=Object(w.b)(),t=e?function(e,n){switch(e.type){case g.a.Primary:return n.primaryComposeId;case g.a.Compose:return e.data;default:return null}}(e,n):n.primaryComposeId,r=t?n.viewStates.get(t):null;return r&&!r.isInlineCompose?r:null}t.d(n,"v",function(){return y}),t.d(n,"m",function(){return O}),t.d(n,"g",function(){return j}),t.d(n,"j",function(){return C}),t.d(n,"p",function(){return I}),t.d(n,"s",function(){return A}),t.d(n,"z",function(){return P}),t.d(n,"q",function(){return M}),t.d(n,"t",function(){return T}),t.d(n,"y",function(){return x}),t.d(n,"u",function(){return R}),t.d(n,"r",function(){return E}),t.d(n,"x",function(){return N}),t.d(n,"i",function(){return _}),t.d(n,"o",function(){return k}),t.d(n,"l",function(){return L}),t.d(n,"w",function(){return F}),t.d(n,"n",function(){return D}),t.d(n,"h",function(){return H}),t.d(n,"k",function(){return V}),t.d(n,"c",function(){return s.c}),t.d(n,"a",function(){return s.b}),t.d(n,"f",function(){return l.c}),t.d(n,"e",function(){return d.a}),t.d(n,"b",function(){return f.a}),t.d(n,"A",function(){return m.a}),t.d(n,"B",function(){return p}),t.d(n,"C",function(){return v.a}),t.d(n,"d",function(){return h});var S=new r.c(function(){return Promise.all([t.e(2),t.e(3),t.e(4),t.e(5),t.e(304)]).then(t.bind(null,13343))}),y=new r.a(S,function(e){return e.replyToMessage}),O=new r.a(S,function(e){return e.forwardMessage}),j=new r.a(S,function(e){return e.closeCompose}),C=new r.a(S,function(e){return e.discardCompose}),I=new r.a(S,function(e){return e.loadDraftToCompose}),A=new r.a(S,function(e){return e.openCompose}),P=new r.a(S,function(e){return e.trySaveAndCloseCompose}),M=new r.a(S,function(e){return e.moveComposeToTab}),T=new r.a(S,function(e){return e.recreateComposeFromViewState}),x=new r.a(S,function(e){return e.tryCreateResendDraft}),R=new r.a(S,function(e){return e.replyToApprovalMessage}),E=new r.a(S,function(e){return e.onEditDraftButtonClicked}),N=new r.a(S,function(e){return e.showSubjectPickerButton}),_=(new r.b(S,function(e){return e.createComposeViewState}),new r.b(S,function(e){return e.createReply})),k=new r.b(S,function(e){return e.getToCcRecipientsForReply}),L=new r.b(S,function(e){return e.findComposePlugins}),F=new r.b(S,function(e){return e.replyToMessageAndCreateViewState}),D=(new r.b(S,function(e){return e.infoBarAddHandler}),new r.b(S,function(e){return e.infoBarRemoveHandler}),new r.b(S,function(e){return e.getNextComposeId})),H=new r.b(S,function(e){return e.createAttachments}),V=new r.b(S,function(e){return e.findComposeFromRecipientWell})},547:function(e,n,t){"use strict";var r=t(1047),a=t(424),i=t(1413),o=t(2),c={shouldShow:!1,viewState:Object(i.a)(),extendedViewState:{previewMode:0,attachmentId:null,selectionSource:0,isCloudy:!1,saveToCloudStatus:r.a.disabled},editState:{mode:0,editAllowed:!1,itemId:null,isDraft:!1},customPreviewState:null,eventManager:new a.a,pendingPreviewOperation:null,pendingNavigation:null,readingPaneState:null,composeId:null,customization:null,isInvisible:!1,shouldUseFakeRightHandSide:!1,isUsingFakeRightHandSide:!1,shouldHideReadingPaneOutsideSxS:!1,attachmentViewStateIdFromListView:null,sessionPreviewCount:0,sessionStartTime:0};c.viewState.previewPane=null;var u=Object(o.createStore)("sxsstore",c);n.a=u()},5658:function(e){e.exports={a:"kHb"}},6093:function(e,n,t){"use strict";function r(e){return e?"<div>"+(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/&/g,"&amp;")).replace(/</g,"&lt;")).replace(/>/g,"&gt;")).replace(/'/g,"&#39;")).replace(/"/g,"&quot;")).replace(/^ /gm,"&nbsp;")).replace(/(\n|\r\n)/g,"<br></div><div>")).replace(/\s\s/g," &nbsp;"))+"<br></div>":e}t.d(n,"a",function(){return r})},617:function(e,n,t){"use strict";var r=t(152),a=t(1050),i=t(777),o=t(1563),c=t(1566),u=t(23),s=t(899);n.a=Object(u.b)("activateTab",a.a.TabViewActivateTab)(function(e,n){switch(Object(o.a)(e,!0),e.type){case r.a.FloatingChat:return void Object(c.a)(e);case r.a.Primary:case r.a.OverflowMenu:case r.a.SecondaryReadingPane:case r.a.Compose:if(!e.isActive){var t,a=Object(i.a)();if(a)a.isActive=!1,(t=Object(s.a)(a.type))&&t.onDeactivate&&t.onDeactivate(a);if(e)e.isActive=!0,e.blink=!1,(t=Object(s.a)(e.type))&&t.onActivate&&t.onActivate(e)}return}})},6763:function(e){e.exports={a:"lHb"}},687:function(e,n,t){"use strict";t.d(n,"a",function(){return i}),t.d(n,"b",function(){return o}),t.d(n,"c",function(){return c}),t.d(n,"d",function(){return u});var r=t(547),a=t(34);function i(){return r.a.shouldShow}function o(){return r.a.shouldShow&&r.a.shouldHideReadingPaneOutsideSxS}function c(e){return i()&&Object(a.g)(e,r.a.extendedViewState.attachmentId)}function u(e){return i()&&(e&&e.composeId===r.a.composeId||!e&&r.a.composeId)}},703:function(e,n,t){"use strict";var r,a=t(1905),i=t(88),o=t(8),c=t(239),u=Object(o.action)("onNewMessage")(function(e){e||(Object(i.B)(!0),Object(i.A)(!Object(c.b)()))}),s=Object(o.action)("onPrintRow")(function(){Object(c.b)()&&(Object(i.B)(!0),Object(i.A)(!1))}),l=t(0),d=t(97),f=t(1140),m=t(10),b=t(1946),p=t(145),v=t(445),w=t(1150),g=t(12),h=t(58),S=t(287),y=t(18),O=t(289),j=t(161),C=t(23);function I(e,n,t,r,a,o,c,u,s){var l=Promise.resolve(),d=!1,f=!0;switch(o){case p.a.MailListItemBody:case p.a.CommandBarArrows:case p.a.KeyboardEnter:case p.a.MailListItemExpansion:case p.a.MailListItemRichPreview:case p.a.SearchSuggestionClick:case p.a.RouteHandler:d=!0,f=!1;break;case p.a.MailListItemTwisty:l=function(e){if(Object(b.a)(e.Id))return Promise.resolve();return Object(S.h)(e,"LoadConversationReadingPane")}(e),d=!1,f=!0;break;case p.a.ImmersiveReadingPaneDelete:"ReturnToView"===Object(m.a)().UserOptions.NextSelection?(d=!1,f=!0):(d=!0,f=!1);break;case p.a.KeyboardUpDown:case p.a.MailListItemCheckbox:case p.a.MailListItemContextMenu:case p.a.NewConversation:case p.a.Reset:case p.a.RowRemoval:default:d=!1,f=!0}if(d)switch(n){case 0:l=O.e.importAndExecute(e,a,c,t,r,s);break;case 1:l=O.g.importAndExecute(e,a,c,u)}return Object(i.B)(d),Object(i.A)(f),l}var A=0;function P(e,n,t,r,a,i,o,c){switch(n){case 0:return O.e.importAndExecute(e,a,i,t,r,c);case 1:return O.g.importAndExecute(e,a,i,o);default:return Promise.resolve()}}var M=Object(o.action)("onListViewSelectionChange")(Object(o.select)({listViewStore:function(){return g.O}})(function(e,n,t,a){return l.__awaiter(this,void 0,void 0,function(){var a,o,u,s,d,m,b,S,y,O,j,C,M,x;return l.__generator(this,function(R){return t==p.a.MessageAd?[2]:(a=Promise.resolve(),0==(o=e.selectedRowKeys.size)?(Object(i.A)(!0),Object(c.b)()?Object(i.B)(!1):Object(i.B)(!0)):1!=o||Object(c.b)()&&e.isInCheckedMode?Object(c.b)()&&(Object(i.B)(!1),Object(i.A)(!0)):(u=null,s=l.__spread(e.selectedRowKeys.keys())[0],d=g.b.getRowClientItemId(s,e),m=g.b.getIsDraft(s,e),b=g.b.getIsSubmitted(s,e),S=e.tableQuery,y=Object(g.J)(S)||Object(w.c)(S),O=m&&!b&&!y,j=Object(f.a)([s],e)[0],C=g.b.getCategories(s,e),M=g.b.getSubject(s,e),Object(v.a)("sea-qf")&&j&&(h.A.importAndExecute(j.traceId,j.referenceKey,new Date,h.a.Mail,j.index),x=g.b.getItemIds(s,e),u=x?x[0]:null,T(s,e)),y||(Object(c.c)()||Object(c.a)()?a=function(e,n,t,a,o,c,u,s,l){if(r&&(clearTimeout(r),r=null),Object(i.B)(!0),Object(i.A)(!0),c===p.a.KeyboardUpDown){var d=Date.now(),f=d-A;if(A=d,f<=500)return new Promise(function(i,c){r=setTimeout(function(){r=null,P(e,n,t,a,o,u,s,l).then(function(){i()}).catch(function(e){c(e)})},250)})}return P(e,n,t,a,o,u,s,l)}(d,S.listViewType,M,C,n,t,j,O,u):Object(c.b)()&&(a=I(d,S.listViewType,M,C,n,t,j,O,u)))),[2,a])})})}));var T=function(e,n){var t,r,a=g.b.getParentFolderId(e,n);if(a){var i=!1,o=!1;try{for(var c=l.__values(n.rowKeys),u=c.next();!u.done;u=c.next()){var s=u.value;if(i&&o)break;var f="deleteditems"===Object(d.a)(g.b.getParentFolderId(s,n));f&&!i&&(i=!0),f||o||(o=!0)}}catch(e){t={error:e}}finally{try{u&&!u.done&&(r=c.return)&&r.call(c)}finally{if(t)throw t.error}}var m=[10,25,75,150,250];Object(y.o)("SearchResultSelected",["Relevance"===g.b.getExecuteSearchSortOrder(e,n),Object(d.a)(a),Object(C.c)({value:n.rowKeys.indexOf(e),buckets:m}),Object(C.c)({value:n.rowKeys.length,buckets:m}),i,o,j.b.Mail])}},x=M,R=t(3),E=t(22),N=(t(333),t(119)),_=t(2);Object(_.orchestrator)(i.y,function(e){g.O.rowInfoForVLV.clear()});t.d(n,"b",function(){return L}),t.d(n,"c",function(){return F}),t.d(n,"e",function(){return D}),t.d(n,"d",function(){return V}),t.d(n,"g",function(){return u}),t.d(n,"f",function(){return x}),t.d(n,"h",function(){return s}),t.d(n,"a",function(){return a.a});var k=new R.c(function(){return t.e(319).then(t.bind(null,13795))}),L=new R.a(k,function(e){return e.closeImmersiveReadingPane}),F=new R.a(k,function(e){return e.onReplyOrReplyAllOrForwardMessage}),D=new R.a(k,function(e){return e.onSelectingFolder}),H=(new R.b(k,function(e){return e.onSxSPreviewPaneClose}),new R.a(k,function(e){return e.onReadingPanePositionOptionSaved})),V=new R.a(k,function(e){return e.onSelectMessageAd});Object(E.c)(function(){Object(N.subscribe)("saveReadingPanePositionOptionStitchName",function(){return H.importAndExecute()})})},7490:function(e,n,t){"use strict";var r=t(5658),a=t(7491),i=t(4),o=t(253),c=t(6);n.a=function(e){var n=Object(i.b)(Object(c.e)("cmp-smime")&&Object(c.e)("rp-smime")?Object(i.a)(a.a):Object(i.a)(r.a),e);Object(o.b)(null,n,!1,{hideCancelButton:!0})}},7491:function(e){e.exports={a:"mHb"}},774:function(e,n,t){"use strict";t.d(n,"c",function(){return i}),t.d(n,"b",function(){return o}),t.d(n,"h",function(){return c}),t.d(n,"g",function(){return u}),t.d(n,"f",function(){return s}),t.d(n,"d",function(){return l}),t.d(n,"e",function(){return d}),t.d(n,"a",function(){return f});var r=t(0),a=t(222),i="deeplink",o="compose",c="reply",u="replyall",s="read",l="group",d="/"+r.__spread(["mail"],Object(a.a)().split("/").slice(1)).join("/")+i+"/",f="/"+r.__spread(["calendar"],Object(a.a)().split("/").slice(1)).join("/")+i+"/"},777:function(e,n,t){"use strict";t.d(n,"a",function(){return c});var r=t(0),a=t(152),i=t(284),o=t(11);function c(){var e,n,t=Object(i.a)();try{for(var c=r.__values(t.tabs),u=c.next();!u.done;u=c.next()){var s=u.value;if(s.isActive&&s.type!=a.a.FloatingChat)return s}}catch(n){e={error:n}}finally{try{u&&!u.done&&(n=c.return)&&n.call(c)}finally{if(e)throw e.error}}return o.d.error("There is no active tab. Something went very wrong."),null}},899:function(e,n,t){"use strict";t.d(n,"b",function(){return i}),t.d(n,"a",function(){return o});var r=t(152),a={};function i(e,n){a[r.a[e]]=n}function o(e){return a[r.a[e]]}},952:function(e,n,t){"use strict";t.d(n,"c",function(){return c}),t.d(n,"a",function(){return a}),t.d(n,"b",function(){return i});var r=t(10),a="HTML",i="Text",o="Html";function c(){return Object(r.a)().UserOptions.ComposeMarkup==o?"HTML":"Text"}}},0,[2,4,8,15,378,5,40,85,344,3,304,0,1,526,178,12,47,121,521,141,514,105,525,174,24,116,312,331,425]]);
//# sourceMappingURL=owa.MailMessageActions.js.map
self.scriptsLoaded['owa.MailMessageActions.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailMessageActions.js'] = (new Date()).getTime();