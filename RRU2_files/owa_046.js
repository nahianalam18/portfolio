self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.GetItemManager.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[242],{12850:function(e,t,r){"use strict";r.r(t);var n=r(6569);r.d(t,"getAdditionalPropertiesFromServer",function(){return n.b}),r.d(t,"getItemProperties",function(){return n.c}),r.d(t,"cleanUpByItemId",function(){return n.a})},13788:function(e,t,r){"use strict";r.r(t);var n=r(6569),i=r(8088),a=r(8087),o=r(8077),s=r(8078),u=r(8514),c=r(4863),d=r(37),m=r(4414),g=r(6),p=r(6094);function f(e,t){var r=Object(d.t)(),n=r.items.get(e);if(n)if(0===t){var i=r.conversations.get(n.ConversationId.Id);if(i){var a=Object(p.a)(i.conversationId);return n&&a&&a.Id===e}}else if(1===t)return Object(g.e)("mc-smartPillsMessageView");return!1}var l={featureId:m.a.LanguageAndLocale,propertyPaths:[c.i],isPropertyExistedOnItem:function(e){var t=d.H.items.get(e);return t&&!!t.stampedLanguage},shouldGetItemPropertiesFromServer:f},I={featureId:m.a.SmartReply,propertyPaths:[c.k],isPropertyExistedOnItem:function(e){var t=d.H.items.get(e);return t&&!!t.SmartReplyData},shouldGetItemPropertiesFromServer:f},y={featureId:m.a.SmartTime,propertyPaths:[c.l],isPropertyExistedOnItem:function(e){var t=d.H.items.get(e);return t&&!!t.SmartTimeData},shouldGetItemPropertiesFromServer:f},P={featureId:m.a.SmartDoc,propertyPaths:[c.n,c.j],isPropertyExistedOnItem:function(e){var t=d.H.items.get(e);return t&&!!t.AttachmentSuggestions},shouldGetItemPropertiesFromServer:f},S={featureId:m.a.SmartTask,propertyPaths:[c.m],isPropertyExistedOnItem:function(e){var t=d.H.items.get(e);return t&&!!t.SmartTaskData},shouldGetItemPropertiesFromServer:f};function v(){Object(n.d)([i.c,a.b,o.a,s.b,u.c,l,P,I,y,S])}r.d(t,"initializeGetItemManagerForRP",function(){return v})},4414:function(e,t,r){"use strict";var n,i=r(3),a=r(5638),o=r(2),s=r(37);Object(o.mutator)(a.a,function(e){var t=e.itemId,r=e.isSmartSuggestionsRendered,n=e.suggestionTypesRendered,i=e.suggestionsRendered,a=e.extractionId,o=Object(s.t)().items.get(t);o&&o.SIGSData&&(o.SIGSData.SmartPillData={IsSmartSuggestionsRendered:r,SuggestionTypesRendered:n,SuggestionsRendered:i,ExtractionId:a})});!function(e){e.LanguageAndLocale="SmartPill_LanguageAndLocale",e.SmartDoc="SmartPill_SmartDoc",e.SmartReply="SmartPill_SmartReply",e.SmartTask="SmartPill_SmartTask",e.SmartTime="SmartPill_SmartTime"}(n||(n={})),r.d(t,"b",function(){return c}),r.d(t,"a",function(){return n});var u=new i.c(function(){return r.e(420).then(r.bind(null,13596))}),c=new i.a(u,function(e){return e.logToSIGSOnMessageSent})},4863:function(e,t,r){"use strict";r.d(t,"g",function(){return a}),r.d(t,"h",function(){return o}),r.d(t,"a",function(){return s}),r.d(t,"d",function(){return u}),r.d(t,"f",function(){return c}),r.d(t,"e",function(){return d}),r.d(t,"c",function(){return m}),r.d(t,"b",function(){return g}),r.d(t,"i",function(){return p}),r.d(t,"k",function(){return f}),r.d(t,"l",function(){return l}),r.d(t,"m",function(){return I}),r.d(t,"n",function(){return y}),r.d(t,"j",function(){return P});var n=r(308),i=r.n(n),a="spanish",o="SpanishLanguageMessage",s=20,u="Language",c="Locale",d="LanguageScores",m="@EntityId",g="EntityExtraction/ExtractLanguage1.0",p=i()({PropertyName:g,DistinguishedPropertySetId:"Common",PropertyType:"String"}),f=i()({PropertyName:"EntityExtraction/SmartReplyForEmail",DistinguishedPropertySetId:"Common",PropertyType:"String"}),l=i()({PropertyName:"EntityExtraction/Events1.0",DistinguishedPropertySetId:"Common",PropertyType:"String"}),I=i()({PropertyName:"EntityExtraction/RequestForAction1.0",DistinguishedPropertySetId:"Common",PropertyType:"String"}),y=i()({PropertyName:"EntityExtraction/SubstrateSearchSuggestions",DistinguishedPropertySetId:"Common",PropertyType:"String"}),P=i()({PropertyName:"EntityExtraction/ReplyWithQueryCoverage",DistinguishedPropertySetId:"Common",PropertyType:"String"})},5638:function(e,t,r){"use strict";var n=r(2);t.a=Object(n.action)("initializeSIGSDataAction",function(e,t,r,n,i){return{itemId:e,isSmartSuggestionsRendered:t,suggestionTypesRendered:r,suggestionsRendered:n,extractionId:i}})},6482:function(e,t,r){"use strict";r.d(t,"a",function(){return i});var n=r(34);function i(e){return e&&e.MailboxInfo&&e.MailboxInfo.type==n.a.GroupMailbox}},6569:function(e,t,r){"use strict";var n=r(0);var i=r(2),a=r(37),o=Object(i.mutatorAction)("updateItemInStore",function(e,t){var r=a.H.items.get(e);r&&Object.keys(t).forEach(function(e){"ExtendedProperty"==e?r.ExtendedProperty=n.__spread(t.ExtendedProperty,r.ExtendedProperty):"ItemId"!=e&&(r[e]=t[e])})}),s=r(18),u=r(955),c=r(954),d=r(160),m=r(494),g=r.n(m),p=r(11);r.d(t,"d",function(){return y}),r.d(t,"b",function(){return P}),r.d(t,"c",function(){return S}),r.d(t,"a",function(){return v});var f={},l={},I="GetItemManagerFailure";function y(e){e.forEach(function(e){l[e.featureId]=e})}function P(e,t){if(!f[e]||"Pending"!=f[e].requestStatus){var r=function(e,t){var r=[];if(Object.keys(l).forEach(function(i){var a=l[i],o=a.isPropertyExistedOnItem,s=a.shouldGetItemPropertiesFromServer,u=a.propertyPaths;!o(e)&&s(e,t)&&r.push.apply(r,n.__spread(u))}),r.length>0)return g()({BaseShape:"IdOnly",AdditionalProperties:r});return null}(e,t);if(r){var i={itemId:e,listViewType:t,requestStatus:"Pending",pendingPromise:null};f[e]=i;var a=d.a.items.get(e),m=a.MailboxInfo&&a.MailboxInfo.requestOptions;i.pendingPromise=Object(u.a)([e],r,null,null,m).then(function(t){if(t&&Object(c.a)(t[0])){i.requestStatus="Success";var r=t[0];return o(e,r.Items[0]),Promise.resolve(d.a.items.get(e))}var a=n.__read(function(e){return e&&"Success"!=e.ResponseClass?[e.ResponseCode,e.StackTrace]:[null,null]}(t[0]),2),s=a[0],u=a[1];return i.requestStatus="Error",Promise.reject(new Error("GetItem failed ErrorResponseCode="+s+", StackTrace="+u))}).catch(function(e){return i.requestStatus="Error",Object(s.o)(I,{errorMessage:e.message}),p.d.warn("[GetItemManager_getAdditionalPropertiesFromServer] Error: "+e.message),Promise.reject(e)})}}}function S(e,t){var r=l[t];if(!r)return Promise.reject("GetItemManager: The featureId is not registered in GetItemManager.");if(r.isPropertyExistedOnItem(e))return Promise.resolve(d.a.items.get(e));if(!f[e])return Promise.reject("GetItemManager: Please trigger getItem after the container finished loading.");var n=f[e];switch(n.requestStatus){case"Success":return Promise.resolve(d.a.items.get(e));case"Pending":case"Error":return n.pendingPromise;default:return Promise.reject("GetItemManager: The request status is unknown.")}}function v(e){delete f[e]}},8077:function(e,t,r){"use strict";r.d(t,"b",function(){return s});var n=r(6482),i=r(6),a=r(160),o=r(71),s="UserHighlight",u=r.n(o)()({FieldURI:"UserHighlightData"}),c={featureId:s,propertyPaths:[u],isPropertyExistedOnItem:function(e){var t=a.a.items.get(e);return t&&null!=t.userHighlightData},shouldGetItemPropertiesFromServer:function(e,t){if(!Object(i.e)("mc-userHighlighting"))return!1;var r=a.a.items.get(e);return r&&!Object(n.a)(r)}};t.a=c},8078:function(e,t,r){"use strict";r.d(t,"c",function(){return s}),r.d(t,"a",function(){return u});var n=r(6482),i=r(6),a=r(160),o=r(4568),s="UserNote",u="UserNoteData",c={featureId:s,propertyPaths:[o.g],isPropertyExistedOnItem:function(e){var t=a.a.items.get(e);return t&&null!=t.userNoteData},shouldGetItemPropertiesFromServer:function(e,t){if(!Object(i.e)("rp-userMarkup"))return!1;var r=a.a.items.get(e);return r&&!Object(n.a)(r)}};t.b=c},8087:function(e,t,r){"use strict";r.d(t,"a",function(){return o}),r.d(t,"c",function(){return s});var n=r(6),i=r(160),a=r(308),o="EntityExtraction/ExtractLanguage1.0",s="InlineTranslationLocale",u=r.n(a)()({PropertyName:o,DistinguishedPropertySetId:"Common",PropertyType:"String"}),c={featureId:s,propertyPaths:[u],isPropertyExistedOnItem:function(e){var t=i.a.items.get(e);return t&&t.TranslationData&&null!=t.TranslationData.itemLocale},shouldGetItemPropertiesFromServer:function(e,t){return!!(Object(n.e)("rp-inlineTranslation")&&0==t||Object(n.e)("rp-inlineTranslation-conversationViewOff"))&&!i.a.items.get(e).RightsManagementLicenseData}};t.b=c},8088:function(e,t,r){"use strict";r.d(t,"a",function(){return s}),r.d(t,"b",function(){return u}),r.d(t,"d",function(){return c});var n=r(6),i=r(160),a=r(308),o=r.n(a),s="TranslationData",u="TranslationStatus",c="InlineTranslationDataAndStatus",d=[o()({PropertyName:s,DistinguishedPropertySetId:"Common",PropertyType:"String"}),o()({PropertyName:u,DistinguishedPropertySetId:"Common",PropertyType:"String"})],m={featureId:c,propertyPaths:d,isPropertyExistedOnItem:function(e){var t=i.a.items.get(e);return t&&t.TranslationData&&null!=t.TranslationData.userLanguage},shouldGetItemPropertiesFromServer:function(e,t){return!!(Object(n.e)("rp-inlineTranslation")&&Object(n.e)("tra-cacheTranslation")&&0==t||Object(n.e)("rp-inlineTranslation-conversationViewOff")&&Object(n.e)("tra-cacheTranslation"))&&!i.a.items.get(e).RightsManagementLicenseData}};t.c=m},8514:function(e,t,r){"use strict";var n=r(160);var i=r(2615),a=r(308),o=r.n(a);r.d(t,"a",function(){return s}),r.d(t,"b",function(){return u}),r.d(t,"d",function(){return c});var s="EntityExtraction/Conversation",u="EntityExtraction/ConversationTest",c="YammerThread",d=[o()({PropertyName:s,DistinguishedPropertySetId:"Common",PropertyType:"String"}),o()({PropertyName:u,DistinguishedPropertySetId:"Common",PropertyType:"String"})],m={featureId:c,propertyPaths:d,isPropertyExistedOnItem:function(e){var t=n.a.items.get(e);return t&&null!=t.YammerThreadId},shouldGetItemPropertiesFromServer:function(e,t){var r=n.a.items.get(e);return r&&Object(i.a)(r)&&(1==t||0==t&&function(e){var t=n.a.items.get(e);if(!t||!t.ConversationId||!t.ConversationId.Id)return!1;var r=t.ConversationId.Id,i=n.a.conversations.get(r);if(!i||!i.conversationNodeIds||0==i.conversationNodeIds.length)return!1;var a=i.conversationNodeIds,o=a["ChronologicalNewestOnBottom"==i.conversationSortOrder?0:a.length-1],s=n.a.conversationNodes.get(o);return s&&s.itemIds&&s.itemIds.length>0&&s.itemIds.includes(e)}(e))}};t.c=m}},0,[0,1,526,178,514,105,24,116]]);
//# sourceMappingURL=owa.GetItemManager.js.map
self.scriptsLoaded['owa.GetItemManager.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.GetItemManager.js'] = (new Date()).getTime();