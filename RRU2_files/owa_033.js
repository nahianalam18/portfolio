self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailFolderTreeContainerView~ReadWriteRecipientWell.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[72],{2075:function(e,t,n){"use strict";var r=n(2),i=Object(r.createStore)("recipientcache",{recipientCache:null,allKeys:{}})();t.a=i},2440:function(e,t,n){"use strict";n.d(t,"a",function(){return s}),n.d(t,"c",function(){return c}),n.d(t,"b",function(){return u});var r=n(4),i=n(2075),a=n(18);function s(e,t,n,i){return o(u(e),t,n,i,function(t,n){Object(a.o)("RecipientCacheHitIndex",[Math.ceil(n/50),!Object(r.g)(e),t.sessionAdd])})}function c(e,t,n,r){return o(e,t,n,r)}function o(e,t,n,r,a){for(var s=[],c=0;s.length<t&&i.a.recipientCache&&c<i.a.recipientCache.length;){var o=i.a.recipientCache[c];if(e(o)){var u=!1,l=o.EmailAddress;n&&d(l,n)&&(u=!0),r&&r.indexOf(l.MailboxType)>=0&&(u=!0),u||(s.push(o),a&&a(o,c))}c++}return s}var u=function(e){return function(t){var n=t.EmailAddress;if(n.EmailAddress&&0==n.EmailAddress.toLowerCase().indexOf(e))return!0;if(n.Name){if(0==n.Name.toLowerCase().indexOf(e))return!0;for(var r=n.Name.toLowerCase().split(" "),i=0;i<r.length;i++)if(0==r[i].indexOf(e))return!0}return!1}};function d(e,t){for(var n=0;n<t.length;n++)if(e.EmailAddress==t[n].EmailAddress.EmailAddress)return!0;return!1}},2449:function(e,t,n){"use strict";function r(e){if(e){var t=(e=(e=e.replace(/['"]+/g,"")).trim()).split(/([<\[\({])+/g),n=void 0,r=e;return t.length>=3&&(n=t.slice(0,t.length-2).join("").trim(),r=t[t.length-1].split(/([>\]\)}])+/g)[0].trim()),{EmailAddress:{MailboxType:"OneOff",RoutingType:"SMTP",EmailAddress:r,Name:n||r}}}return{EmailAddress:{EmailAddress:e}}}n.d(t,"a",function(){return r})},3470:function(e,t,n){"use strict";var r=n(4),i=n(8),a=n(3611),s=n.n(a),c=n(3612),o=n.n(c),u=n(26),d=n(11);function l(e){var t=o()({EntityFeedbackEntries:e});return s()({Header:Object(u.getJsonRequestHeader)(),Body:t}).then(function(e){!function(e){if(e&&e.Body){var t=e.Body;d.d.info(Object(r.b)("addEntityFeedback Error count: {0}",t.ErrorCount)),d.d.info(Object(r.b)("addEntityFeedback error details: {0}",t.ErrorDetails))}}(e)})}t.a=Object(i.action)("attemptToSubmitAddEntityFeedback")(function(e,t,n){e&&t&&(e.entityFeedbackEntries.push(t),(n||e.entityFeedbackEntries.length>=e.maxActionBatchSize)&&(l(e.entityFeedbackEntries),d.d.info(Object(r.b)("{0} Submitted {1} entities.",e.entityScenarioName,e.entityFeedbackEntries.length)),e.entityFeedbackEntries=[]))})},3473:function(e,t,n){"use strict";var r=n(0),i=n(1530),a=n.n(i),s=n(891),c=n.n(s),o=n(1397),u=n.n(o),d=n(542),l=n.n(d),f=n(1124),p=n.n(f),b=n(71),m=n.n(b),O=n(1125),h=n.n(O),v=n(26),S=20,g=10,y="owa.react.compose",j="NewMail.To";function R(e){return l()({BasePoint:"Beginning",Offset:0,MaxEntriesReturned:e?S:g})}function E(e){return{__type:"FindPeopleContextInfo:#Exchange",RecipientsTo:e}}function A(e){var t=e?j:y;return[a()({Key:"AppName",Value:"OWA"}),a()({Key:"AppScenario",Value:t})]}function I(e,t,n,r,i){var a=function(e,t,n,r){var i,a=["Mailbox"];return t&&a.push("Directory"),u()({IndexedPageItemView:R(t),PersonaShape:(i=[m()({FieldURI:"PersonaEmailAddress"}),m()({FieldURI:"EmailAddresses"}),m()({FieldURI:"PersonaDisplayName"}),m()({FieldURI:"PersonaDisplayNames"}),m()({FieldURI:"PersonaId"}),m()({FieldURI:"PersonaType"})],p()({BaseShape:"IdOnly",AdditionalProperties:i})),QuerySources:a,QueryString:e,SearchPeopleSuggestionIndex:!0,ShouldResolveOneOffEmailAddress:!1,IncludeImplicitGroups:n,Context:A(n),ContextInfo:E(r||[])})}(e,t,r,i);return h()(c()({Header:Object(v.getJsonRequestHeader)(),Body:a})).then(function(e){return e.Body})}var T=n(3660),P=n(1516);function _(){return Object(P.a)()?T.a:I}var w=n(8),C=n(3505),F=n(3585),x=n(3475),D=Object(w.action)("postProcessSuggestionsResult")(function(e,t,n,r){1==e.findResultSet.length&&r&&Object(F.a)(e)?Object(C.a)(e,[{isValid:!0,newPersona:e.findResultSet[0],newEmailAddress:null}]):(e.findResultType=n,Object(x.a)(e,!0,!1,t))}),k=n(3590);function N(e,t){Object(P.a)()?function(e,t){var n,i;try{for(var a=r.__values(t.Groups),s=a.next();!s.done;s=a.next()){var c=s.value;if("People"===c.Type){var o=c.Suggestions.filter(function(t){return null==e[t.EmailAddresses?t.EmailAddresses[0]:""]});c.Suggestions=o;break}}}catch(e){n={error:e}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}}(e,t):function(e,t){var n=t.ResultSet.filter(function(t){return null==e[t.EmailAddress?t.EmailAddress.EmailAddress:""]});t.ResultSet=n}(e,t)}var M=n(3722),q=Object(w.action)("processResponseResults")(function(e,t,n,r,i){if(n){var a=new Map;e.forEach(function(e){a[e.EmailAddress.EmailAddress]=e}),N(a,t)}Object(P.a)()?Object(k.a)(e,t,n,r,i):Object(M.a)(e,t,n,r)}),L=n(3478),W=n(3476),J=n(3498);function G(e){var t,n="";e&&(Object(P.a)()?(t=e).Groups&&t.Instrumentation&&(n=t.Instrumentation.TraceId):"Success"==(t=e).ResponseClass&&t.ResultSet&&(n=t.TransactionId));return n}var U=n(5),Q=n(2239),B=n(4),V=n(3470),H=n(3485),z=n(70),K=n(11),X=Object(w.action)("transactionCompleted")(function(e,t,n,r,i,a,s,c){if(void 0===c&&(c=null),e&&e.hasSessionStarted){var o={TransactionRequestTime:Object(U.mb)(i),TransactionRequestDuration:Object(U.w)(Object(U.Jb)(),i),QueryString:Object(B.g)(t)?"":t,QueryStringLength:Object(z.b)(t)?0:t.length,PersonaTypeList:s,ImpressionId:r,Cvid:e.conversationId};c&&Object.keys(c).forEach(function(e){o[e]=c[e]}),a&&(o.Context=a);var u=JSON.stringify(o),d=JSON.stringify(n),l=Object(H.a)(e,r,"TransactionCompleted",d,0,u);Object(V.a)(e,l,!1),K.d.info(Object(B.b)("{0} TransactionComplete. Session id: {1}",e.entityScenarioName,e.clientSessionId))}}),$=n(3589);function Y(e,t,n){var r=[];e.findResultSet&&e.findResultSet.length>0&&e.findResultSet.forEach(function(e){r.push($.a[e.PersonaTypeString])});var i,a;X(e.findPeopleFeedbackManager,e.queryString,(i=e.findResultSet,a=[],i&&i.forEach(function(e,t){a[t]=e.Id||e.EmailAddress.EmailAddress||e.EmailAddress.Name}),a),n,t,{Action:"Type Down"},r)}var Z=Object(w.action)("autoSearchDirectory")(function(e,t,n,i){return r.__awaiter(this,void 0,void 0,function(){var a,s,c;return r.__generator(this,function(r){switch(r.label){case 0:return a=_(),s=Object(U.Jb)(),Object(L.b)(e,s,null,!0),[4,a(n,!0,e.findPeopleFeedbackManager)];case 1:return c=r.sent(),Object(W.a)(e,!1),e.queryString.trim()==n&&(20,Object(J.a)(e,n),q(e.findResultSet,c,!1,20,!0),Object(L.b)(e,s,c,!0),Y(e,s,G(c)),e.directorySearchType=Q.a.Auto,0==e.findResultSet.length&&(e.findResultSet=[]),D(e,t,Q.b.SearchDirectory,i)),[2]}})})}),ee=n(2),te=n(3591),ne=n(3691),re=n(3692),ie=(Object(ee.orchestrator)(te.a,function(e){var t=e.targetRecipientWell,n=e.personaToRemove,r=e.shouldRemoveAllOccurrences,i=t.recipients.filter(function(e){return Object(ne.a)(e.persona,n)});if(i&&i.length>0){for(var a=r?i.length-1:0,s=[],c=0;c<=a;c++)i[c]&&!i[c].blockWellItemRemoval&&s.push(i[c]);s.length>0&&Object(re.a)(t,s)}}),n(3710)),ae=(Object(ee.orchestrator)(ie.a,function(e){var t=e.recipientWells;t&&0!==t.length&&e.emailAddresses.forEach(function(e){var n={EmailAddress:e};t.filter(function(e){return!!e}).forEach(function(e){return Object(te.a)(e,n,!0)})})}),n(3521)),se=Object(ee.action)("addRecipientsToRecipientWell",function(e,t){return{newRecipients:e,recipientWellRecipients:t}}),ce=se;Object(ee.mutator)(se,function(e){var t,n=e.recipientWellRecipients;(t=n.recipients).splice.apply(t,r.__spread([n.recipients.length,0],e.newRecipients)),n.isDirty=!0});var oe=Object(ee.mutatorAction)("resetRecipientWell",function(e){e&&(e.queryString="",e.findResultType=Q.b.None)}),ue=n(3628),de=n(2075),le=n(3711),fe=Object(w.action)("addToCache")(function(e){e&&0!=e.length&&e.forEach(function(e){if("LinkedIn"!=e.PersonaTypeString){var t=Object(le.a)(e);if(t&&!de.a.allKeys[t]){var n=r.__assign({},e,{sessionAdd:!0});de.a.recipientCache.push(n),de.a.allKeys[t]=!0}}})}),pe=n(3577),be=(Object(ee.orchestrator)(C.a,function(e){return r.__awaiter(void 0,void 0,void 0,function(){var t,n,i,a,s,c,o,u,d,l,f,p,b,m,O;return r.__generator(this,function(h){switch(h.label){case 0:t=e.recipientWell,n=e.recipientData,i=e.resetFindResult,a=[];try{for(s=r.__values(n),c=s.next();!c.done;c=s.next())o=c.value,l=Object(ae.a)(o.newPersona,o.isValid,o.newEmailAddress),a.push(l)}catch(e){p={error:e}}finally{try{c&&!c.done&&(b=s.return)&&b.call(s)}finally{if(p)throw p.error}}ce(a,t),h.label=1;case 1:h.trys.push([1,7,8,9]),u=r.__values(a),d=u.next(),h.label=2;case 2:return d.done?[3,6]:(l=d.value,i&&t?(oe(t),Object(x.a)(t,!0,!0),t.inForceResolve?[4,Object(ue.a)(t,t.recipients)]:[3,4]):[3,4]);case 3:h.sent(),h.label=4;case 4:l.isValid&&fe([l.persona]),h.label=5;case 5:return d=u.next(),[3,2];case 6:return[3,9];case 7:return f=h.sent(),m={error:f},[3,9];case 8:try{d&&!d.done&&(O=u.return)&&O.call(u)}finally{if(m)throw m.error}return[7];case 9:return Object(pe.a)(t,n),[2]}})})}),Object(ee.createStore)("readwriterecipientwell",{pendingFindPeopleRequests:0})()),me=Object(w.action)("transactionFailed")(function(e,t,n,r,i,a){if(void 0===a&&(a=null),e&&e.hasSessionStarted){var s={TransactionRequestTime:Object(U.mb)(r),TransactionRequestDuration:Object(U.w)(Object(U.Jb)(),r),QueryString:Object(B.g)(t)?"":t,QueryStringLength:Object(z.b)(t)?0:t.length,ImpressionId:n};a&&Object.keys(a).forEach(function(e){s[e]=a[e]}),i&&(s.Context=i);var c=JSON.stringify(s),o=Object(H.a)(e,n,"TransactionFailed",null,0,c);Object(V.a)(e,o,!1),K.d.info(Object(B.b)("{0} TransactionComplete. Session id: {1}",e.entityScenarioName,e.clientSessionId))}});function Oe(e,t,n){me(e.findPeopleFeedbackManager,e.queryString,n,t,{Action:"Type Down"})}var he=Object(w.action)("backfillCache")(function(e,t){return r.__awaiter(this,void 0,void 0,function(){var n,i;return r.__generator(this,function(r){return be.pendingFindPeopleRequests++,n=_(),i=Object(U.Jb)(),Object(L.b)(e,i,null),[2,n(t,!1).then(function(n){var r=G(n);try{var a=function(e){if(Object(P.a)()){var t=[];return Object(k.a)(t,e,!1),t}return e.ResultSet}(n);if(fe(a),be.pendingFindPeopleRequests--,!function(e){if(Object(P.a)()){var t=e;return!t||!t.Groups}var t=e;return"Success"!=t.ResponseClass||0==t.ResultSet.length}(n)&&e.queryString==t){var s=e.findResultSet.length>0;Object(L.b)(e,i,n),q(e.findResultSet,n,s,5),Y(e,i,r)}}catch(t){Oe(e,i,r)}})]})})});var ve=n(3593),Se=n(18),ge=Object(w.action)("setFindResultSet")(function(e,t){e.findResultSet=t});var ye=n(3520),je=Object(w.action)("processCacheResult")(function(e,t,n,i,a){return r.__awaiter(this,void 0,void 0,function(){var s;return r.__generator(this,function(c){return i&&(s=new Map,e.findResultSet.forEach(function(e){s[e.EmailAddress.EmailAddress]=e}),t=function(e,t){return t.filter(function(t){return null==e[t.EmailAddress?t.EmailAddress.EmailAddress:""]})}(s,t),(t=r.__spread(e.findResultSet,t)).splice(5)),Object(W.a)(e,!1),ge(e,t),Object(ye.a)(e),D(e,n,Q.b.Cache,a),[2]})})}),Re=n(2440);function Ee(e,t){var n=Object(Re.a)(e,5,t);return 0==n.length?[]:n.map(function(e){return{EmailAddress:e.EmailAddress,PersonaId:e.PersonaId,ADObjectId:e.ADObjectId,PersonaTypeString:e.PersonaTypeString}})}var Ae=n(3496),Ie=Object(w.action)("findPeopleCacheFirst")(function(e,t,n,i,a){return r.__awaiter(this,void 0,void 0,function(){var s,c,o;return r.__generator(this,function(r){switch(r.label){case 0:if(s=Q.b.Cache,c=new Se.a(ve.a.SearchCacheFirst.name),e.directorySearchType=Q.a.None,Object(W.a)(e,!0),function(e,t,n,r,i){var a=Object(U.Jb)(),s=Ee(e,Object(Ae.a)(t));Object(L.a)(n,a,s),je(n,s,t,r,i)}(t,n,e,i,a),Object(J.a)(e,t),!(e.findResultSet.length<5))return[3,6];r.label=1;case 1:return r.trys.push([1,5,,6]),e.findResultSet.length>0&&be.pendingFindPeopleRequests<3?(he(e,t),s=Q.b.MixedCacheLive,[3,4]):[3,2];case 2:return 0!=e.findResultSet.length?[3,4]:[4,he(e,t)];case 3:r.sent(),s=Q.b.FindPeople,r.label=4;case 4:return[3,6];case 5:return o=r.sent(),be.pendingFindPeopleRequests--,c.endWithError("ServerError",o),[3,6];case 6:return e.findResultSet.length>0?(D(e,n,s,a),[3,9]):[3,7];case 7:return[4,Z(e,n,t,a)];case 8:r.sent(),s=Q.b.SearchDirectory,r.label=9;case 9:return Object(W.a)(e,!1),c.addCustomData([s,t==e.queryString]),c.end(),[2]}})})}),Te=5;var Pe=n(3586),_e=n(6),we=n(3599),Ce=Object(w.action)("searchCacheFallback")(function(e,t,n,i,a,s){return r.__awaiter(this,void 0,void 0,function(){var c,o;return r.__generator(this,function(r){return e.queryString.trim()==t.trim()&&(c=Object(U.Jb)(),o=Ee(t,Object(Ae.a)(n)),Object(L.a)(e,c,o,!0),Object(J.a)(e,t),e.directorySearchType=Q.a.None,o.length>0?je(e,o,n,i,a):s&&(s.isCacheEmpty=!0)),[2]})})});t.a=Object(w.action)("findReadWriteRecipient")(Object(w.select)({store:function(){return be}})(function(e,t,n,i,a,s,c,o){return r.__awaiter(this,void 0,void 0,function(){var u,d,l,f,p,b,m,O,h,v,S,g,y,j,R,E,A,I;return r.__generator(this,function(T){switch(T.label){case 0:return n||Object(L.c)(e),u=Object(Pe.a)(e,a),d=!1,e.shouldShowFindResult||Object(x.a)(e,!0,!1,u),s&&s.length>0&&(l=function(e,t){var n=[];if(t){var r=0;for(e=e.toLowerCase();n.length<Te&&r<t.length;){var i=t[r].persona.EmailAddress;(i.EmailAddress&&0==i.EmailAddress.toLowerCase().indexOf(e)||i.Name&&0==i.Name.toLowerCase().indexOf(e))&&n.push({EmailAddress:i}),r++}}return n}(t,s))&&l.length>0&&(e.findResultSet=l,d=!0),!c&&!Object(_e.e)("rp-peopleSuggestionsCacheFirst")||n?[3,2]:[4,Ie(e,t,u,d,i)];case 1:return T.sent(),[2];case 2:return f=!1,o.store.pendingFindPeopleRequests<3?(I=new Se.a(ve.a.SearchPeopleIndex.name),Object(W.a)(e,!0),p=e.currentRenderedQueryString,b=e.directorySearchType,Object(_e.e)("rp-optimizeAutoSearchDirectory")&&""!=p&&!n&&b==Q.a.Auto&&p.length<t.length&&0==t.indexOf(e.currentRenderedQueryString)?[4,Z(e,u,t,i)]:[3,4]):[3,14];case 3:return T.sent(),f=!0,I.addCustomData([!1,!0,!0,!1,!0,Object(P.a)()]),I.end(),[3,13];case 4:m={isTimedOut:!1,isCacheEmpty:!1},O=n||Object(we.a)()?null:setTimeout(function(e,t,n,i,a,s){return function(){return r.__awaiter(void 0,void 0,void 0,function(){return r.__generator(this,function(r){switch(r.label){case 0:return s.isTimedOut=!0,[4,Ce(e,n,t,i,a,s)];case 1:return r.sent(),[2]}})})}}(e,u,t,d,i,m),1e3),h=Object(U.Jb)(),v="",T.label=5;case 5:return T.trys.push([5,11,,13]),o.store.pendingFindPeopleRequests++,S=_(),g=[],u.forEach(function(e){g.push(e.persona.EmailAddress.EmailAddress)}),Object(L.b)(e,h,null,n),[4,S(t,n,e.findPeopleFeedbackManager,Object(_e.e)("cmp-implicitgroups"),g)];case 6:return y=T.sent(),o.store.pendingFindPeopleRequests--,clearTimeout(O),j=e.queryString==t,Object(L.b)(e,h,y,n),m.isTimedOut&&!m.isCacheEmpty||!j?[3,10]:(Object(J.a)(e,t),e.directorySearchType=n?Q.a.Manual:Q.a.None,R=n?20:5,q(e.findResultSet,y,d,R,n),v=G(y),Y(e,h,v),e.findResultSet.length>0?(Object(W.a)(e,!1),E=n?Q.b.SearchDirectory:Q.b.FindPeople,D(e,u,E,i),[3,10]):[3,7]);case 7:return[4,Ce(e,t,u,d,i)];case 8:return T.sent(),0!==e.findResultSet.length?[3,10]:(f=!0,[4,Z(e,u,t,i)]);case 9:T.sent(),T.label=10;case 10:return I.addCustomData([m.isTimedOut,j,n,m.isCacheEmpty,f,Object(P.a)()]),I.end(),[3,13];case 11:return A=T.sent(),I.endWithError("ServerError",A),Oe(e,h,v),[4,Ce(e,t,u,d,i)];case 12:return T.sent(),[3,13];case 13:return[3,16];case 14:return I=new Se.a("FindPeopleThresholdHit"),[4,Ce(e,t,u,d,i)];case 15:T.sent(),I.end(),T.label=16;case 16:return Object(W.a)(e,!1),[2]}})})}))},3475:function(e,t,n){"use strict";var r=n(3586),i=n(3587),a=n(3588),s=n(3571),c=n(3520),o=n(3496),u=n(8);t.a=Object(u.action)("showHideFindResult")(function(e,t,n,u){var d=e.findResultSet?e.findResultSet.length:0;if(e.findResultHightlightIndex=-1,n&&d&&e.findResultSet.splice(0,d),t)if(Object(a.a)(e.findPeopleFeedbackManager),0!=e.queryString.length||e.inForceResolve)e.findResultHightlightIndex=0;else{var l=Object(r.a)(e,u);Object(s.a)(e.findResultSet,Object(o.a)(l)),Object(c.a)(e)}else Object(i.a)(e.findPeopleFeedbackManager);e.shouldShowFindResult=t})},3476:function(e,t,n){"use strict";var r=n(8);t.a=Object(r.action)("setIsSearching")(function(e,t){e.isSearching!=t&&(e.isSearching=t)})},3478:function(e,t,n){"use strict";var r=n(5),i=n(1516);n.d(t,"c",function(){return u}),n.d(t,"b",function(){return d}),n.d(t,"a",function(){return l});var a="Cache",s="Mailbox",c="Directory",o=" Fallback";function u(e){e.peopleFeedbackState={live:null,cache:null,directory:null}}function d(e,t,n,a){if(i.a&&e.peopleFeedbackState){var o={TraceId:"",TimeStamp:"",QueryString:"",SuggestionSource:"",RawResponse:""};o.TimeStamp=Object(r.wb)(t),o.QueryString=e.queryString,o.SuggestionSource=a?c:s;var u=n;o.RawResponse=u?JSON.stringify(u):"pending",u&&u.Instrumentation&&(o.TraceId=u.Instrumentation.TraceId),a?e.peopleFeedbackState.directory=o:e.peopleFeedbackState.live=o}}function l(e,t,n,s){if(Object(i.a)()&&e.peopleFeedbackState){var c={TraceId:"",TimeStamp:"",QueryString:"",SuggestionSource:"",RawResponse:""};c.QueryString=e.queryString,c.TimeStamp=Object(r.wb)(t),c.SuggestionSource=s?a+o:a,c.RawResponse=JSON.stringify(n),e.peopleFeedbackState.cache=c}}},3485:function(e,t,n){"use strict";var r=n(4),i=n(8),a=Object(i.action)("increaseEntrySequenceNumber")(function(e){e&&e.entrySequenceNumber++}),s=n(70),c=n(11),o=n(5);function u(e,t,n,i,u,d,l,f){if(void 0===f&&(f=Object(o.Jb)()),!e)return c.d.warn("Attempting to create entity feedback entry with invalid feedbackManager"),null;if(Object(s.b)(e.clientSessionId))return c.d.warn(Object(r.b)("{0} - Attempting to create entity feedback entry with empty client session id",e.entityScenarioName)),null;var p={ClientEventTimeUtc:Object(o.ob)(f),ClientEventTimeLocal:Object(o.mb)(f),ClientSessionId:e.clientSessionId,ClientVersion:e.clientVersion,ClientId:e.clientId,EntityType:e.entityType,EntrySequenceNumber:e.entrySequenceNumber,TransactionId:t,EventType:n,TargetEntityList:i,EntityAddSource:u,JsonPropertyBag:d,ScenarioName:l||e.entityScenarioName};return a(e),p}n.d(t,"a",function(){return u})},3496:function(e,t,n){"use strict";function r(e){var t=[];return e&&(t=e.map(function(e){return e.persona})),t}n.d(t,"a",function(){return r})},3498:function(e,t,n){"use strict";var r=n(8);t.a=Object(r.action)("updateCurrentRenderedQueryString")(function(e,t){e.currentRenderedQueryString=t})},3505:function(e,t,n){"use strict";var r=n(2),i=Object(r.action)("addReadWriteRecipients",function(e,t,n){return void 0===n&&(n=!0),{recipientWell:e,recipientData:t,resetFindResult:n}});t.a=i},3520:function(e,t,n){"use strict";var r=n(4),i=n(3470),a=n(3485),s=n(5),c=n(70),o=n(11),u=n(8),d=n(92),l=Object(u.action)("localCacheTransactionCompleted")(function(e,t,n,u,l,f){if(void 0===f&&(f=Object(s.Jb)()),e&&e.hasSessionStarted){var p={TransactionRequestTime:Object(s.mb)(f),TransactionRequestDuration:Object(s.w)(Object(s.Jb)(),f),QueryString:Object(r.g)(t)?"":t,QueryStringLength:Object(c.b)(t)?0:t.length,FeatureData:null!=u?u:void 0,personaTypeList:l,ImpressionId:Object(d.a)(),Cvid:e.conversationId},b=JSON.stringify(p),m=JSON.stringify(n),O=Object(a.a)(e,"","LocalCacheTransactionCompleted",m,0,b);Object(i.a)(e,O,!1),o.d.info(Object(r.b)("{0} LocalCacheTransactionCompleted. Session id: {1}",e.entityScenarioName,e.clientSessionId))}}),f=n(3589);function p(e){if(e.findResultSet&&e.findResultSet.length>0){var t=[];e.findResultSet.forEach(function(e){t.push(f.a[e.PersonaTypeString])}),l(e.findPeopleFeedbackManager,e.queryString,(n=e.findResultSet,r=[],n&&n.forEach(function(e,t){r[t]=e.EmailAddress.EmailAddress}),r),null,t)}var n,r}n.d(t,"a",function(){return p})},3521:function(e,t,n){"use strict";var r=n(2441),i=n(1020),a=n(44),s=n(3676);t.a=function(e,t,n){e||(e={EmailAddress:{MailboxType:"OneOff",RoutingType:"SMTP",EmailAddress:n,Name:n}});var c=!e.EmailAddress.Name||Object(s.a)(e.EmailAddress.Name)?e.EmailAddress.EmailAddress:e.EmailAddress.Name;if(!Object(a.a)()){var o=e.EmailAddress.EmailAddress?e.EmailAddress.EmailAddress.split("@")[1]:"",u="ExternalMailbox"===e.EmailAddress.MailboxType||"LinkedIn"===e.EmailAddress.MailboxType;!c||Object(i.a)(c)&&c.split("@")[1]===o||!u||(c=c+" ("+o+")")}return{persona:e,displayText:c,isValid:t,isContextMenuOpen:!1,isSelected:!1,isExpanding:!1,isEditing:!1,isFadedOut:!1,expansionStatus:r.a.None,members:[]}}},3526:function(e,t,n){"use strict";var r=n(8);t.a=Object(r.action)("setCommonWellItemSelectedState")(function(e,t){e.isSelected=t})},3552:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(4),i=n(3485),a=n(11);function s(e,t){if(Object(r.g)(e.clientSessionId))return a.d.warn(Object(r.b)("{0} - Attempting to create session feedback entry with empty client session id",e.entityScenarioName)),null;var n="";t&&(n=null==t.recipientEmailAddresses?"":JSON.stringify(t.recipientEmailAddresses));var s="";if(!Object(r.g)(t.endSessionAction)){var c={EndSessionAction:t.endSessionAction};s=JSON.stringify(c)}return Object(i.a)(e,"",t.eventType,n,0,s)}},3557:function(e,t,n){"use strict";var r=n(8);t.a=Object(r.action)("updateIsEditing")(function(e,t){e.isEditing=t})},3571:function(e,t,n){"use strict";var r=n(0),i=n(2440),a=n(8);t.a=Object(a.action)("getAndPopulateSuggestedContacts")(function(e,t){var n=Object(i.a)("",5,t).map(function(e){return{EmailAddress:e.EmailAddress,PersonaId:e.PersonaId,ADObjectId:e.ADObjectId}});e.splice.apply(e,r.__spread([0,e.length],n))})},3572:function(e,t,n){"use strict";var r=n(8);t.a=Object(r.action)("setForceResolveState")(function(e,t){e.inForceResolve=t})},3577:function(e,t,n){"use strict";var r=n(2),i=Object(r.action)("onRecipientsChanged",function(e,t){return{recipientWellRecipients:e,recipientData:t}});t.a=i},3585:function(e,t,n){"use strict";function r(e){return void 0!==e.recipients}n.d(t,"a",function(){return r})},3586:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(3585);function i(e,t){return Object(r.a)(e)?e.recipients:t||[]}},3587:function(e,t,n){"use strict";var r=n(4),i=n(3470),a=n(3552),s=n(11),c=n(8);t.a=Object(c.action)("pauseSession")(function(e){if(e&&e.hasSessionStarted&&!e.isSessionPaused){var t=Object(a.a)(e,{eventType:"SessionPaused",recipientEmailAddresses:null,endSessionAction:null});Object(i.a)(e,t,!1),e.isSessionPaused=!0,s.d.info(Object(r.b)("{0} pauseSession : Session paused. Session id: {1}",e.entityScenarioName,e.clientSessionId))}})},3588:function(e,t,n){"use strict";var r=n(4),i=n(3470),a=n(3552),s=n(11),c=n(8);t.a=Object(c.action)("resumeSession")(function(e){if(e&&e.isSessionPaused){var t=Object(a.a)(e,{eventType:"SessionResumed",recipientEmailAddresses:null,endSessionAction:null});Object(i.a)(e,t,!1),e.isSessionPaused=!1,s.d.info(Object(r.b)("{0} FeedbackManagerBase.ResumeSession: Session resumed. Session id: {1}",e.entityScenarioName,e.clientSessionId))}})},3589:function(e,t,n){"use strict";t.a={Unknown:0,Person:1,DistributionList:2,ModernGroup:5,ImplicitGroup:10,ExplicitGroup:11,LinkedIn:12}},3590:function(e,t,n){"use strict";var r=n(0),i=n(8),a=n(3688);t.a=Object(i.action)("processSubstrateSuggestionsResponse")(function(e,t,n,i,s){var c,o;if(!t||!t.Groups)throw new Error("Response groups should not be null");var u=[];i=i||20,i=n?i-e.length:i;var d=t.Instrumentation&&t.Instrumentation.TraceId;try{for(var l=r.__values(t.Groups),f=l.next();!f.done;f=l.next()){var p=f.value;if("People"===p.Type){p.Suggestions.forEach(function(e){if(u.length<i){var t=Object(a.a)(e,d,s);t&&u.push(t)}});break}}}catch(e){c={error:e}}finally{try{f&&!f.done&&(o=l.return)&&o.call(l)}finally{if(c)throw c.error}}n?e.push.apply(e,r.__spread(u)):e.splice.apply(e,r.__spread([0,e.length],u))})},3591:function(e,t,n){"use strict";var r=n(2),i=Object(r.action)("removePersonaFromWell",function(e,t,n){return void 0===n&&(n=!1),{targetRecipientWell:e,personaToRemove:t,shouldRemoveAllOccurrences:n}});t.a=i},3593:function(e,t,n){"use strict";t.a={SearchPeopleIndex:{name:"SearchPeopleIndex"},AddRecipientFromFindControl:{name:"AddRecipientFromFindControl",customData:function(e,t){return{index:(e>23?23:e).toString(),source:t.toString()}}},SearchCacheFirst:{name:"SearchCacheFirst"}}},3599:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(2075);function i(){return null===r.a.recipientCache||0==r.a.recipientCache.length}},3611:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(56),i=n(3649);t.default=function(e,t){return void 0===e||e.__type||(e=i.default(e)),r.makeServiceRequest("AddEntityFeedback",e,t)}},3612:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"AddEntityFeedbackRequest:#Exchange"},e)}},3628:function(e,t,n){"use strict";var r=n(0),i=n(3732),a=n(3572),s=n(3475),c=n(3557),o=n(8),u=n(18);t.a=Object(o.action)("resolveAllUnresolvedRecipients")(function(e,t,n){return r.__awaiter(this,void 0,void 0,function(){var o,d,l;return r.__generator(this,function(r){switch(r.label){case 0:return Object(a.a)(e,!0),e.queryString=e.queryString.trim(),e.recipients&&e.queryString?(n&&n(),[4,Object(i.a)(e,!1,!0,!0)]):[3,2];case 1:return r.sent(),[3,3];case 2:for(o=-1,d=0;d<t.length;d++)if(t[d].persona&&t[d].persona.EmailAddress&&!t[d].persona.EmailAddress.EmailAddress&&"PrivateDL"!=(l=t[d].persona).EmailAddress.MailboxType&&Object(u.o)("EmptyEmailAddress",[l.EmailAddress.MailboxType,l.EmailAddress.RoutingType]),!t[d].isValid){o=d;break}-1!=o?Object(c.a)(t[o],!0):(Object(a.a)(e,!1),Object(s.a)(e,!1)),r.label=3;case 3:return[2]}})})})},3648:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=["Id","ADObjectId","DisplayName","EmailAddresses","PeopleSubtype","PeopleType","PDLItemId","PersonaId","ImAddress","JobTitle"]},3649:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"AddEntityFeedbackJsonRequest:#Exchange"},e)}},3660:function(e,t,n){"use strict";var r=n(0),i=n(3479);function a(){return"Bound"==Object(i.e)().status}var s=n(6),c=n(92),o=n(65),u=n(303),d=n(44),l=n(3648),f=n(242),p=n(11);n.d(t,"a",function(){return y});var b="/search/api/v1/init?",m="https://outlook.office365.com/search",O="https://substrate.office.com/SubstrateSearch-Internal.ReadWrite",h="/search/api/v1/suggestions?",v="owa.react.compose",S="20",g="5";function y(e,t,n,i,a){return r.__awaiter(this,void 0,void 0,function(){var i,s,u,d;return r.__generator(this,function(r){switch(r.label){case 0:return""!=e?[3,1]:[2,j()];case 1:return[4,R(e,t,a)];case 2:return i=r.sent(),s=function(e,t){return{AppName:"OWA",Scenario:{Name:v},Cvid:t||Object(c.a)(),EntityRequests:[e]}}(i,n&&n.conversationId),u=o.d,d=[h+A(),s,void 0,!1],[4,I(n&&n.clientSessionId)];case 3:return[2,u.apply(void 0,d.concat([r.sent(),void 0,void 0,!1])).then(function(e){return e}).catch(function(e){return p.d.error(e),null})]}})})}function j(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n,i,c,l;return r.__generator(this,function(r){switch(r.label){case 0:return Object(d.a)()&&Object(s.e)("rp-linkedInPeopleSuggestions")&&a()?((e={}).headers=new Headers,[4,Object(f.getDelegationTokenForOwa)(O)]):[3,3];case 1:return t=r.sent(),e.headers.set("X-User-Context","litoken=bearer"),e.headers.set("Authorization","Bearer "+t),(n=Object(u.getDefaultAnchorMailboxCookie)())&&e.headers.append("X-AnchorMailbox",n),e.method="GET",[4,fetch(window.location.origin+b+A(),e)];case 2:return(i=r.sent())&&200==i.status?[2,i]:(p.d.error("makeInitRequest: Unsuccessful response status"),[2,null]);case 3:return c=o.b,l=[b+A(),void 0,!0],[4,I()];case 4:return[2,c.apply(void 0,l.concat([r.sent(),void 0,!1])).then(function(e){return e.json()}).catch(function(e){return p.d.error(e),null})]}})})}function R(e,t,n){return r.__awaiter(this,void 0,void 0,function(){var i,c;return r.__generator(this,function(r){return i=Object(s.e)("rp-linkedInPeopleSuggestions")&&a(),c={Query:{QueryString:e},EntityType:"People",Provenances:E(t,i),Size:t?S:g},n&&n.length>0&&(c.Context=function(e){var t={};e&&(t.RecipientsTo=e.toString());return t}(n)),c.Fields=l.a,[2,c]})})}function E(e,t){var n=["Mailbox"];return e&&n.push("Directory"),t&&n.push("LinkedIn"),n}function A(){var e={scenario:v};return Object.keys(e).map(function(t){return t+"="+e[t]}).join("&")}function I(e){return r.__awaiter(this,void 0,void 0,function(){var t,n;return r.__generator(this,function(r){switch(r.label){case 0:return t={},e&&(t["client-session-id"]=e),Object(s.e)("rp-linkedInPeopleSuggestions")&&a()?Object(d.a)()?(t["X-User-Context"]="litoken=bearer",[3,3]):[3,1]:[3,3];case 1:return[4,Object(f.getAccessTokenforResource)(m)];case 2:n=r.sent(),t["X-User-Context"]="litoken="+n,r.label=3;case 3:return[2,t]}})})}},3675:function(e,t,n){"use strict";var r=n(0),i=n(2),a=Object(i.action)("removeRecipientFromRecipientWell",function(e,t,n,r){return{recipientIndex:e,recipientWellRecipients:t,onRecipientDeletedCallback:n,deletedRecipient:t.recipients[e],newRecipients:r}});Object(i.mutator)(a,function(e){var t;e.recipientWellRecipients.isDirty=!0,(t=e.recipientWellRecipients.recipients).splice.apply(t,r.__spread([e.recipientIndex,1],e.newRecipients||[]))}),Object(i.orchestrator)(a,function(e){e.onRecipientDeletedCallback([e.deletedRecipient],e.recipientIndex,e.recipientWellRecipients)}),t.a=a},3676:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=["\t","\n","\v","\f","\r"," ",""," "," "," "," "," "," "," "," "," "," "," "," "," ","\u2028","\u2029"," "," ","　","؜","​","‌","‍","‎","‏","\u2028","\u2029","‪","‫","‬","‭","‮"," ","⁠","⁦","⁧","⁨","⁩"],i=null,a=function(e){return null===i&&(i=new Set,r.forEach(function(e){return i.add(e)})),e.split("").every(function(e){return i.has(e)})}},3688:function(e,t,n){"use strict";var r=n(4),i=n(1527);function a(e,t,n){var a=e.EmailAddresses,u=e.DisplayName,d=e.Text,l=e.PDLItemId,f=e.ADObjectId,p=e.PersonaId,b=e.FeatureData,m=e.Id,O=e.ReferenceId,h=e.ImAddress,v=e.JobTitle,S=e.PeopleSubtype,g=a?a[0]:null;if(!n&&function(e){return Object(i.b)().sessionMaskedRecipients[e]}(g))return null;var y={EmailAddress:g,Name:Object(r.g)(u)?d:u,MailboxType:o(S),RoutingType:s(S),ItemId:l?{Id:l,__type:"ItemId:#Exchange"}:null};return{DisplayName:u,ADObjectId:f,FeatureData:b,Id:m,ImAddress:h,EmailAddress:y,EmailAddresses:[y],PersonaTypeString:c(S),PersonaId:{Id:p},Title:v,ReferenceId:O,TransactionId:t}}function s(e){return"PersonalDistributionList"==e?"MAPIPDL":"SMTP"}function c(e){switch(e){case"PublicDistributionList":case"PersonalDistributionList":return"DistributionList";case"UnifiedGroup":return"ModernGroup";case"OrganizationUser":case"PersonalContact":case"ImplicitContact":case"OrganizationContact":return"Person";case"LinkedIn":return"LinkedIn";case"ImplicitGroup":return"ImplicitGroup";default:return"Unknown"}}function o(e){switch(e){case"PublicDistributionList":return"PublicDL";case"PersonalDistributionList":return"PrivateDL";case"UnifiedGroup":return"GroupMailbox";case"ImplicitGroup":return"RecommendedGroup";case"OrganizationUser":return"InternalMailbox";case"LinkedIn":return"LinkedIn";case"PersonalContact":case"OrganizationContact":case"ImplicitContact":case"Guest":case"Unknown":return"ExternalMailbox";default:return e}}n.d(t,"a",function(){return a})},3691:function(e,t,n){"use strict";function r(e,t){return null!=e&&null!=t&&(e==t||e.EmailAddress&&t.EmailAddress&&null!=e.EmailAddress.EmailAddress&&null!=t.EmailAddress.EmailAddress&&e.EmailAddress.EmailAddress.toLowerCase()==t.EmailAddress.EmailAddress.toLowerCase()||e.ADObjectId&&t.ADObjectId&&e.ADObjectId==t.ADObjectId||e.PersonaId&&t.PersonaId&&e.PersonaId==t.PersonaId)}n.d(t,"a",function(){return r})},3692:function(e,t,n){"use strict";var r=n(0),i=n(3577),a=n(3675),s=n(3526),c=n(8);function o(e,t,n){e[0].isSelected&&n.recipients.length>0&&Object(s.a)(n.recipients[Math.max(0,t-1)],!0)}t.a=Object(c.action)("removeReadWriteRecipients")(function(e,t,n){var s,c;void 0===n&&(n=!0);var u=!1;try{for(var d=r.__values(t),l=d.next();!l.done;l=d.next()){var f=l.value,p=-1;if((p="number"==typeof f?f:e.recipients.indexOf(f))>=0){if(e.recipients[p].blockWellItemRemoval)return;Object(a.a)(p,e,o),u=!0}}}catch(e){s={error:e}}finally{try{l&&!l.done&&(c=d.return)&&c.call(d)}finally{if(s)throw s.error}}n&&u&&Object(i.a)(e)})},3710:function(e,t,n){"use strict";var r=n(2),i=Object(r.action)("removeRecipientsFromRecipientWells",function(e,t){return{emailAddresses:e,recipientWells:t}});t.a=i},3711:function(e,t,n){"use strict";function r(e){return e?e.EmailAddress&&e.EmailAddress.EmailAddress||e.PersonaId&&e.PersonaId.Id:null}n.d(t,"a",function(){return r})},3722:function(e,t,n){"use strict";var r=n(0),i=n(8);t.a=Object(i.action)("processFindPeopleResult")(function(e,t,n,i){if("Success"!=t.ResponseClass||!t.ResultSet)throw new Error("Response resultSet should not be null");i=i||20,i=n?i-e.length:i,i=t.ResultSet.length>i?i:t.ResultSet.length;for(var c=t.TransactionId,o=[],u=0;u<i;u++){var d=t.ResultSet[u];d.EmailAddress?o.push({EmailAddress:a(d.EmailAddress),PersonaId:d.PersonaId,ADObjectId:d.ADObjectId,PersonaTypeString:d.PersonaTypeString,DisplayName:d.DisplayName,TransactionId:c}):"ImplicitGroup"==d.PersonaTypeString&&o.push({EmailAddress:s(d),PersonaId:d.PersonaId,ADObjectId:d.ADObjectId,Members:d.Members,PersonaTypeString:d.PersonaTypeString,DisplayName:d.DisplayName,TransactionId:c})}n?e.push.apply(e,r.__spread(o)):e.splice.apply(e,r.__spread([0,e.length],o))});var a=function(e){return e.RoutingType&&"EX"===e.RoutingType.toUpperCase()?r.__assign({},e,{EmailAddress:e.OriginalDisplayName}):e},s=function(e){return{EmailAddress:e.FeedbackId,OriginalDisplayName:e.FeedbackId,Name:e.DisplayName,MailboxType:"GroupMailbox",RoutingType:"SMTP"}}},3732:function(e,t,n){"use strict";var r=n(0),i=n(3505),a=n(3473),s=n(8),c=Object(s.action)("setDirectorySearchType")(function(e,t){e.directorySearchType=t}),o=n(3476),u=n(3475),d=n(2449),l=n(2239),f=n(1020);t.a=Object(s.action)("resolveQueryStringToRecipient")(function(e,t,n,s){return r.__awaiter(this,void 0,void 0,function(){var p,b;return r.__generator(this,function(r){switch(r.label){case 0:return c(e,n?l.a.Manual:l.a.None),(p=e.queryString.trim())?t?(Object(o.a)(e,!1),b=Object(d.a)(p),Object(i.a)(e,[{isValid:Object(f.a)(b.EmailAddress.EmailAddress),newPersona:b}]),[3,4]):[3,1]:[3,5];case 1:return e.queryString.indexOf("@")>=0&&e.inForceResolve?(Object(o.a)(e,!1),Object(i.a)(e,[{isValid:Object(f.a)(p),newPersona:null,newEmailAddress:p}]),[3,4]):[3,2];case 2:return Object(o.a)(e,!0),[4,Object(a.a)(e,e.queryString,n,s)];case 3:r.sent(),r.label=4;case 4:return[3,6];case 5:Object(o.a)(e,!1),Object(u.a)(e,!0,!0),r.label=6;case 6:return[2]}})})})}}]);
//# sourceMappingURL=owa.MailFolderTreeContainerView~ReadWriteRecipientWell.js.map
self.scriptsLoaded['owa.MailFolderTreeContainerView~ReadWriteRecipientWell.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailFolderTreeContainerView~ReadWriteRecipientWell.js'] = (new Date()).getTime();