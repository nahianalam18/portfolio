self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.SubstrateSuggestions.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[425],{13960:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(3660),o=n(8),u=n(3479),c=Object(o.action)("execute3SPrimeCall")(function(e){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(t){switch(t.label){case 0:return e?[4,u.b.importAndExecute()]:[3,2];case 1:t.sent(),t.label=2;case 2:return Object(i.a)("",!1),[2]}})})});n.d(t,"execute3SPrimeCall",function(){return c})},3466:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(2),i=Object(r.createStore)("linkedInStore",{status:null})},3479:function(e,t,n){"use strict";var r=n(3),i=n(3640),o=n(18);var u=n(3466);function c(){return"Unbound"===Object(u.a)().status}function a(){return"Bound"===Object(u.a)().status}n.d(t,"a",function(){return d}),n.d(t,"b",function(){return l}),n.d(t,"d",function(){return c}),n.d(t,"e",function(){return u.a}),n.d(t,"c",function(){return a});var s=new r.c(function(){return n.e(298).then(n.bind(null,13848))}),d=new r.a(s,function(e){return e.connectToLinkedIn}),l=new r.a(s,function(e){return e.initializeBindStatus});"undefined"!=typeof window&&void 0!==window.Owa&&(window.Owa.completeLinkedInBind=function(e){Object(o.o)("linkedInBindComplete",[e]),Object(i.a)(e?"Unbound":"Bound")})},3640:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(2),i=n(3466),o=Object(r.mutatorAction)("updateBindStatus",function(e){Object(i.a)().status=e})},3648:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=["Id","ADObjectId","DisplayName","EmailAddresses","PeopleSubtype","PeopleType","PDLItemId","PersonaId","ImAddress","JobTitle"]},3660:function(e,t,n){"use strict";var r=n(0),i=n(3479);function o(){return"Bound"==Object(i.e)().status}var u=n(6),c=n(92),a=n(65),s=n(303),d=n(44),l=n(3648),f=n(242),b=n(11);n.d(t,"a",function(){return _});var v="/search/api/v1/init?",h="https://outlook.office365.com/search",p="https://substrate.office.com/SubstrateSearch-Internal.ReadWrite",w="/search/api/v1/suggestions?",j="owa.react.compose",O="20",g="5";function _(e,t,n,i,o){return r.__awaiter(this,void 0,void 0,function(){var i,u,s,d;return r.__generator(this,function(r){switch(r.label){case 0:return""!=e?[3,1]:[2,m()];case 1:return[4,I(e,t,o)];case 2:return i=r.sent(),u=function(e,t){return{AppName:"OWA",Scenario:{Name:j},Cvid:t||Object(c.a)(),EntityRequests:[e]}}(i,n&&n.conversationId),s=a.d,d=[w+S(),u,void 0,!1],[4,y(n&&n.clientSessionId)];case 3:return[2,s.apply(void 0,d.concat([r.sent(),void 0,void 0,!1])).then(function(e){return e}).catch(function(e){return b.d.error(e),null})]}})})}function m(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n,i,c,l;return r.__generator(this,function(r){switch(r.label){case 0:return Object(d.a)()&&Object(u.e)("rp-linkedInPeopleSuggestions")&&o()?((e={}).headers=new Headers,[4,Object(f.getDelegationTokenForOwa)(p)]):[3,3];case 1:return t=r.sent(),e.headers.set("X-User-Context","litoken=bearer"),e.headers.set("Authorization","Bearer "+t),(n=Object(s.getDefaultAnchorMailboxCookie)())&&e.headers.append("X-AnchorMailbox",n),e.method="GET",[4,fetch(window.location.origin+v+S(),e)];case 2:return(i=r.sent())&&200==i.status?[2,i]:(b.d.error("makeInitRequest: Unsuccessful response status"),[2,null]);case 3:return c=a.b,l=[v+S(),void 0,!0],[4,y()];case 4:return[2,c.apply(void 0,l.concat([r.sent(),void 0,!1])).then(function(e){return e.json()}).catch(function(e){return b.d.error(e),null})]}})})}function I(e,t,n){return r.__awaiter(this,void 0,void 0,function(){var i,c;return r.__generator(this,function(r){return i=Object(u.e)("rp-linkedInPeopleSuggestions")&&o(),c={Query:{QueryString:e},EntityType:"People",Provenances:k(t,i),Size:t?O:g},n&&n.length>0&&(c.Context=function(e){var t={};e&&(t.RecipientsTo=e.toString());return t}(n)),c.Fields=l.a,[2,c]})})}function k(e,t){var n=["Mailbox"];return e&&n.push("Directory"),t&&n.push("LinkedIn"),n}function S(){var e={scenario:j};return Object.keys(e).map(function(t){return t+"="+e[t]}).join("&")}function y(e){return r.__awaiter(this,void 0,void 0,function(){var t,n;return r.__generator(this,function(r){switch(r.label){case 0:return t={},e&&(t["client-session-id"]=e),Object(u.e)("rp-linkedInPeopleSuggestions")&&o()?Object(d.a)()?(t["X-User-Context"]="litoken=bearer",[3,3]):[3,1]:[3,3];case 1:return[4,Object(f.getAccessTokenforResource)(h)];case 2:n=r.sent(),t["X-User-Context"]="litoken="+n,r.label=3;case 3:return[2,t]}})})}}},0,[514,105,24,116]]);
//# sourceMappingURL=owa.SubstrateSuggestions.js.map
self.scriptsLoaded['owa.SubstrateSuggestions.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.SubstrateSuggestions.js'] = (new Date()).getTime();