self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.650.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[650],{10228:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i,o=n(13363),a=n(13357);!function(e){e[e.Aad=1]="Aad",e[e.Msa=2]="Msa"}(r=t.AuthType||(t.AuthType={})),function(e){e[e.Update=1]="Update",e[e.HostSignOut=2]="HostSignOut",e[e.AbtSignOut=3]="AbtSignOut"}(t.Actions||(t.Actions={})),function(e){e[e.WorldWide=1]="WorldWide",e[e.Trailblazer=4]="Trailblazer",e[e.Pathfinder=5]="Pathfinder"}(i=t.Environment||(t.Environment={})),function(e){e[e.InvalidConfigurations=100]="InvalidConfigurations",e[e.InvalidDataReceivedFromAbtSvc=105]="InvalidDataReceivedFromAbtSvc",e[e.LocalRecordNotFound=110]="LocalRecordNotFound",e[e.SharedRecordNotFound=115]="SharedRecordNotFound",e[e.UnknownError=120]="UnknownError"}(t.ResultCode||(t.ResultCode={}));var s=function(){function e(){}return e.abtSvc="/abt/userstate",e.abtSignOut="/odc/abt/signout",e}(),u=function(){function e(){}return e.http="http",e.https="https",e}(),l=function(){function e(){}return e.get="GET",e.post="POST",e}(),d=function(){function e(){}return e.separator="://",e}(),c=function(){function e(){}return e.abtWorldWideSvc="identity.osi.office.net",e.abtTrailblazer="identity.osi.office365.us",e.abtPathfinderSvc="identity.osi.apps.mil",e.abtSignout="odc.officeapps.live.com",e}(),f=function(){function e(){}return e.retrieve="RETRIEVE",e.update="UPDATE",e.signIn="SIGNIN",e.signOut="SIGNOUT",e.shouldPrompt="SHOULD_PROMPT",e.shouldSignOut="SHOULD_SIGNOUT",e}(),v=function(){function e(){}return e.maxAttempts=3,e.timeToSleepInMsecs=100,e}(),g=function(){function e(){}return e.inFlight="AbtInFlight",e.abtActivity="AbtActivity",e.localAvailable="AbtLocalAvailable",e.enableConsoleLogging="AbtEnableConsoleLogging",e}(),p=(function(){function e(){}e.inFlight="1"}(),function(){function e(){}return e.minPromptWindow=1,e.maxPromptWindow=10,e.percentageTimeout=10,e}()),m=function(){function e(){}return e.promptInterval=6e4,e.signoutInterval=6e4,e}(),h=function(){function e(){}return e.message="message",e.registerActivity="registerUserActivityEvent",e.signIn="registerUserSignInEvent",e.signOut="registerUserSignOutEvent",e.hostSignOut="abtSignOutEventForHost",e.initializeResult="abtInitializeResult",e.promptShown="abtPromptShown",e}(),y=function(){function e(){}return e.detail="detail",e.eventId="eventId",e.signoutPageUrl="signoutPageUrl",e.timeout="timeout",e.userId="userId",e.initializeResult="initializeResult",e.initializeMessage="initializeMessage",e}(),S=function(){function e(){}return e.userId="userid",e.market="rs",e.action="action",e.workload="workload",e.app="app",e.build="build",e.signInUrl="signInUrl",e}(),b=function(){function e(){}return e.info="Info",e.warning="Warning",e.error="Error",e}(),T=function(){function e(){}return e.defaultLoggingNamespace="Office.WebAuth.Abt.",e.messageDataField="message",e.levelDataField="level",e.correlationIdDataField="correlationId",e.actionDataField="action",e}();function w(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})}function I(e){return r[e]==r[r.Aad]?"OrgIdPuid":r[e]==r[r.Msa]?"MsaPuid":void 0}function A(e){return r[e]==r[r.Aad]?"Enterprise":r[e]==r[r.Msa]?"Consumer":void 0}function E(e,n,r,s,u,l){if(!R[i[l]].isAriaEnabled)return!1;t.telemetryLogger.setTenantTokens({Office:{WebAuth:{ariaTenantToken:"bfd38fb74e1b467495106a7dd7b35f27-1110120f-6282-4b11-8fe0-299b50c9309d-7071",nexusTenantToken:-1,Abt:{}}}});var d=new o.AriaSink([a.makeStringDataField("User.PrimaryIdentityHash",e),a.makeStringDataField("User.PrimaryIdentitySpace",I(n)),a.makeStringDataField("User.TenantGroup",A(n)),a.makeStringDataField("Data.Workload",r),a.makeStringDataField("Data.SessionId",s),a.makeStringDataField("Data.TenantId",u)]);return d.setFullEventsEnabled(!0),t.telemetryLogger.addSink(d),!0}t.GetRandomGuid=w,t.telemetryLogger=new a.TelemetryLogger,t.GetIdentitySpace=I,t.GetTenantGroup=A,t.InitializeLogging=E;var N=function(){function e(e){this.market=e.market,this.workloadName=e.workloadName,this.environment=e.environment,this.userId=e.userId,this.authType=e.authType,this.timeout=Math.floor(e.timeout/60),this.trackEvents=null==e.trackEvents||void 0===e.trackEvents||e.trackEvents,this.enableLogging=null==e.enableLogging||void 0===e.enableLogging||e.enableLogging,this.sessionId=null==e.sessionId||void 0===e.sessionId?"":e.sessionId,this.tenantId=null==e.tenantId||void 0===e.tenantId?"":e.tenantId,this.signinState=e.signinState}return e.prototype.checkTokenValues=function(){var e,t="AbtCheckTokenValues";try{var n=this.signinState;if(Array.isArray(this.signinState)&&n.length>0&&"string"!=typeof n[0])return e="ABT did not receive 'signinState' information in expected format",k.error(e,t),{isPassed:!1,errorMessage:e}}catch(n){return e="ABT did not receive 'signinState' information in expected format",k.error(e,t),{isPassed:!1,errorMessage:e}}if(null!=this.signinState&&void 0!==this.signinState&&n.length>0)for(var r=0,i=n;r<i.length;r++){var o=i[r];if("kmsi"==o)return{isPassed:!1,errorMessage:"User has opted for 'keep-me-signed-in'"};if("dvc_cmp"==o||"dvc_dmjd"==o)return{isPassed:!1,errorMessage:"Received managed device signal"}}return null==this.timeout||void 0===this.timeout||this.timeout<5||this.timeout>1440?(e="timeout is a required parameter. It cannot be null, undefined or either less than 5 minutes (300 seconds) or more than 24 hours (86400 seconds or 1440 minutes).",k.error(e,t),{isPassed:!1,errorMessage:e}):(k.log("Validation of token values finished successfully.",t),{isPassed:!0,errorMessage:null})},e.prototype.isValid=function(){var e,t="AbtInitOptionsIsValid";return null!=this.sessionId&&void 0!==this.sessionId&&""!==this.sessionId||(e="Null, undefined or empty SessionId.",k.warn(e,t)),null!=this.tenantId&&void 0!==this.tenantId&&""!==this.tenantId||(e="Null, undefined or empty TenantId.",k.warn(e,t)),null==this.market||void 0===this.market||""===this.market?(e="market is a required parameter. It cannot be null, undefined or empty.",k.error(e,t),{isPassed:!1,errorMessage:e}):null==this.workloadName||void 0===this.workloadName||""===this.workloadName?(e="workloadName is a required parameter. It cannot be null, undefined or empty.",k.error(e,t),{isPassed:!1,errorMessage:e}):null==this.environment||void 0===this.environment?(e="environment is a required parameter. It cannot be null or undefined.",k.error(e,t),{isPassed:!1,errorMessage:e}):C(this.environment)?null==this.userId||void 0===this.userId||""===this.userId?(e="userId is a required parameter. It cannot be null, undefined or empty.",k.error(e,t),{isPassed:!1,errorMessage:e}):null==this.authType||void 0===this.authType?(e="authType is a required parameter. It cannot be null or undefined.",k.error(e,t),{isPassed:!1,errorMessage:e}):F(this.authType)?(k.log("Validation of base configuration options finished successfully.",t),{isPassed:!0,errorMessage:null}):(e="authType doesn't have allowed values from AuthType. Current value: "+this.authType,k.error(e,t),{isPassed:!1,errorMessage:e}):(e="environment doesn't have allowed values from Environment. Current value: "+this.environment,k.error(e,t),{isPassed:!1,errorMessage:e})},e}();t.AbtInitOptions=N;var k,D=function(){return function(e){this.result=e.result,this.ui=e.ui,this.error=e.error,this.diagnostics=e.diagnostics,this.userId=e.userId,this.timeout=e.timeout,this.timeSinceActivity=e.timeSinceActivity}}();function C(e){return i[e]===i[i.Pathfinder]||i[e]===i[i.Trailblazer]||i[e]===i[i.WorldWide]}function F(e){return r[e]===r[r.Aad]||r[e]===r[r.Msa]}t.AbtResponse=D,function(e){function n(){return t.gIsAbtLoggingInitialized}function r(e,t){return!t&&!!M(g.enableConsoleLogging,"true",e)}function i(e,n,i,o){return null==e||void 0===e||""===e?(r(i,o),!1):null==n||void 0===n||""===n?(r(i,o),!1):void 0!==t.gAbtEnableLogging&&!1!==t.gAbtEnableLogging}function o(e,n,r,i){null==r||void 0===r||r!==b.info&&r!==b.warning&&r!==b.error||t.telemetryLogger.sendTelemetryEvent({eventName:T.defaultLoggingNamespace+n,dataFields:[a.makeStringDataField(T.messageDataField,e),a.makeStringDataField(T.levelDataField,r),a.makeStringDataField(T.correlationIdDataField,w()),a.makeStringDataField(T.actionDataField,null!==i||void 0!==i||""!==i?i:"Empty")]})}e.log=function(e,t,a,s,u){void 0===a&&(a=!1),void 0===s&&(s=!1),void 0===u&&(u=""),i(e,t,a,s)&&(n()&&!a&&o(e,t,b.info,u),r(a,s))},e.warn=function(e,t,a,s){void 0===a&&(a=!1),void 0===s&&(s=!1),i(e,t,a,s)&&(n()&&!a&&o(e,t,b.warning,null),r(a,s))},e.error=function(e,t,a,s,u){void 0===a&&(a=!1),void 0===s&&(s=!1),void 0===u&&(u=""),i(e,t,a,s)&&(n()&&!a&&o(e,t,b.error,u),r(a,s))}}(k=t.LoggingUtils||(t.LoggingUtils={})),t.timer=function(){var e=(new Date).getTime();return{get seconds(){return Math.ceil(((new Date).getTime()-e)/1e3)},get ms(){return(new Date).getTime()-e},get formattedSeconds(){return Math.ceil(this.seconds()/1e3)+"s"},get formattedMs(){return this.ms()+"ms"}}},t.isValidEnvironment=C,t.isValidAuthType=F;var P=function(){return function(e,t,n){this.abtSvcHost=e,this.isAriaEnabled=t,this.enabled=n}}(),R={};R[i[i.WorldWide]]=new P(c.abtWorldWideSvc,!0,!0),R[i[i.Pathfinder]]=new P(c.abtPathfinderSvc,!1,!0),R[i[i.Trailblazer]]=new P(c.abtTrailblazer,!1,!0);var x=function(){function e(e){this.userId=e.userId,this.timeout=e.timeout}return e.prototype.isValid=function(){var e,t="RegisterEventDataIsValid";return null==this.userId||void 0===this.userId||""===this.userId?(e="userId is a required parameter. It cannot be null, undefined or empty.",k.error(e,t),{isPassed:!1,errorMessage:e}):null==this.timeout||void 0===this.timeout||this.timeout<=0?(e="timeout is a required parameter. It cannot be null, undefined or empty.",k.error(e,t),{isPassed:!1,errorMessage:e}):(k.log("Validation of configurations options finished successfully.",t),{isPassed:!0,errorMessage:null})},e}();function O(e){void 0===e&&(e=!1);try{return localStorage.setItem(g.localAvailable,g.localAvailable),localStorage.removeItem(g.localAvailable),!0}catch(t){return k.error("Local storage not available. Details:  "+t,"IsLocalStorageAvailable",e,!0),!1}}function L(e){var t="GetStorageItemValue";if(null==e)return k.error("name param should not be null or undefined.",t),null;if(!O())return k.error("Local storage is not available. Returning null.",t),null;k.log("Looking for "+e+" storage item.",t,!0);var n=localStorage.getItem(e);return null===n?(k.warn("Didn't find '"+e+"' item in the storage.",t),null):n}function _(e,t){var n="FindStorageItemWithValue";if(null==e)return k.error("name param should not be null or undefined.",n),!1;if(null==t)return k.error("value param should not be null or undefined.",n),!1;if(!O())return k.error("Local storage is not available. Returning false.",n),!1;var r=L(e);return null===r?(k.warn("Didn't find value associated with '"+e+" storage item.",n),!1):r===t||(k.error("Value associated with "+e+" is different than needed.",n),!1)}function M(e,t,n){var r="FindLocalStorageItemWithValue";if(null==e)return k.error("name param should not be null or undefined.",r,n,!0),!1;if(null==t)return k.error("value param should not be null or undefined.",r,n,!0),!1;if(!O(n))return k.error("Local storage is not available. Returning false.",r,n,!0),!1;var i=function(e,t){var n="GetLocalStorageItemValue";if(null==e)return k.error("name param should not be null or undefined.",n,t,!0),null;if(!O(t))return k.error("Local storage is not available. Returning null.",n,t,!0),null;k.log("Looking for "+e+" storage item.",n,t,!0);var r=localStorage.getItem(e);return null===r?(k.warn("Didn't find '"+e+"' item in the storage.",n,t,!0),null):r}(e,n);return null===i?(k.warn("Didn't find value associated with '"+e+"' storage item in local storage.",r,n,!0),!1):i===t||(k.error("Value associated with '"+e+"' is different than needed.",r,n,!0),!1)}function U(e,t){var n="CreateStorageItem";return null==e?(k.error("name param should not be null or undefined.",n),!1):null==t?(k.error("value param should not be null or undefined.",n),!1):O()?(k.log("Creating "+e+" in local storage.",n,!0),localStorage.setItem(e,t),!0):(k.error("Local storage is not available. Returning false.",n),!1)}function W(e){return null==e?(k.error("name param should not be null or undefined.","DeleteStorageItem"),!1):O()?(k.log("Deleting "+e+" from local storage.","DeleteStorageItem",!0),localStorage.removeItem(e),!0):(k.error("Local storage is not available. Returning false.","DeleteStorageItem"),!1)}function V(e){return k.log("Sleeping for "+e,"Sleep",!0),e<0?(k.error("Time to sleep cannot be less than zero. Returning immediately without sleeping.","Sleep"),new Promise(function(e){return setTimeout(e,0)})):new Promise(function(t){return setTimeout(t,e)})}function z(e){var t,n="ConvertActivityStorageItemData";if(null==e||void 0===e||""===e)return k.log("Empty/null/undefined activity data. Returning null.",n,!0),null;try{t=JSON.parse(e)}catch(e){return k.error("Exception occurred while parsing activities data in local stored item. Returning null. Exception details: "+e.message+".",n),null}return void 0===t?(k.error("Couldn't parse provided activities data. Returning null.",n),null):t}function B(){for(var e=1;e<=v.maxAttempts;e++){if(!_(g.inFlight,"1"))return!1;var t="AbtInFlight item is present. Attempt#."+e;if(k.log(t,"AnyInFlightRequest",!0),e===v.maxAttempts)return!0;t="Sleeping for "+v.timeToSleepInMsecs+" ms.",k.log(t,"AnyInFlightRequest",!0),V(v.timeToSleepInMsecs)}return!0}function J(){W(g.inFlight)||k.error("Failed to delete in-flight item.","DeleteInFlightItem",!0)}function q(){t.gIsAbtInitialized?G(t.gAbtUserId,t.gAbtTimeout,f.update):k.warn("Received update activity event even when ABT is not initialized.","RegisterUserActivity")}function H(){t.gIsAbtInitialized?G(t.gAbtUserId,t.gAbtTimeout,f.signIn):k.warn("Received sign in event even when ABT is not initialized.","RegisterUserSignIn")}function G(e,t,n){var r="ProcessRegisterActivity";B(),k.log("Writing in-flight item.",r,!0),U(g.inFlight,"1")&&k.log("Successfully written in-Flight item.",r,!0);var i=(new Date).toUTCString(),o=z(L(g.abtActivity)),a={records:new Array},s={userId:e,timeout:t,activityDateTime:i,broadcastedActivityDateTime:i},u=!1,l=!0;if(null==o||null==o.records||void 0===o.records||o.records.length<=0)k.log("Didn't get data from local activities item.",r,!0),a.records.push(s),u=!0;else for(var d=0,c=o.records;d<c.length;d++){var f=c[d];null!==f.userId&&void 0!==f.userId&&f.userId===e?(j(t,f.broadcastedActivityDateTime)||(l=!1,s.broadcastedActivityDateTime=f.broadcastedActivityDateTime),a.records.push(s),u=!0):a.records.push(f)}u||a.records.push(s),U(g.abtActivity,JSON.stringify(a))||k.error("Failed to create item for activities.",r),l&&ne(e,0,t,n,J),re(e)}function j(e,t){var n="shouldSendActivityToServer";if(null==t||""===t)return k.error("Sending activity to server. Either previous activity DateTime was 'null, undefined or empty' or Timeout value was: '"+e+"' which wasn't valid.",n,!0),!0;var r=X(t,e/2);return null==r?(k.error("Not Sending activity to server. DateTime to log event to server was 'null or undefined', previous activity DateTime was '"+t+"'. Timeout value was: '"+e+"'.",n,!0),!0):r.getTime()<=(new Date).getTime()?(k.log("Sending activity to server. DateTime to log event to server was '"+r.toUTCString()+"', previous activity DateTime was '"+t+"' and Current time is '"+(new Date).toUTCString()+"'. Timeout value was: '"+e+"'.",n,!0),!0):(k.log("No need to send activity to server. DateTime to log event to server was '"+r.toUTCString()+", previous activity DateTime was '"+t+"' and Current time is '"+(new Date).toUTCString()+"'. Timeout value was: '"+e+"'.",n,!0),!1)}function Z(){var e="RegisterUserSignOut";if(t.gIsAbtInitialized){B(),k.log("Writing in-flight item.",e,!0),U(g.inFlight,"1")&&k.log("Successfully written in-Flight item.",e,!0);var n=z(L(g.abtActivity)),r={records:new Array};if(null==n||null==n.records||void 0===n.records||n.records.length<=0)k.log("Didn't get data from local activities item.",e,!0),W(g.abtActivity)||k.error("Failed to delete in-flight item.",e);else for(var i=0,o=n.records;i<o.length;i++){var a=o[i];null!==a.userId&&void 0!==a.userId&&a.userId!==t.gAbtUserId&&r.records.push(a)}r.records.length>0?U(g.abtActivity,JSON.stringify(r))||k.error("Failed to create item for activities.",e):W(g.abtActivity)||k.error("Failed to create item for activities.",e),ne(t.gAbtUserId,0,t.gAbtTimeout,f.signOut,J)}else k.warn("Received sign out event even when ABT is not initialized.",e)}function $(e){var t=e*(p.percentageTimeout/100);return t>p.minPromptWindow&&t<p.maxPromptWindow?t:t<=p.minPromptWindow?p.minPromptWindow:(p.maxPromptWindow,p.maxPromptWindow)}function X(e,t){if(null==e)return k.error("date param cannot be null, undefined or empty.","AddMinutes"),null;var n=new Date(e);return"Invalid Date"===n.toString()?(k.error("date param doesn't have valid date value - '"+n.toString()+"'","AddMinutes"),null):(n.setTime(n.getTime()+6e4*t),n)}function Y(e,t){if(null==e)return k.error("date param cannot be null, undefined or empty.","AddSeconds"),null;var n=new Date(e);return"Invalid Date"===n.toString()?(k.error("date param doesn't have valid date value - '"+n.toString()+"'","AddSeconds"),null):(n.setTime(n.getTime()+1e3*t),n)}function K(){return u.https+d.separator+R[i[t.gAbtEnvironment]].abtSvcHost+s.abtSvc}function Q(e){var t,n="ConvertAbtSvcResponse";if(null==e||void 0===e||""===e)return k.error("Empty/null/undefined webResponse. Returning null.",n),null;try{t=JSON.parse(e)}catch(e){return k.error("Exception occurred while parsing web response of ABT service. Returning null. Exception details: "+e.message+".",n),null}return void 0===t?(k.error("Couldn't parse web response from ABT service data. Returning null.",n),null):t}function ee(e){null!=e&&null!==e.diagnostics&&void 0!==e.diagnostics?k.log(JSON.stringify(e.diagnostics),"LogRequestDiagnostics",!0):k.error("Received null/undefined response or diagnostics object.","LogRequestDiagnostics")}function te(e,n,r){var i="SendAbtGetRequest";if(null!=e&&""!==e)if(null!=n&&""!==n){k.log("Sending a GET request for '"+n+"' action.","AbtGetRequest",!1,!1,n);var o=new XMLHttpRequest;o.open(l.get,function(e,t,n,r){var i="GetAbtUriForGetRequest";if(null==e||""===e)return k.error("userId param cannot be null, undefined or empty.",i),null;if(null==t||""===t)return k.error("market param cannot be null, undefined or empty.",i),null;if(null==n||""===n)return k.error("action param cannot be null, undefined or empty.",i),null;if(null==r||""===r)return k.error("workload param cannot be null, undefined or empty.",i),null;var o=K(),a=S.userId+"="+e+"&"+S.market+"="+t+"&"+S.action+"="+n+"&"+S.workload+"="+r;return o.concat("?",a)}(e,t.gAbtMarket,n,t.gAbtWorkloadName)),o.withCredentials=!0,o.onload=function(){var t=Q(o.responseText);ee(t),200===o.status?null!=t.error||null!=t.error?k.error("Received an error from ABT service. Error code: '"+t.error.errorCode+"'. Error message: \n\t\t\t\t\t'"+t.error.message+". Status code: "+o.status+".'",i,!1,!1,n):k.log("Get request for user '"+e+"' succeeded. Status code: "+o.status,i,!1,!1,n):500===o.status?k.error("Received an error from ABT service. Status code: "+o.status+"'. Response details: "+o.responseText,i,!1,!1,n):k.error("Received an error from ABT service. Error code: '"+t.error.errorCode+"'. Error message: '"+t.error.message+". Status code: "+o.status+"'",i,!1,!1,n),r(t)},o.send()}else k.error("action param cannot be null, undefined or empty.",i);else k.error("userId param cannot be null, undefined or empty.",i)}function ne(e,n,r,i,o){var a="SendAbtPostRequest";if(null!=e&&""!==e)if(null==n||n<0)k.error("pTimeSinceActivity param cannot be null, undefined or negative.",a);else if(null!=i&&""!==i)if(i!=f.signOut&&null===r||void 0===r||r<=0)k.error("pTimeout param cannot be null, undefined, zero or negative.",a);else{k.log("Sending a POST request for '"+i+"' action.","AbtPostRequest",!1,!1,i);var s={userId:e,timeSinceActivity:n,timeout:r,action:i,workload:t.gAbtWorkloadName},u=new XMLHttpRequest;u.open(l.post,K()),u.withCredentials=!0,u.onload=function(){ee(Q(u.responseText)),200===u.status?k.log("Post request for user "+e+" succeeded. Status code: "+u.status+" Response text: "+u.responseText,a,!1,!1,i):500===u.status?k.error("Received an error from ABT service. Status code: "+u.status+"'. Response details: "+u.responseText,a,!1,!1,i):k.error("Received an error from ABT service. Status code: "+u.status+"' Response text: "+u.responseText,a,!1,!1,i),o()},u.send(JSON.stringify(s))}else k.error("pAction param cannot be null, undefined or empty.",a);else k.error("pUserId param cannot be null, undefined or empty.",a)}function re(e){!0!==t.gAbtStartedPromptChecks&&(ie(),ae(),t.gAbtStartedPromptChecks=!0,t.gAbtPromptTimer=setInterval(ue,m.promptInterval,e))}function ie(){t.gAbtStartedPromptChecks=!1,clearInterval(t.gAbtPromptTimer)}function oe(e){!0!==t.gAbtStartedSignoutChecks&&(ie(),ae(),t.gAbtStartedSignoutChecks=!0,t.gAbtSignoutTimer=setInterval(ve,m.signoutInterval,e))}function ae(){t.gAbtStartedSignoutChecks=!1,clearInterval(t.gAbtSignoutTimer)}function se(e){if(null!=e)if(null===e.error||void 0===e.error)if(ie(),e.result||(k.log("Not showing prompt based on server data.","ShowPrompt"),de(e.userId,-e.timeSinceActivity),re(e.userId)),e.respectResult){if(e.result){var n={title:e.ui.title,description:e.ui.description,question:e.ui.question,buttonSignOut:e.ui.signOutButton,buttonStaySignIn:e.ui.keepMeActiveButton,divName:e.ui.divName,userId:e.userId,timeout:e.timeout},r='{ "'+y.eventId+'": "'+h.promptShown+'", "'+y.userId+'": "'+e.userId+'" }',i=JSON.parse(r);if(window.postMessage(JSON.stringify(i),window.location.origin),null!=window.AbtUI)window.AbtUI.AbtRenderPrompt(n);else{if(null==window.LoadAbtPromptJs)return void k.error("Can't find the declaration of the prompt. Not showing prompt.","NoPromptDeclaration");var o=t.telemetryLogger.createNewActivity(T.defaultLoggingNamespace+"LoadAbtPromptJs");window.LoadAbtPromptJs.Download(function(){return window.AbtUI.AbtRenderPrompt(n)}),o.addDataFields([a.makeStringDataField(T.messageDataField,"ABT prompt JS has been downloaded."),a.makeStringDataField(T.levelDataField,b.info),a.makeStringDataField(T.correlationIdDataField,w())]),o.setSuccess(!0),o.endNow()}oe(n.userId),k.log("Successfully shown prompt.","PromptDisplayed",!0)}}else k.log("RespectResult is set to 'false'. Not showing prompt. The result was:'"+e.result+"'","ShowPrompt");else k.error("Error found in the ABT service response. ErrorCode: '"+e.error.errorCode+"'. Not showing prompt.","ShowPrompt");else k.warn("WebResponse provided was null or undefined. Not showing prompt.","ShowPrompt")}function ue(e){var t="CheckForPrompt",n=z(L(g.abtActivity)),r=!1;if(null==n||null==n.records||void 0===n.records||n.records.length<=0)k.log("Didn't get data from local activities item. No need to prompt for '"+e+"'.",t,!0);else{for(var i=0,o=n.records;i<o.length;i++){var a=o[i];if(null!==a.userId&&void 0!==a.userId&&a.userId===e){var s=X(a.activityDateTime,a.timeout-$(a.timeout));if(null==s)return;if(s.getTime()<(new Date).getTime()){k.log("Based on local data, we might need to show prompt for '"+e+"'. We will reach out to server to confirm that. DateTime to show prompt was '"+s.toUTCString()+"' and Current time is '"+(new Date).toUTCString()+"'. Timeout value was: '"+a.timeout+"'.",t,!0),r=!0;break}return void k.log("No need to prompt for '"+e+"'. DateTime to show prompt was '"+s.toUTCString()+"' and Current time is '"+(new Date).toUTCString()+"'. Timeout value was: '"+a.timeout+"'.",t,!0)}}r?te(e,f.shouldPrompt,se):k.error("No record for '"+e+"'. Not showing prompt.",t)}}function le(e,t){var n=z(L(g.abtActivity));if(null==n||null==n.records||void 0===n.records||n.records.length<=0)return k.log("Didn't get data from local activities item for '"+e+"'.","IsActivityRecent",!0),!1;for(var r=0,i=n.records;r<i.length;r++){var o=i[r];if(null!==o.userId&&void 0!==o.userId&&o.userId===e)return t<=60*$(o.timeout)*2}return!1}function de(e,t){if(!(null==e||""===e||null==t||t<=0)){var n=z(L(g.abtActivity)),r={records:new Array},i=!1;if(null==n||null==n.records||void 0===n.records||n.records.length<=0)k.error("Didn't get any user data from local activities item while looking for '"+e+"' which was unexpected.","NoRecordForExtension");else{for(var o=0,a=n.records;o<a.length;o++){var s=a[o];if(null!==s.userId&&void 0!==s.userId&&s.userId===e){var u=Y((new Date).toUTCString(),t);if(null==u)return;var l={userId:s.userId,timeout:s.timeout,activityDateTime:u.toUTCString(),broadcastedActivityDateTime:s.broadcastedActivityDateTime};r.records.push(l),i=!0}else r.records.push(s)}i&&(U(g.abtActivity,JSON.stringify(r))||k.error("Failed to create item for activities.","FailedToCreateLocalRecord"))}}}function ce(e,n){ne(e,0,n,f.signOut,J);var r,i,o='{ "'+y.eventId+'": "'+h.hostSignOut+'", "'+y.detail+'": { "'+y.userId+'": "'+e+'", "'+y.signoutPageUrl+'": "'+(r=S.market+"="+t.gAbtMarket+"&"+S.app+"={0}&"+S.build+"={1}&"+S.signInUrl+"={2}",(u.https+d.separator+c.abtSignout+s.abtSignOut).concat("?",r))+'"} }';i=JSON.parse(o),window.postMessage(JSON.stringify(i),window.location.origin)}function fe(e){var t="PerformSignout";null!=e?null===e.error||void 0===e.error?(e.result||(le(e.userId,e.timeSinceActivity)?(k.log("Activity reported on server. Updating local records.",t),de(e.userId,-e.timeSinceActivity),re(e.userId),null!=window.AbtUI&&window.AbtUI.AbtHidePrompt()):k.log("Not signing out user based on server data. Activity is not recent either.",t)),e.respectResult?e.result&&(k.log("Signing out user.","BroadcastSignout"),ae(),ce(e.userId,e.timeout)):k.log("RespectResult is set to 'false'. Not signing out. The result of sign out from server was '"+e.result+".'",t)):k.error("Error found in the ABT service response. ErrorCode: '"+e.error.errorCode+"'. Not signing out.",t):k.warn("WebResponse provided was null or undefined. Not signing out.",t)}function ve(e){ge&&te(e,f.shouldSignOut,fe)}function ge(e){var t="ShouldSignOutLocal",n=z(L(g.abtActivity));if(null==n||null==n.records||void 0===n.records||n.records.length<=0)return k.log("Didn't get data from local activities item. No need to sign out the user: '"+e+"'.",t,!0),!1;for(var r=0,i=n.records;r<i.length;r++){var o=i[r];if(null!==o.userId&&void 0!==o.userId&&o.userId===e){var a=X(o.activityDateTime,o.timeout);return null!=a&&(a.getTime()<(new Date).getTime()?(k.log("Based on local data, we might need to sign out '"+e+"'. We will call server before making that final. DateTime to sign out was '"+a.toUTCString()+" and Current time is '"+(new Date).toUTCString()+"'. Timeout value was: '"+o.timeout+"'.",t,!0),!0):(k.log("No need to sign out '"+e+"'. DateTime to sign out was '"+a.toUTCString()+" and Current time is '"+(new Date).toUTCString()+"'. Timeout value was: '"+o.timeout+"'.",t,!0),!1))}}return!1}function pe(){t.gAbtTrackEvents&&(k.log("Registering scroll event.","RegisterScroll",!0),q())}function me(){t.gAbtTrackEvents&&(k.log("Registering mouse down event.","RegisterMouseDown",!0),q())}function he(){t.gAbtTrackEvents&&(k.log("Registering key down event.","RegisterKeyDown",!0),q())}function ye(e){var t,n=Se(e),r=n.boolean,i=n.string,o=null==e?"":e.userId,a='{ "'+y.eventId+'": "'+h.initializeResult+'", "'+y.detail+'": { "'+y.userId+'": "'+o+'", "'+y.initializeResult+'": "'+r+'", "'+y.initializeMessage+'": "'+i+'"} }';return t=JSON.parse(a),window.postMessage(JSON.stringify(t),window.location.origin),r}function Se(e){var n,r,i="InitializeAbt";t.gAbtEnableLogging=!0;var o=!0,a=!0;if(null==e)return r="configurations cannot be null or undefined.",k.error(r,i),{boolean:!1,string:r};var s=new N(e);k.log("ABT - Reading token values",i);var u=s.checkTokenValues();u.isPassed||(a=!1,n=u.errorMessage,k.log("Check for timeout value and signin state did not pass.",i)),k.log("Started ABT initialization",i);var l=s.isValid();return l.isPassed||(o=!1,r=l.errorMessage,k.error(r,i),k.error("Completed ABT initialization with an error.",i)),t.gAbtMarket=s.market,t.gAbtWorkloadName=s.workloadName,t.gAbtEnvironment=s.environment,t.gAbtUserId=s.userId,t.gAbtTimeout=s.timeout,t.gAbtTrackEvents=s.trackEvents,t.gAbtEnableLogging=s.enableLogging,t.gIsAbtInitialized=o&&a,t.gIsAbtLoggingInitialized=E(s.userId,s.authType,s.workloadName,s.sessionId,s.tenantId,s.environment),a?o?(k.log("Successfully completed ABT initialization.",i),H(),t.gAbtTrackEvents&&(window.addEventListener("scroll",pe),window.addEventListener("mousedown",me),window.addEventListener("keydown",he)),{boolean:!0,string:""}):(k.error(r,i),{boolean:!1,string:r}):(k.log(n,i),{boolean:!1,string:n})}t.RegisterEventData=x,t.registerUserActivity=q,t.registerUserSignIn=H,t.shouldSendActivityToServer=j,t.registerUserSignOut=Z,t.startPromptChecks=re,t.stopPromptChecks=ie,t.startSignoutChecks=oe,t.stopSignoutChecks=ae,t.showPrompt=se,t.checkForPrompt=ue,t.isActivityRecent=le,t.extendLocalRecord=de,t.broadcastSignout=ce,t.shouldSignOutLocal=ge,t.initializeAbt=ye,t.initializeAbtInternal=Se,window.AbtInteraction={AbtRegisterActivity:q,AbtRegisterSignIn:H,AbtRegisterSignOut:Z,AbtInitialize:ye,AbtBroadcastSignout:ce,AbtShouldSignOutLocal:ge},window.AbtAuthType={Aad:r.Aad,Msa:r.Msa},window.AbtEnvironment={WorldWide:i.WorldWide,Trailblazer:i.Trailblazer,Pathfinder:i.Pathfinder}},13357:function(e,t,n){"use strict";n.r(t);var r,i,o,a,s,u,l,d,c=n(6088);function f(e,t){return{name:e,dataType:c.a.Boolean,value:t}}function v(e,t){return r.validateInt(t),{name:e,dataType:c.a.Int64,value:t}}function g(e,t){return{name:e,dataType:c.a.Double,value:t}}function p(e,t){return{name:e,dataType:c.a.String,value:t}}function m(e,t,n){var r=n.map(function(t){return{name:e+"."+t.name,value:t.value,dataType:t.dataType}});return h(r,e,t),r}function h(e,t,n){e.push(p("zC."+t,n))}!function(e){var t=-9007199254740991,n=9007199254740991,r=/^[A-Z][a-zA-Z0-9]*$/,i=/^[a-zA-Z0-9_\.]*$/;function o(e){return void 0!==e&&i.test(e)}function a(e){if(!((t=e.name)&&o(t)&&t.length+5<100))throw new Error("Invalid dataField name");var t;e.dataType===c.a.Int64&&s(e.value)}function s(e){if("number"!=typeof e||!isFinite(e)||Math.floor(e)!==e||e<t||e>n)throw{message:"Invalid integer "+JSON.stringify(e)}}e.validateTelemetryEvent=function(e){if(!function(e){if(!e||e.length>98)return!1;var t,n=e.split("."),i=n[n.length-1];return function(e){return!!e&&e.length>=3&&"Office"===e[0]}(n)&&(void 0!==(t=i)&&r.test(t))}(e.eventName))throw new Error("Invalid eventName");if(e.eventContract&&!o(e.eventContract.name))throw new Error("Invalid eventContract");if(null!=e.dataFields)for(var t=0;t<e.dataFields.length;t++)a(e.dataFields[t])},e.validateInt=s}(r||(r={})),function(e){var t="Office.System.Result";e.getFields=function(e,n){var r=[];return r.push(v(e+".Code",n.code)),void 0!==n.type&&r.push(p(e+".Type",n.type)),void 0!==n.tag&&r.push(v(e+".Tag",n.tag)),h(r,e,t),r}}(i||(i={})),function(e){e.contractName="Office.System.Activity",e.getFields=function(t){var n=[];return void 0!==t.cV&&n.push(p("Activity.CV",t.cV)),n.push(v("Activity.Duration",t.duration)),n.push(v("Activity.Count",t.count)),n.push(v("Activity.AggMode",t.aggMode)),void 0!==t.success&&n.push(f("Activity.Success",t.success)),void 0!==t.result&&n.push.apply(n,i.getFields("Activity.Result",t.result)),h(n,"Activity",e.contractName),n}}(o||(o={})),function(e){var t="Office.System.Host";e.getFields=function(e,n){var r=[];return void 0!==n.id&&r.push(p(e+".Id",n.id)),void 0!==n.version&&r.push(p(e+".Version",n.version)),void 0!==n.sessionId&&r.push(p(e+".SessionId",n.sessionId)),h(r,e,t),r}}(a||(a={})),function(e){var t="Office.System.SDX";e.getFields=function(e,n){var r=[];return void 0!==n.id&&r.push(p(e+".Id",n.id)),void 0!==n.version&&r.push(p(e+".Version",n.version)),void 0!==n.instanceId&&r.push(p(e+".InstanceId",n.instanceId)),void 0!==n.name&&r.push(p(e+".Name",n.name)),void 0!==n.marketplaceType&&r.push(p(e+".MarketplaceType",n.marketplaceType)),void 0!==n.sessionId&&r.push(p(e+".SessionId",n.sessionId)),void 0!==n.browserToken&&r.push(p(e+".BrowserToken",n.browserToken)),void 0!==n.osfRuntimeVersion&&r.push(p(e+".OsfRuntimeVersion",n.osfRuntimeVersion)),void 0!==n.officeJsVersion&&r.push(p(e+".OfficeJsVersion",n.officeJsVersion)),void 0!==n.hostJsVersion&&r.push(p(e+".HostJsVersion",n.hostJsVersion)),void 0!==n.assetId&&r.push(p(e+".AssetId",n.assetId)),void 0!==n.providerName&&r.push(p(e+".ProviderName",n.providerName)),void 0!==n.type&&r.push(p(e+".Type",n.type)),void 0!==n.url&&r.push(p(e+".Url",n.url)),h(r,e,t),r}}(s||(s={})),function(e){var t="Office.System.Funnel";e.getFields=function(e,n){var r=[];return void 0!==n.name&&r.push(p(e+".Name",n.name)),void 0!==n.state&&r.push(p(e+".State",n.state)),h(r,e,t),r}}(u||(u={})),function(e){var t="Office.System.UserAction";e.getFields=function(e,n){var r=[];return void 0!==n.id&&r.push(v(e+".Id",n.id)),void 0!==n.name&&r.push(p(e+".Name",n.name)),void 0!==n.commandSurface&&r.push(p(e+".CommandSurface",n.commandSurface)),void 0!==n.parentName&&r.push(p(e+".ParentName",n.parentName)),void 0!==n.triggerMethod&&r.push(p(e+".TriggerMethod",n.triggerMethod)),void 0!==n.timeOffsetMs&&r.push(v(e+".TimeOffsetMs",n.timeOffsetMs)),h(r,e,t),r}}(l||(l={})),function(e){var t="Office.System.Error";e.getFields=function(e,n){var r=[];return r.push(p(e+".ErrorGroup",n.errorGroup)),r.push(v(e+".Tag",n.tag)),void 0!==n.code&&r.push(v(e+".Code",n.code)),void 0!==n.id&&r.push(v(e+".Id",n.id)),void 0!==n.count&&r.push(v(e+".Count",n.count)),h(r,e,t),r}}(d||(d={}));var y,S,b=o,T=i,w=d,I=u,A=a,E=s,N=l;!function(e){!function(e){!function(e){e.Activity=b,e.Result=T,e.Error=w,e.Funnel=I,e.Host=A,e.SDX=E,e.UserAction=N}(e.System||(e.System={}))}(e.Office||(e.Office={}))}(y||(y={})),function(e){var t,n=0;e.getNext=function(){return void 0===t&&(t=function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=[],n=0;n<22;n++)t.push(e.charAt(Math.floor(Math.random()*e.length)));return t.join("")}()),new r(t,++n)},e.getNextChild=function(e){return new r(e.getString(),++e.nextChild)};var r=function(){function e(e,t){this.base=e,this.id=t,this.nextChild=0}return e.prototype.getString=function(){return this.base+"."+this.id},e}();e.CV=r}(S||(S={}));var k,D,C=function(){function e(){this._listeners=[]}return e.prototype.fireEvent=function(e){this._listeners.forEach(function(t){return t(e)})},e.prototype.addListener=function(e){e&&this._listeners.push(e)},e.prototype.removeListener=function(e){this._listeners=this._listeners.filter(function(t){return t!==e})},e.prototype.getListenerCount=function(){return this._listeners.length},e}(),F=new C;function P(){return F}function R(e,t,n){F.fireEvent({level:e,category:t,message:n})}!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose"}(k||(k={})),function(e){e[e.Core=0]="Core",e[e.Sink=1]="Sink",e[e.Transport=2]="Transport"}(D||(D={}));var x=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,s)}u((r=r.apply(e,t||[])).next())})},O=function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},L=function(){return 1e3*Date.now()};"object"==typeof window.performance&&"now"in window.performance&&(L=function(){return 1e3*Math.floor(window.performance.now())});var _,M,U,W,V,z,B,J=function(){function e(e,t,n){this._optionalEventFlags={},this._ended=!1,this._telemetryLogger=e,this._activityName=t,this._cv=n?S.getNextChild(n._cv):S.getNext(),this._dataFields=[],this._success=void 0,this._startTime=L()}return e.createNew=function(t,n){return new e(t,n)},e.prototype.createChildActivity=function(t){return new e(this._telemetryLogger,t,this)},e.prototype.setEventFlags=function(e){this._optionalEventFlags=e},e.prototype.addDataField=function(e){this._dataFields.push(e)},e.prototype.addDataFields=function(e){var t;(t=this._dataFields).push.apply(t,e)},e.prototype.setSuccess=function(e){this._success=e},e.prototype.setResult=function(e,t,n){this._result={code:e,type:t,tag:n}},e.prototype.endNow=function(){if(!this._ended){void 0===this._success&&void 0===this._result&&R(k.Warning,D.Core,function(){return"Activity does not have success or result set"});var e=L()-this._startTime;this._ended=!0;var t={duration:e,count:1,aggMode:0,cV:this._cv.getString(),success:this._success,result:this._result};return this._telemetryLogger.sendActivity(this._activityName,t,this._dataFields,this._optionalEventFlags)}R(k.Error,D.Core,function(){return"Activity has already ended"})},e.prototype.executeAsync=function(e){return x(this,void 0,void 0,function(){var t=this;return O(this,function(n){return[2,e(this).then(function(e){return t.endNow(),e}).catch(function(e){throw t.endNow(),e})]})})},e.prototype.executeSync=function(e){try{var t=e(this);return this.endNow(),t}catch(e){throw this.endNow(),e}},e.prototype.executeChildActivityAsync=function(e,t){return x(this,void 0,void 0,function(){return O(this,function(n){return[2,this.createChildActivity(e).executeAsync(t)]})})},e.prototype.executeChildActivitySync=function(e,t){return this.createChildActivity(e).executeSync(t)},e}(),q=n(7393);function H(e){var t={costPriority:U.Normal,samplingPolicy:_.Measure,persistencePriority:M.Normal,dataCategories:W.NotSet,diagnosticLevel:V.FullEvent};return e.eventFlags&&e.eventFlags.dataCategories||R(k.Error,D.Core,function(){return"Event is missing DataCategories event flag"}),e.eventFlags?(e.eventFlags.costPriority&&(t.costPriority=e.eventFlags.costPriority),e.eventFlags.samplingPolicy&&(t.samplingPolicy=e.eventFlags.samplingPolicy),e.eventFlags.persistencePriority&&(t.persistencePriority=e.eventFlags.persistencePriority),e.eventFlags.dataCategories&&(t.dataCategories=e.eventFlags.dataCategories),e.eventFlags.diagnosticLevel&&(t.diagnosticLevel=e.eventFlags.diagnosticLevel),t):t}!function(e){e[e.NotSet=0]="NotSet",e[e.Measure=1]="Measure",e[e.Diagnostics=2]="Diagnostics",e[e.CriticalBusinessImpact=191]="CriticalBusinessImpact",e[e.CriticalCensus=192]="CriticalCensus",e[e.CriticalExperimentation=193]="CriticalExperimentation",e[e.CriticalUsage=194]="CriticalUsage"}(_||(_={})),function(e){e[e.NotSet=0]="NotSet",e[e.Normal=1]="Normal",e[e.High=2]="High"}(M||(M={})),function(e){e[e.NotSet=0]="NotSet",e[e.Normal=1]="Normal",e[e.High=2]="High"}(U||(U={})),function(e){e[e.NotSet=0]="NotSet",e[e.SoftwareSetup=1]="SoftwareSetup",e[e.ProductServiceUsage=2]="ProductServiceUsage",e[e.ProductServicePerformance=4]="ProductServicePerformance",e[e.DeviceConfiguration=8]="DeviceConfiguration",e[e.InkingTypingSpeech=16]="InkingTypingSpeech"}(W||(W={})),function(e){e[e.ReservedDoNotUse=0]="ReservedDoNotUse",e[e.BasicEvent=10]="BasicEvent",e[e.FullEvent=100]="FullEvent"}(V||(V={})),function(e){e[e.Aria=0]="Aria",e[e.Nexus=1]="Nexus"}(z||(z={})),function(e){var t={},n={},r={};function i(e){if("object"!=typeof e)throw new Error("tokenTree must be an object");r=function e(t,n){if("object"!=typeof n)return n;for(var r=0,i=Object.keys(n);r<i.length;r++){var o=i[r];o in t&&(t[o],1)?t[o]=e(t[o],n[o]):t[o]=n[o]}return t}(r,e)}function o(e){if(t[e])return t[e];var n=s(e,z.Aria);return"string"==typeof n?(t[e]=n,n):void 0}function a(e){if(n[e])return n[e];var t=s(e,z.Nexus);return"number"==typeof t?(n[e]=t,t):void 0}function s(e,t){var n=e.split("."),i=r,o=void 0;if(i){for(var a=0;a<n.length-1;a++)i[n[a]]&&(i=i[n[a]],t===z.Aria&&"string"==typeof i.ariaTenantToken?o=i.ariaTenantToken:t===z.Nexus&&"number"==typeof i.nexusTenantToken&&(o=i.nexusTenantToken));return o}}e.setTenantToken=function(e,t,n){var r=e.split(".");if(r.length<2||"Office"!==r[0])R(k.Error,D.Core,function(){return"Invalid namespace: "+e});else{var o=Object.create(Object.prototype);t&&(o.ariaTenantToken=t),n&&(o.nexusTenantToken=n);var a,s=o;for(a=r.length-1;a>=0;--a){var u=Object.create(Object.prototype);u[r[a]]=s,s=u}i(s)}},e.setTenantTokens=i,e.getTenantTokens=function(e){var t=o(e),n=a(e);if(!n||!t)throw new Error("Could not find tenant token");return{ariaTenantToken:t,nexusTenantToken:n}},e.getAriaTenantToken=o,e.getNexusTenantToken=a,e.clear=function(){t={},n={},r={}}}(B||(B={}));var G,j=function(){function e(e,t){var n,r;this.onSendEvent=new C,this.telemetryEnabled=!0,this.queriedForTelemetryEnabled=!1,this.persistentDataFields=[],e&&(this.onSendEvent=e.onSendEvent,(n=this.persistentDataFields).push.apply(n,e.persistentDataFields)),t&&(r=this.persistentDataFields).push.apply(r,t)}return e.prototype.sendTelemetryEvent=function(e){try{if(!this.isTelemetryEnabled())return;if(0===this.onSendEvent.getListenerCount())return void R(k.Warning,D.Core,function(){return"No telemetry sinks are attached."});var t=this.cloneEvent(e);this.processTelemetryEvent(t),this.onSendEvent.fireEvent(t)}catch(e){var n;n=e instanceof Error?e.message:JSON.stringify(e),R(k.Error,D.Core,function(){return n})}},e.prototype.processTelemetryEvent=function(e){var t;e.telemetryProperties||(e.telemetryProperties=B.getTenantTokens(e.eventName)),(t=e.dataFields).push.apply(t,this.persistentDataFields),r.validateTelemetryEvent(e)},e.prototype.addSink=function(e){this.onSendEvent.addListener(function(t){return e.sendTelemetryEvent(t)})},e.prototype.setTenantToken=function(e,t,n){B.setTenantToken(e,t,n)},e.prototype.setTenantTokens=function(e){B.setTenantTokens(e)},e.prototype.setIsTelemetryEnabled_TestOnly=function(e){this.telemetryEnabled=e,this.queriedForTelemetryEnabled=!0},e.prototype.cloneEvent=function(e){var t={eventName:e.eventName,eventFlags:e.eventFlags};return e.telemetryProperties&&(t.telemetryProperties={ariaTenantToken:e.telemetryProperties.ariaTenantToken,nexusTenantToken:e.telemetryProperties.nexusTenantToken}),e.eventContract&&(t.eventContract={name:e.eventContract.name,dataFields:e.eventContract.dataFields.slice()}),t.dataFields=e.dataFields?e.dataFields.slice():[],t},e.prototype.isTelemetryEnabled=function(){return this.queriedForTelemetryEnabled||(this.telemetryEnabled=this.isTelemetryEnabledInternal(),this.queriedForTelemetryEnabled=!0),this.telemetryEnabled},e.prototype.isTelemetryEnabledInternal=function(){return"undefined"==typeof OSF||void 0!==OSF.AppTelemetry&&void 0!==OSF.AppTelemetry.enableTelemetry&&!1!==OSF.AppTelemetry.enableTelemetry||(R(k.Warning,D.Core,function(){return"AppTelemetry is disabled for this platform."}),!1)},e}(),Z=(G=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}G(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),$=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,s)}u((r=r.apply(e,t||[])).next())})},X=function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},Y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Z(t,e),t.prototype.executeActivityAsync=function(e,t){return $(this,void 0,void 0,function(){return X(this,function(n){return[2,this.createNewActivity(e).executeAsync(t)]})})},t.prototype.executeActivitySync=function(e,t){return this.createNewActivity(e).executeSync(t)},t.prototype.createNewActivity=function(e){return J.createNew(this,e)},t.prototype.sendActivity=function(e,t,n,r){return this.sendTelemetryEvent({eventName:e,eventContract:{name:y.Office.System.Activity.contractName,dataFields:y.Office.System.Activity.getFields(t)},dataFields:n,eventFlags:r})},t.prototype.sendError=function(e){return this.sendTelemetryEvent({eventName:e.eventName,dataFields:d.getFields("Error",e.error),eventFlags:e.eventFlags})},t}(j);n.d(t,"Contracts",function(){return y}),n.d(t,"ActivityScope",function(){return J}),n.d(t,"getFieldsForContract",function(){return m}),n.d(t,"addContractField",function(){return h}),n.d(t,"DataClassification",function(){return q.a}),n.d(t,"makeBooleanDataField",function(){return f}),n.d(t,"makeInt64DataField",function(){return v}),n.d(t,"makeDoubleDataField",function(){return g}),n.d(t,"makeStringDataField",function(){return p}),n.d(t,"DataFieldType",function(){return c.a}),n.d(t,"getEffectiveEventFlags",function(){return H}),n.d(t,"SamplingPolicy",function(){return _}),n.d(t,"PersistencePriority",function(){return M}),n.d(t,"CostPriority",function(){return U}),n.d(t,"DataCategories",function(){return W}),n.d(t,"DiagnosticLevel",function(){return V}),n.d(t,"LogLevel",function(){return k}),n.d(t,"Category",function(){return D}),n.d(t,"onNotification",function(){return P}),n.d(t,"logNotification",function(){return R}),n.d(t,"SuppressNexus",function(){return-1}),n.d(t,"SimpleTelemetryLogger",function(){return j}),n.d(t,"TelemetryLogger",function(){return Y})},13363:function(e,t,n){"use strict";n.r(t);var r,i,o=new(function(){function e(){this._listeners=[]}return e.prototype.fireEvent=function(e){this._listeners.forEach(function(t){return t(e)})},e.prototype.addListener=function(e){e&&this._listeners.push(e)},e.prototype.removeListener=function(e){this._listeners=this._listeners.filter(function(t){return t!==e})},e.prototype.getListenerCount=function(){return this._listeners.length},e}());function a(e,t,n){o.fireEvent({level:e,category:t,message:n})}!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose"}(r||(r={})),function(e){e[e.Core=0]="Core",e[e.Sink=1]="Sink",e[e.Transport=2]="Transport"}(i||(i={}));var s=n(1639),u=n(2011),l=n.n(u),d=n(3094),c=n.n(d),f=n(1241),v=n(6088),g=n(7393),p=/\./g,m=".",h="Data",y="zC",S=0;function b(e,t,n){var r,i,o={name:(r=e.eventName,r.toLowerCase().replace(p,"_")),properties:{}};if(!e.telemetryProperties||!e.telemetryProperties.ariaTenantToken)throw new Error("Unable to find ariaTenantToken for namespace.");return o.properties["Event.Sequence"]={value:++S,type:f.AWTPropertyType.Int64},o.properties["Event.Name"]=e.eventName,o.properties["Event.Source"]="OTelJS",i=n?new Date(n):new Date,o.properties["Event.Time"]={value:i,type:f.AWTPropertyType.Date},e.eventContract&&(o.properties["Event.Contract"]=e.eventContract.name,T(o,e.eventContract.dataFields,!1)),T(o,t,!1),T(o,e.dataFields,!0),o}function T(e,t,n){t&&t.forEach(function(t){if(!t.classification||t.classification===g.a.SystemMetadata){var r=["","",t.name],i=r[0],o=r[1],a=r[2],s=t.name.indexOf(m);s>0&&t.name.substr(0,s)===y&&(i=t.name.substring(0,s+1),a=t.name.substring(s+1)),n&&(o=h+m);var u=i+o+a;e.properties[u]={value:t.value,type:w(t.dataType)}}})}function w(e){switch(e){case v.a.String:return f.AWTPropertyType.String;case v.a.Boolean:return f.AWTPropertyType.Boolean;case v.a.Int64:return f.AWTPropertyType.Int64;case v.a.Double:return f.AWTPropertyType.Double;default:throw new Error(e)}}var I,A,E,N,k,D="cd836626611c4caaa8fc5b2e728ee81d-3b6d6c45-6377-4bf5-9792-dbf8e1881088-7521",C=0,F=0,P=0,R=0,x=0,O=!1;function L(e,t,n){var r;if(C++,_(),!e.telemetryProperties||!e.telemetryProperties.ariaTenantToken)throw new Error("Unable to find ariaTenantToken for namespace.");r=b(e,t,n),s.AWTLogManager.getLogger(e.telemetryProperties.ariaTenantToken).logEvent(r)}function _(e){O||(s.AWTLogManager.addNotificationListener({eventsSent:function(e){a(r.Info,i.Transport,function(){return"Successfully sent "+e.length+" event(s)"}),a(r.Verbose,i.Transport,function(){return"Sent event(s) details : "+JSON.stringify(e,null,2)}),F+=e.length},eventsDropped:function(e,t){a(r.Error,i.Transport,function(){return"Dropped "+e.length+" event(s) because "+t}),a(r.Verbose,i.Transport,function(){return"Dropped event(s) details : "+JSON.stringify(e,null,2)}),P+=e.length},eventsRejected:function(e,t){a(r.Error,i.Transport,function(){return"Rejected "+e.length+" event(s) because "+t}),a(r.Verbose,i.Transport,function(){return"Rejected event(s) details : "+JSON.stringify(e,null,2)}),R+=e.length},eventsRetrying:function(e){a(r.Warning,i.Transport,function(){return"Retrying "+e.length+" event(s)"}),a(r.Verbose,i.Transport,function(){return"Retrying event(s) details : "+JSON.stringify(e,null,2)}),x+=e.length}}),s.AWTLogManager.initialize(D,e),O=!0)}function M(){var e=l.a.getEventsHandler();if(e instanceof c.a){var t=e._httpManager;if(t&&t.hasOwnProperty("_useBeacons"))return t._useBeacons=!1,!0}return!1}function U(){s.AWTLogManager.flushAndTeardown()}!function(e){e[e.NotSet=0]="NotSet",e[e.Measure=1]="Measure",e[e.Diagnostics=2]="Diagnostics",e[e.CriticalBusinessImpact=191]="CriticalBusinessImpact",e[e.CriticalCensus=192]="CriticalCensus",e[e.CriticalExperimentation=193]="CriticalExperimentation",e[e.CriticalUsage=194]="CriticalUsage"}(I||(I={})),function(e){e[e.NotSet=0]="NotSet",e[e.Normal=1]="Normal",e[e.High=2]="High"}(A||(A={})),function(e){e[e.NotSet=0]="NotSet",e[e.Normal=1]="Normal",e[e.High=2]="High"}(E||(E={})),function(e){e[e.NotSet=0]="NotSet",e[e.SoftwareSetup=1]="SoftwareSetup",e[e.ProductServiceUsage=2]="ProductServiceUsage",e[e.ProductServicePerformance=4]="ProductServicePerformance",e[e.DeviceConfiguration=8]="DeviceConfiguration",e[e.InkingTypingSpeech=16]="InkingTypingSpeech"}(N||(N={})),function(e){e[e.ReservedDoNotUse=0]="ReservedDoNotUse",e[e.BasicEvent=10]="BasicEvent",e[e.FullEvent=100]="FullEvent",e[e.NecessaryServiceDataEvent=110]="NecessaryServiceDataEvent",e[e.AlwaysOnNecessaryServiceDataEvent=120]="AlwaysOnNecessaryServiceDataEvent"}(k||(k={}));var W,V,z=function(){function e(){this._fullEventsEnabled=!1}return e.prototype.processEvent=function(e){return this._fullEventsEnabled||!!e.eventFlags&&e.eventFlags.diagnosticLevel===k.BasicEvent},e.prototype.setFullEventsEnabled=function(e){this._fullEventsEnabled=e},e}(),B=function(){function e(e,t){void 0===e&&(e=[]),this._preprocessors=[],this._additionalDataFields=e,this._fullEventProcessor=new z,this.addPreprocessor(this._fullEventProcessor),_({cacheMemorySizeLimitInNumberOfEvents:t})}return e.prototype.sendTelemetryEvent=function(e,t){try{for(var n=0;n<this._preprocessors.length;n++)if(!this._preprocessors[n].processEvent(e))return;L(e,this._additionalDataFields,t)}catch(e){a(r.Error,i.Sink,function(){return"AriaSink caught an error : "+(e instanceof Error?e.message:JSON.stringify(e))})}},e.prototype.addPreprocessor=function(e){this._preprocessors.push(e)},e.prototype.setFullEventsEnabled=function(e){this._fullEventProcessor.setFullEventsEnabled(e)},e.prototype.disableBeaconsApiAvailabilityForAriaSdk=function(){return M()},e.prototype.shutdown=function(){U()},e}();function J(e,t){return{name:e,dataType:W.String,value:t}}!function(e){e[e.String=0]="String",e[e.Boolean=1]="Boolean",e[e.Int64=2]="Int64",e[e.Double=3]="Double"}(W||(W={})),function(e){var t=-9007199254740991,n=9007199254740991,r=/^[A-Z][a-zA-Z0-9]*$/,i=/^[a-zA-Z0-9_\.]*$/;function o(e){return void 0!==e&&i.test(e)}function a(e){if(!((t=e.name)&&o(t)&&t.length+5<100))throw new Error("Invalid dataField name");var t;e.dataType===W.Int64&&s(e.value)}function s(e){if("number"!=typeof e||!isFinite(e)||Math.floor(e)!==e||e<t||e>n)throw{message:"Invalid integer "+JSON.stringify(e)}}e.validateTelemetryEvent=function(e){if(!function(e){if(!e||e.length>98)return!1;var t,n=e.split("."),i=n[n.length-1];return function(e){return!!e&&e.length>=3&&"Office"===e[0]}(n)&&(void 0!==(t=i)&&r.test(t))}(e.eventName))throw new Error("Invalid eventName");if(e.eventContract&&!o(e.eventContract.name))throw new Error("Invalid eventContract");if(null!=e.dataFields)for(var t=0;t<e.dataFields.length;t++)a(e.dataFields[t])},e.validateInt=s}(V||(V={}));var q,H=function(){function e(e){this._totalEventsInLastInterval=0,this._SingleEventInLastInterval={},this.TELEMETRY_THROTTLED_EVENT={eventName:"Office.Telemetry.OTelJS.EventThrottled",telemetryProperties:{ariaTenantToken:"f998cc5ba4d448d6a1e8e913ff18be94-dd122e0a-fcf8-4dc5-9dbb-6afac5325183-7405",nexusTenantToken:1723}},this._sinkName=e,this._lastIntervalStart=Date.now(),this._sendEvent=L}return e.prototype.setSingleEventThrottle=function(e){this._maxSingleEventPerSecond=e},e.prototype.setTotalEventThrottle=function(e){this._maxTotalEventsPerSecond=e},e.prototype.processEvent=function(e){(this._maxSingleEventPerSecond||this._maxTotalEventsPerSecond)&&(Date.now()-this._lastIntervalStart>1e3&&(this._lastIntervalStart=Date.now(),this._totalEventsInLastInterval=0,this._SingleEventInLastInterval={}),this._maxSingleEventPerSecond&&(e.eventName in this._SingleEventInLastInterval?this._SingleEventInLastInterval[e.eventName]++:this._SingleEventInLastInterval[e.eventName]=1,this.applyThrottle(this._SingleEventInLastInterval[e.eventName],this._maxSingleEventPerSecond,"MaxSingleEventsPerSecond",e.eventName)),this._maxTotalEventsPerSecond&&(this._totalEventsInLastInterval++,this.applyThrottle(this._totalEventsInLastInterval,this._maxTotalEventsPerSecond,"MaxTotalEventsPerSecond",e.eventName)));return!0},e.prototype.applyThrottle=function(e,t,n,r){if(e>t)throw e===t+1&&this._sendEvent(this.TELEMETRY_THROTTLED_EVENT,[J("SinkName",this._sinkName),J("ThrottledEvent.Name",r),(i=n,o=t,V.validateInt(o),{name:i,dataType:W.Int64,value:o})]),"Exceeded "+t+" "+n;var i,o;return!0},e}(),G=n(4551);!function(e){(q||(q={})).newGuid=function(){return G()}}(),n.d(t,"AriaSink",function(){return B}),n.d(t,"otelEventsProcessed",function(){return C}),n.d(t,"ariaEventsSent",function(){return F}),n.d(t,"ariaEventsDropped",function(){return P}),n.d(t,"ariaEventsRejected",function(){return R}),n.d(t,"ariaEventsRetrying",function(){return x}),n.d(t,"sendEvent",function(){return L}),n.d(t,"initialize",function(){return _}),n.d(t,"disableBeaconsApiAvailabilityForAriaSdk",function(){return M}),n.d(t,"shutdown",function(){return U}),n.d(t,"EventThrottler",function(){return H}),n.d(t,"getAriaEvent",function(){return b}),n.d(t,"Utils",function(){return q})},4551:function(e,t,n){var r=n(5615),i=n(5616);e.exports=function(e,t,n){var o=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var a=(e=e||{}).random||(e.rng||r)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t)for(var s=0;s<16;++s)t[o+s]=a[s];return t||i(a)}},5615:function(e,t){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var r=new Uint8Array(16);e.exports=function(){return n(r),r}}else{var i=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),i[t]=e>>>((3&t)<<3)&255;return i}}},5616:function(e,t){for(var n=[],r=0;r<256;++r)n[r]=(r+256).toString(16).substr(1);e.exports=function(e,t){var r=t||0,i=n;return[i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]]].join("")}},6088:function(e,t,n){"use strict";var r;n.d(t,"a",function(){return r}),function(e){e[e.String=0]="String",e[e.Boolean=1]="Boolean",e[e.Int64=2]="Int64",e[e.Double=3]="Double"}(r||(r={}))},7393:function(e,t,n){"use strict";var r;n.d(t,"a",function(){return r}),function(e){e[e.EssentialServiceMetadata=1]="EssentialServiceMetadata",e[e.AccountData=2]="AccountData",e[e.SystemMetadata=4]="SystemMetadata",e[e.OrganizationIdentifiableInformation=8]="OrganizationIdentifiableInformation",e[e.EndUserIdentifiableInformation=16]="EndUserIdentifiableInformation",e[e.CustomerContent=32]="CustomerContent",e[e.AccessControl=64]="AccessControl"}(r||(r={}))}}]);
//# sourceMappingURL=owa.650.js.map
self.scriptsLoaded['owa.650.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.650.js'] = (new Date()).getTime();