self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.AttachmentsCompact.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[126],{11016:function(e,t,n){(t=e.exports=n(30)(!1)).push([e.i,'._3BaN6hJwwRs9ZPbGkjnwl7{display:inline-block;position:relative;vertical-align:top;cursor:pointer}html[dir] ._3BaN6hJwwRs9ZPbGkjnwl7{background:"[theme:neutralLighter, default:#f4f4f4]";border-radius:2px}html[dir=ltr] ._3BaN6hJwwRs9ZPbGkjnwl7{margin:0 4px 0 0}html[dir=rtl] ._3BaN6hJwwRs9ZPbGkjnwl7{margin:0 0 0 4px}html[dir] ._3BaN6hJwwRs9ZPbGkjnwl7 .ms-Image{border-radius:2px}._38DtwB3BVlUvdqhskgUJB8,.MwQXXz8yGngGZjfe8DLaa{height:48px;width:132px;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-ms-flex-line-pack:start;align-content:flex-start;-webkit-box-sizing:border-box;box-sizing:border-box}html[dir] ._38DtwB3BVlUvdqhskgUJB8,html[dir] .MwQXXz8yGngGZjfe8DLaa{padding:8px;background:"[theme:white, default:#ffffff]";border:solid 1px "[theme:neutralTertiaryAlt, default:#c8c8c8]"}html[dir] ._38DtwB3BVlUvdqhskgUJB8:hover,html[dir] .MwQXXz8yGngGZjfe8DLaa:hover{background:"[theme:neutralLighterAlt, default:#f8f8f8]";border-color:"[theme:neutralTertiary, default:#a6a6a6]"}html[dir] ._38DtwB3BVlUvdqhskgUJB8:active,html[dir] .MwQXXz8yGngGZjfe8DLaa:active{background:"[theme:neutralLighter, default:#f4f4f4]"}.MwQXXz8yGngGZjfe8DLaa{height:28px}html[dir] .MwQXXz8yGngGZjfe8DLaa{padding:4px 8px}._32PA19jgG4YavHsR-aTkla{width:64px;height:48px}._3EVpCaxWXDU07i3WmULM0r{font-size:30px;color:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}html[dir] ._3EVpCaxWXDU07i3WmULM0r{background:transparent}._3EVpCaxWXDU07i3WmULM0r+div{display:none}._1z8PLfr8XdRu3RoPTILXnv{height:100%;width:100%;-webkit-box-sizing:border-box;box-sizing:border-box;overflow:hidden;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}html[dir] ._1z8PLfr8XdRu3RoPTILXnv{border:solid 1px "[theme:neutralTertiaryAlt, default:#c8c8c8]";border-radius:2px;background:"[theme:white, default:#ffffff]"}html[dir] ._1z8PLfr8XdRu3RoPTILXnv:hover{background:"[theme:neutralLighterAlt, default:#f8f8f8]";border-color:"[theme:neutralTertiary, default:#a6a6a6]"}html[dir] ._1z8PLfr8XdRu3RoPTILXnv:active{border-color:"[theme:neutralTertiary, default:#a6a6a6]";background:"[theme:neutralLighter, default:#f4f4f4]"}html[dir] ._1z8PLfr8XdRu3RoPTILXnv>span>div{margin:-1px}html[dir=ltr] ._1qh4uzQStpeZ7LvnJ_zssa{margin-right:4px}html[dir=rtl] ._1qh4uzQStpeZ7LvnJ_zssa{margin-left:4px}._1gWe0dBojTxH42lZ5X02pH,._3wbcVgEAyYbnB0Lm1j7Ha2{font-size:12px;font-weight:400;width:94px}._3wbcVgEAyYbnB0Lm1j7Ha2{text-decoration:underline}._2xfC9F1tdYlsU2uIekAe57{font-size:10px;max-width:94px}html[dir=ltr] ._2xfC9F1tdYlsU2uIekAe57{margin-left:20px}html[dir=rtl] ._2xfC9F1tdYlsU2uIekAe57{margin-right:20px}._2io6PBPnqcTup7-xCfYYLZ{position:fixed;pointer-events:"none";z-index:1000;top:0;font-size:12px;font-weight:400}html[dir] ._2io6PBPnqcTup7-xCfYYLZ{border-width:1px;border-style:solid;padding:0 4px;background:"[theme:neutralTertiary, default:#a6a6a6]"}html[dir=ltr] ._2io6PBPnqcTup7-xCfYYLZ{left:0}html[dir=rtl] ._2io6PBPnqcTup7-xCfYYLZ{right:0}',""]),t.locals={attachmentView:"_3BaN6hJwwRs9ZPbGkjnwl7",attachmentDocView:"_38DtwB3BVlUvdqhskgUJB8",shortAttachmentDocView:"MwQXXz8yGngGZjfe8DLaa",attachmentImageView:"_32PA19jgG4YavHsR-aTkla",placeholder:"_3EVpCaxWXDU07i3WmULM0r",imageContainerDiv:"_1z8PLfr8XdRu3RoPTILXnv",iconCompactMode:"_1qh4uzQStpeZ7LvnJ_zssa",infoCompactModeFirstLine:"_1gWe0dBojTxH42lZ5X02pH",infoCompactModeFirstLineLink:"_3wbcVgEAyYbnB0Lm1j7Ha2",infoCompactModeSecondLine:"_2xfC9F1tdYlsU2uIekAe57",dragPreview:"_2io6PBPnqcTup7-xCfYYLZ"}},1106:function(e,t,n){"use strict";var r=n(1223);function i(e){window.open(e,"_blank")}var a=n(77);function o(e,t,n,r){if(t||Object(a.f)())i(e);else{var o=document.createElement("a");o.style.display="none",o.href=e,o.download=r||"",n||(n=document.activeElement&&document.activeElement.parentElement||document.body),n.appendChild(o),o.click(),n.removeChild(o)}}var c=n(691);function s(e,t){o(Object(r.a)(e,t,0,Object(c.b)(t),!1,!0),!1)}var u=n(0),l=n(492),d=n(2485),f=n(2104);function p(e,t){return u.__awaiter(this,void 0,void 0,function(){var n,i;return u.__generator(this,function(a){switch(a.label){case 0:return".pdf"!==Object(l.b)(t.Name).toLowerCase()?[3,1]:(n=Object(r.a)(e,t,3,Object(c.b)(t),!1),window.open(n,"_blank"),[3,3]);case 1:return Object(l.e)(t.Name)?[4,Object(d.a)(e,t,Object(c.b)(t))]:[3,3];case 2:i=a.sent(),f.a.importAndExecute(function(e){var t=document.createElement("div"),n=document.createElement("img");return n.src=e,t.appendChild(n),t.innerHTML}(i),"img {max-width: 100%; max-height: 100%; width: auto;  }"),a.label=3;case 3:return[2]}})})}var m=n(2486),h=n(2487),v=n(893);function b(e){var t=Object(v.f)(e,!0),n=Object(l.b)(e.Name);return Object(h.a)(t,e,n)}function g(e){var t=Object(l.b)(e.Name);return b(e)&&t&&(".pdf"===t.toLowerCase()&&Object(m.a)()||Object(l.e)(e.Name))}n.d(t,"a",function(){return s}),n.d(t,"f",function(){return p}),n.d(t,"d",function(){return g}),n.d(t,"c",function(){return b}),n.d(t,"b",function(){return o}),n.d(t,"e",function(){return i})},1122:function(e,t,n){"use strict";n.d(t,"b",function(){return s}),n.d(t,"a",function(){return p});var r,i=n(1770),a=n(1398),o=n(492),c={};function s(e){return e in c?c[e]:(c[e]={extraSmall:Object(a.a)(e+"_16x16"),small:Object(a.a)(e+"_20x20"),medium:Object(a.a)(e+"_32x32"),large:Object(a.a)(e+"_64x64"),cdn:-1===f.indexOf(e)?Object(i.a)(e+"_16x16"):Object(i.a)("generic_16x16")},c[e])}var u="generic",l=Object.freeze({".3g2":"video",".3gp":"video",".aac":"audio",".accdb":"accdb",".accdc":"accdb",".accde":"accdb",".accdr":"accdb",".accdt":"accdb",".acs":"accdb",".ai":"vector",".aiff":"audio",".ape":"audio",".asf":"video",".aspx":"code",".asx":"video",".avi":"video",".bmp":"photo",".csv":"csv",".dib":"photo",".dgn":"vector",".doc":"docx",".docm":"docx",".docx":"docx",".dot":"dotx",".dotm":"docx",".dotx":"dotx",".email":"email",".emf":"vector",".eml":"email",".eps":"vector",".exe":"exe",".flac":"audio",".flv":"video",".gdraw":"vector",".gif":"photo",".htm":"code",".html":"code",".ical":"calendar",".icalendar":"calendar",".ico":"photo",".ics":"calendar",".indd":"vector",".indt":"vector",".jfif":"photo",".jpe":"photo",".jpeg":"photo",".jpg":"photo",".log":"txt",".lync":u,".m1v":"video",".m4a":"audio",".mdb":"accdb",".mht":"code",".mov":"video",".mp2":"audio",".mp3":"audio",".mp4":"video",".mpa":"audio",".mpe":"video",".mpeg":"video",".mpg":"video",".mpp":"project",".mpt":"mpt",".mpv2":"video",".msg":"email",".odp":"pptx",".ods":"xlsx",".odt":"docx",".ogg":"audio",".one":"one",".onepkg":"onetoc",".onetoc":"onetoc",".onetoc2":"onetoc",".oxps":"vector",".pd":"vector",".pdf":"pdf",".plt":"vector",".png":"photo",".pot":"pptx",".potm":"pptx",".potx":"potx",".ppa":"pptx",".ppam":"pptx",".pps":"pptx",".ppsm":"pptx",".ppsx":"ppsx",".ppt":"pptx",".pptm":"pptx",".pptx":"pptx",".pro":"vector",".ps":"vector",".psd":"photo",".pub":"pblsh",".rpmsg":"rpmsg",".rtf":"txt",".sketch":"vector",".srt":"video",".svg":"vector",".svgz":"vector",".swf":"video",".tif":"photo",".tiff":"photo",".txt":"txt",".url":"link",".vcs":"calendar",".vdx":"vsdx",".vob":"video",".vsd":"vsdx",".vsdx":"vsdx",".vsl":"vsdx",".vss":"vsdx",".vssx":"vssx",".vst":"vstx",".vstx":"vstx",".wav":"audio",".wm":"audio",".wma":"audio",".wmd":"video",".wmf":"vector",".wms":"video",".wmv":"video",".wmz":"video",".wps":"docx",".wri":"docx",".xcl":"xlsx",".xd":"vector",".xla":"xlsx",".xlam":"xlsx",".xls":"xlsx",".xlsb":"xlsx",".xlsm":"xlsx",".xlsx":"xlsx",".xlt":"xlsx",".xltm":"xlsx",".xltx":"xltx",".xml":"code",".xps":"vector",".xsn":"infopath",".zip":"zip"}),d=Object.freeze({"application/vnd.google-apps.document":"gdoc","application/vnd.google-apps.spreadsheet":"gsheet","application/vnd.google-apps.presentation":"gslide","application/vnd.google-apps.form":"gform","application/onenote":"one","application/pdf":"pdf"}),f=["gdoc","gform","gsheet","gslide"];function p(e,t,n){if(void 0===t&&(t=!1),t)return r=r||{extraSmall:null,small:Object(a.a)("folder_20x20"),medium:Object(a.a)("folder_32x32"),large:Object(a.a)("folder_64x64"),cdn:Object(i.a)("folder_16x16")};var c,f=Object(o.b)(e);return f&&(c=l[f.toLowerCase()]),!c&&n&&n in d&&(c=d[n]),s(c||u)}},1223:function(e,t,n){"use strict";var r=n(75),i=n(34),a=n(1769),o=n(234);function c(e,t,n,o,c){void 0===c&&(c=!0);var s=t,u=s.AttachmentId,d=s.Name,f=s.OriginalPermissionType,p=s.PermissionType,m=l(t),h=e.mailboxInfo.type===i.a.GroupMailbox?e.mailboxInfo.primarySmtpAddress+"/":null;switch(n){case 0:case 3:return a.b(u,m,n,o,p,f,c,d,h);case 1:return t.AttachmentPreviewUrl?t.AttachmentPreviewUrl:a.b(u,m,1,o,p,f,c,d,h);case 2:return t.AttachmentThumbnailUrl;default:return Object(r.a)(n)}}function s(e,t,n,r){return void 0===n&&(n=!1),void 0===r&&(r=!0),a.a(e.mailboxInfo.routingKey,e,t,n,r)}function u(e,t,n,r,i){void 0===i&&(i=!1);var u=n?c(e,t,1,r,!1):s(e,1,i,!1);if(n)return{url:u,init:{credentials:"include"}};var l=Object(a.c)(),d=new Headers;return d.set("X-Token",l),d.set("X-OWA-CANARY",Object(o.getOwaCanaryCookie)()),{url:u,init:{headers:d}}}function l(e){var t=null;return(t=e.AttachLongPathName)||(t=e.WebUrl),t}function d(e,t,n,r,i,a){return void 0===a&&(a=!1),r?c(e,t,n,i):s(e,n,a)}n.d(t,"a",function(){return d}),n.d(t,"b",function(){return s}),n.d(t,"c",function(){return u}),n.d(t,"d",function(){return l})},1267:function(e){e.exports={b:"Wba",d:"Xba",c:"Yba",a:"Zba"}},13780:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(4170),a=n(275),o=n(12),c=n(501),s=n(1140),u=n(37),l=n(333),d=n(367),f=n(2);Object(f.orchestrator)(a.e,function(e){if(e.mailListItemSelectionSource===u.e.MailListItemRichPreview){var t=Object(c.getRowIdString)(e.rowKey,e.tableView),n=l.E.attachmentViewStateIdFromListView,a=o.O.attachmentViewStates.get(n),f=Object(s.a)([e.rowKey],e.tableView);d.e.importAndExecute(d.i),Object(i.c)(a,i.a.MailList,f[0],a.parentItemId,!1,null,function(){return r.__awaiter(void 0,void 0,void 0,function(){return r.__generator(this,function(e){switch(e.label){case 0:return[4,l.o.import()];case 1:return[2,e.sent()(o.O.rowAttachmentPreviewWellViews.get(t).imageViewStateIds,function(e){return o.O.attachmentViewStates.get(e)})]}})})})}});var p=Object(f.action)("onAttachmentViewStateIdChange",function(e){return{attachmentViewStateId:e}});Object(f.mutator)(p,function(e){var t=e.attachmentViewStateId;l.E.attachmentViewStateIdFromListView=t});var m=n(1429),h=n(1),v=n(2076),b=n(2616),g=n(7572),w=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=3===this.props.attachment.type;return h.createElement("div",{className:this.props.isShortDocView?g.shortAttachmentDocView:g.attachmentDocView},h.createElement(b.b,{attachmentId:this.props.attachmentViewState.attachmentId,className:g.iconCompactMode,iconSize:0}),h.createElement(b.a,{attachmentViewState:this.props.attachmentViewState,attachment:this.props.attachment,firstLineStyle:e?g.infoCompactModeFirstLineLink:g.infoCompactModeFirstLine,secondLineStyle:g.infoCompactModeSecondLine,isShortDocView:this.props.isShortDocView}))},t=r.__decorate([Object(v.reactive)({attachment:function(e){return Object(m.a)(e.attachmentViewState.attachmentId)}})],t)}(h.Component),x=n(13),O=n(28),P=n(492),y=n(985),I=n(7572),T=n(115).bind(I),A=Object(O.a)(function(e){var t=Object(m.a)(e.attachmentViewState.attachmentId).model.Name,n=null,r=Object(y.e)(t),i=Object(x.getIconClassName)("Photo2"),a=r.small;Object(P.f)(t)&&(n=a,i=a);var o=T(I.placeholder,i);return h.createElement("span",null,h.createElement("div",{className:I.imageContainerDiv},h.createElement(b.c,{attachmentViewState:e.attachmentViewState,placeHolderCSSClass:o,fileIconCssClass:n,imageLoadErrorCSSClass:a,thumbnailWidth:64,thumbnailHeight:48})))}),_=n(19),j=n(18),C=n(2707),E=n(1234),k=n(153),S=n(6),D=n(7572),L=n(115).bind(D),F=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onClick=function(e){p(t.props.attachmentViewStateId),t.props.onPreviewClick(e)},t.canDrag=function(){return!!Object(m.a)(t.props.attachmentViewState.attachmentId)&&Object(S.e)("doc-attachment-listViewDragDrop")},t.getAttachmentDragData=function(){var e=Object(m.a)(t.props.attachmentViewState.attachmentId).model,n=Object(C.a)(e);return{itemType:k.a.Attachment,attachmentFile:n}},t.getDragPreview=function(){var e=document.createElement("div");return e.className=D.dragPreview,e.innerText=Object(m.a)(t.props.attachmentViewState.attachmentId).model.Name,e},t}return r.__extends(t,e),t.prototype.render=function(){var e={attachmentImageView:this.props.isImage},t=Object(m.a)(this.props.attachmentViewState.attachmentId);return h.createElement("div",{onClick:this.onClick,title:t.model.Name,className:L(D.attachmentView,e)},h.createElement(E.b,{canDrag:this.canDrag,getDragData:this.getAttachmentDragData,getDragPreview:this.getDragPreview,xOffset:-12,yOffset:5},this.props.isImage?h.createElement(A,{attachmentViewState:this.props.attachmentViewState}):h.createElement(w,{attachmentViewState:this.props.attachmentViewState,isShortDocView:this.props.isShortDocView})))},t=r.__decorate([_.observer,Object(j.l)("AttachmentCompactView")],t)}(h.Component);n.d(t,"AttachmentCompactView",function(){return F})},1398:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(2956),i="fileType-icon";function a(e){return r[function(e){return i+"-"+e}(e)]}},1429:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(953);function i(e){return Object(r.a)().attachments.get(e.Id)}},1518:function(e,t,n){"use strict";var r=n(887),i={BOX:"Box",DROPBOX:"Dropbox",FACEBOOK:"Facebook",GDRIVE:"GDrive",MAILBOX:"Mailbox",ONE_DRIVE_CONSUMER:"OneDriveConsumer",ONE_DRIVE_PRO:"OneDrivePro",RECENT_ATTACHMENTS:"RecentAttachments",WOPI:"Wopi",WOPI_BOX:"WopiBox",WOPI_EGNYTE:"WopiEgnyte"};function a(e){switch(e?e.toLowerCase():null){case i.ONE_DRIVE_PRO.toLowerCase():return 0;case i.GDRIVE.toLowerCase():return 5;case i.ONE_DRIVE_CONSUMER.toLowerCase():return 1;case i.DROPBOX.toLowerCase():return 2;case i.BOX.toLowerCase():return 3;case i.WOPI_BOX.toLowerCase():return 7;case i.WOPI_EGNYTE.toLowerCase():return 8;case i.MAILBOX.toLowerCase():return 4;case i.FACEBOOK.toLowerCase():return 6;default:return null}}function o(e){return null==e?null:{attachmentItemId:e.Id,name:e.Name,size:e.Size,fileType:r.a.AttachmentItem,type:"ItemIdAttachment:#Exchange"}}function c(e){return null==e?null:{fileType:r.a.Cloud,name:e.Name,size:e.Size,providerId:e.AttachmentProviderId,providerType:e.ProviderType,location:e.Location,providerEndpointUrl:e.ProviderEndpointUrl,isFolder:1===e.Type,fileId:e.Id,fileParentId:e.ParentId,thumbnailUrl:e.Thumbnail?e.Thumbnail.Url:"",previewUrl:e.Preview?e.Preview.Url:"",type:e.MimeType}}function s(e){if(!e)return null;for(var t=[],n=0;n<e.length;n++){var i=e[n],a={fileType:r.a.Local,name:i.name,size:i.size,type:i.type,fileObject:i};t.push(a)}return t}function u(e,t,n){var i=[],a={fileType:r.a.MailItem,name:e,size:n||0,mimeContent:t};return i.push(a),i}var l=n(11);function d(e,t,n){if(e.length!=t.length)return l.d.error("The sizes of subjects and latestItemIds are different"),null;for(var i=[],a=0;a<e.length;a++){var o={fileType:r.a.MailItem,name:e[a],size:n&&n[a]||0,itemId:t[a]};i.push(o)}return i}var f=n(492);function p(e){return e.map(function(e){return{fileType:r.a.Uri,name:e.name,type:Object(f.b)(e.url),size:0,uri:e.url}})}n.d(t,"b",function(){return a}),n.d(t,"e",function(){return s}),n.d(t,"g",function(){return d}),n.d(t,"c",function(){return o}),n.d(t,"d",function(){return c}),n.d(t,"h",function(){return p}),n.d(t,"f",function(){return u}),n.d(t,"a",function(){return r.a})},1561:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r={attachmentTypes:{FILE_ATTACHMENT_TYPE:"FileAttachment:#Exchange",ITEM_ATTACHMENT_TYPE:"ItemAttachment:#Exchange",ITEM_ID_ATTACHMENT_TYPE:"ItemIdAttachment:#Exchange",REFERENCE_ATTACHMENT_TYPE:"ReferenceAttachment:#Exchange"}}},1677:function(e){e.exports={a:"Jba",b:"Kba"}},1762:function(e,t,n){"use strict";n.d(t,"a",function(){return p}),n.d(t,"c",function(){return m}),n.d(t,"b",function(){return h});var r=n(0),i=n(4),a=n(2444),o=n(2456),c=n.n(o),s=n(10),u=n(18),l=n(11),d=Object(a.b)({timeBetweenRetryInMS:function(){return 3e4}}),f=function(){function e(e,t,n){var a=this;this.downloadTokenRefreshMinutes=e,this.downloadUrlBase=t,this.refreshDownloadTokenAndRetryInCaseOfFailure=function(){return r.__awaiter(a,void 0,void 0,function(){function e(){return r.__awaiter(this,void 0,void 0,function(){var e;return r.__generator(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,c()()];case 1:return[2,t.sent()];case 2:throw e=t.sent(),l.d.warn("Unable to get the download token "+e),e;case 3:return[2]}})})}var t,n,i,a,o=this;return r.__generator(this,function(c){switch(c.label){case 0:if(this.isRefreshingDownloadToken)return[3,4];this.isRefreshingDownloadToken=!0,t=0,n=d(function(){return r.__awaiter(o,void 0,void 0,function(){var n;return r.__generator(this,function(r){switch(r.label){case 0:return t++,n=this,[4,e()];case 1:return n.downloadToken=r.sent(),this.isRefreshingDownloadToken=!1,[2]}})})}).retriableFunc,i=new u.b("AttachmentRefreshDownloadToken"),c.label=1;case 1:return c.trys.push([1,3,,4]),[4,n()];case 2:return c.sent(),i.addCustomData([t]),i.end(),[3,4];case 3:return a=c.sent(),l.d.warn("Retry to refresh token failed: "+a),i.addCustomData([t]),i.endWithError("ServerError",a),this.isRefreshingDownloadToken=!1,[3,4];case 4:return[2]}})})},this.useDownloadUrlBase=!Object(i.g)(this.downloadUrlBase),this.downloadToken=n,this.downloadTokenRefreshMinutes<1&&(this.downloadTokenRefreshMinutes=1),this.useDownloadUrlBase&&setInterval(this.refreshDownloadTokenAndRetryInCaseOfFailure,6e4*this.downloadTokenRefreshMinutes)}return e.getInstance=function(){if(!e.instance){var t=Object(s.a)().ApplicationSettings;e.instance=new e(t.DownloadTokenRefreshMinutes,t.DownloadUrlBase,t.FirstDownloadToken)}return e.instance},e.resetInstanceForTesting=function(){e.instance=null},e.prototype.getDownloadToken=function(){return this.downloadToken},e.prototype.getUseDownloadUrlBase=function(){return this.useDownloadUrlBase},e.prototype.getDownloadUrlBase=function(){return this.downloadUrlBase},e}();function p(){return f.getInstance().getDownloadToken()}function m(){return f.getInstance().getUseDownloadUrlBase()}function h(){return f.getInstance().getDownloadUrlBase()}},1769:function(e,t,n){"use strict";var r=n(2445);n.d(t,"a",function(){return r.a}),n.d(t,"b",function(){return r.b});var i=n(1762);n.d(t,"c",function(){return i.a})},1770:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=1;function i(e){return"https://r"+(r++%4+1)+".res.outlook.com/owa/prem/images/"+e+".png"}},2097:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r=n(0),i=n(309),a=n(1518),o=[0,1,3,2,6,5,7,8,4];function c(e){var t=null,n=function(n){var i=Object(a.b)(n);return null===i?null:function(){var n,i;if(!t){t={};try{for(var a=r.__values(o),c=a.next();!c.done;c=a.next()){var s=c.value;t[s]=e(s)}}catch(e){n={error:e}}finally{try{c&&!c.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}}return t}()[i]};return{getDataProviderInfo:n,getDefaultDataProviderInfo:function(e){return n(e?i.l:i.m)}}}},2104:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(3),i=new r.c(function(){return n.e(367).then(n.bind(null,3389))}),a=new r.a(i,function(e){return e.print})},2243:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetAccessTokenForDataProviderRequest:#Exchange"},e)}},2249:function(e,t,n){var r=n(2946),i=6e4;e.exports=function(e,t){var n=Number(t);return r(e,n*i)}},2444:function(e,t,n){"use strict";function r(e){void 0===e&&(e={}),function(e){e.timeBetweenRetryInMS=e.timeBetweenRetryInMS||function(){return 6e4}}(e);var t=e.maximumAttempts,n=e.timeBetweenRetryInMS;return function(e){var r=0,i=!1,a=function(o,c){i?c(new Error("The function retry was cancelled")):(r++,e().then(function(e){return o(e)}).catch(function(e){t&&r>=t?c(e):setTimeout(function(){return a(o,c)},n(r))}))};return{retriableFunc:function(){return new Promise(function(e,t){return a(e,t)})},cancel:function(){return i=!0}}}}function i(e){return function(t){return Math.pow(2,t)*e}}n.d(t,"b",function(){return r}),n.d(t,"a",function(){return i})},2445:function(e,t,n){"use strict";var r=n(75),i=n(4),a=n(234),o="/owa/",c="service.svc/s/GetFileAttachment?id={0}",s="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}",u="service.svc/s/GetAttachmentThumbnail?id={0}&thumbnailType=2",l="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}&isImagePreview=True",d="service.svc/s/GetAttachmentThumbnail?id={0}",f="pdfprint.aspx?id={0}",p="pdfprint.aspx?id={0}&location={1}",m=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd",".tiff",".tif"];var h=n(1762),v=n(44),b=n(125),g=n(15);function w(e,t,n,c,u,d,f,h,v){var b;switch(void 0===u&&(u=0),void 0===d&&(d=0),void 0===f&&(f=!0),void 0===h&&(h=null),void 0===v&&(v=null),n){case 0:b=s;break;case 3:b=p;break;case 1:if(!function(e){if(!e)return!1;var t=null,n=e.lastIndexOf(".");return n>0&&(t=e.substr(n).toLowerCase()),!!t&&m.indexOf(t.toLowerCase())>=0}(h))return null;b=l;break;default:Object(r.a)(n)}var g=c?d:u;!g&&u&&(g=u);var w=Object(i.b)("{0}{1}{2}&permissionLevel={3}",o,v,Object(i.b)(b,encodeURIComponent(e.Id),encodeURIComponent(t)),g);f&&(w=w+"&X-OWA-CANARY="+Object(a.getOwaCanaryCookie)());return w}function x(e,t,n,s,l){var p;switch(void 0===s&&(s=!1),void 0===l&&(l=!0),n){case 0:p=c;break;case 1:p=u;break;case 2:p=d;break;case 3:p=f;break;default:return Object(r.a)(n)}return Object(i.g)(p)?null:Object(i.b)("{0}{1}{2}",function(e,t,n,r,c){if(void 0===c&&(c=!1),!t||!t.Id)return null;var s=Object(i.b)(n,encodeURIComponent(t.Id));if(!Object(h.c)()||c&&"Firefox"===Object(b.a)().browser)return o+s+"&X-OWA-CANARY="+Object(a.getOwaCanaryCookie)();var u="{0}{1}/{2}&owa={3}&scriptVer={4}";Object(v.a)()&&(u+="&isc=1");var l=Object(i.b)(u,Object(h.b)(),e,s,window.location.hostname,Object(g.f)()||"unofficial");return r&&(l+="&X-OWA-CANARY="+Object(a.getOwaCanaryCookie)(),l+="&token="+Object(h.a)()),l}(e,t,p,l,3===n),s?"&isDownload=true":"","&animation=true")}n.d(t,"b",function(){return w}),n.d(t,"a",function(){return x})},2447:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r,i=n(1122),a=n(1770);function o(e,t,n,o,c){if(n)return r=r||{extraSmall:Object(i.b)("generic").extraSmall,small:Object(i.b)("generic").small,medium:Object(i.b)("blockedfile").medium,large:Object(i.b)("generic").large,cdn:Object(a.a)("generic_16x16")};switch(c){case"IPM.Note":case"IPM.Note.SMIME":case"IPM.Note.SMIME.MultipartSigned":return Object(i.b)("email");case"IPM.Schedule":case"IPM.Appointment":case"IPM.OLE.CLASS.{00061055-0000-0000-C000-000000000046}":return Object(i.b)("calendar")}return o?Object(i.b)("sharedfolder"):Object(i.a)(e,!1,t)||Object(i.b)("generic")}},2456:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(56);t.default=function(e){return r.makeServiceRequest("GetAttachmentDownloadToken",{},e)}},2457:function(e,t,n){"use strict";var r=n(0),i=n(2097),a=n(2488),o=n(75);var c=Object(i.a)(function(e){switch(e){case 0:return r.__assign({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:function(e,t){return!0},supportedPermissionLevels:[],requiresFetchingSharingInformation:!1},{supportedPermissionLevels:[2,1],requiresFetchingSharingInformation:!0});case 1:return r.__assign({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:function(e,t){return!0},supportedPermissionLevels:[],requiresFetchingSharingInformation:!1},{supportImageThumbnail:!0,supportPreview:function(e,t){return t},supportedPermissionLevels:[2,1]});case 3:return r.__assign({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:function(e,t){return!0},supportedPermissionLevels:[],requiresFetchingSharingInformation:!1},{supportDownload:!1,supportPreview:function(e,t){return!1}});case 2:return r.__assign({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:function(e,t){return!0},supportedPermissionLevels:[],requiresFetchingSharingInformation:!1},{supportPreview:function(e,t){return!1}});case 6:return{supportDownload:!1,supportImageThumbnail:!0,supportPreview:function(e,t){return!1},supportedPermissionLevels:[],requiresFetchingSharingInformation:!1};case 5:return r.__assign({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:function(e,t){return!0},supportedPermissionLevels:[],requiresFetchingSharingInformation:!1},{supportDownload:!1,supportImageThumbnail:!1,supportPreview:function(e){return Object(a.a)(e)},supportedPermissionLevels:[4,3]});case 7:case 8:case 9:return r.__assign({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:function(e,t){return!0},supportedPermissionLevels:[],requiresFetchingSharingInformation:!1},{supportDownload:!1,supportPreview:function(e,t){return!1}});case 4:case 10:return{supportDownload:!1,supportImageThumbnail:!1,supportPreview:function(e,t){return!1},supportedPermissionLevels:[],requiresFetchingSharingInformation:!1};default:return Object(o.a)(e)}}),s=c.getDataProviderInfo;c.getDefaultDataProviderInfo;t.a=s},2461:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(56),i=n(2243);t.default=function(e,t){return void 0===e||e.__type||(e=i.default(e)),r.makeServiceRequest("GetAccessTokenforDataProvider",e,t)}},2482:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(0),i=n(2436),a=n(2504);function o(e){return r.__awaiter(this,void 0,void 0,function(){var t,n;return r.__generator(this,function(r){switch(r.label){case 0:return t=Object(a.a)(e.AttachLongPathName),[4,Object(i.l)(t)];case 1:return[2,(n=r.sent()).result&&n.result.thumbnailLink||null]}})})}},2485:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r=n(0),i=n(309),a=n(2482),o=n(1223);function c(e,t,n){return r.__awaiter(this,void 0,void 0,function(){var c;return r.__generator(this,function(r){switch(r.label){case 0:return n?(c=t).ProviderType===i.f&&c.AttachLongPathName?[4,Object(a.a)(c)]:[3,2]:[2,Object(o.a)(e,t,2,n,!0)];case 1:return[2,r.sent()];case 2:return[2,c.AttachmentThumbnailUrl||null]}})})}},2486:function(e,t,n){"use strict";function r(e,t,n){var r=e||(window&&window.navigator&&window.navigator.userAgent?window.navigator.userAgent:""),i=-1!==r.indexOf("MSIE")||-1!==r.indexOf("rv:")&&-1!==r.indexOf("Trident"),a=-1===r.indexOf("Edge")&&-1!==r.indexOf("Chrome"),o=-1!==r.indexOf("Firefox"),c=-1!==r.indexOf("Edge");return a?function(e){return(e=e||navigator&&navigator.plugins)&&"function"==typeof e.namedItem&&(null!==e.namedItem("Chrome PDF Viewer")||null!==e.namedItem("Microsoft Edge PDF Viewer"))}(n):i?function(e){try{return null!==e("AcroPDF.PDF")}catch(e){return!1}}(t||function(e){return new ActiveXObject(e)}):!o&&!c}n.d(t,"a",function(){return r})},2487:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(309),i=n(2457),a=n(893);function o(e,t,n){var o=e.level!==a.c.Block&&e.directFileAccessEnabled;return o&&t.__type===r.n&&(o=function(e,t){if(e.AttachLongPathName){var n=document.createElement("a");if(n.href=e.AttachLongPathName,n.host.indexOf(c,0)>0||n.search.indexOf(s,0)>0)return!1}if(r=e.ProviderType,a=Object(i.a)(r),a&&a.supportDownload&&!e.AttachmentIsFolder)return!function(e,t){return!(e||t&&"application/onenote"!==t&&"image/png"!==t)}(t,e.ContentType);var r,a;return!1}(t,n)),o}var c="safelinks.protection.outlook.com",s="b7780972f918485c8cfc32b1ba7438eb"},2488:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=["application/vnd.google-apps.document","application/vnd.google-apps.spreadsheet","application/vnd.google-apps.presentation"];function i(e){return!!e.ContentType&&r.indexOf(e.ContentType.toLowerCase())>-1}},2504:function(e,t,n){"use strict";function r(e){var t=e.indexOf("/d/");return e.substring(t+3,e.indexOf("/",t+3))}n.d(t,"a",function(){return r})},2616:function(e,t,n){"use strict";n.d(t,"c",function(){return a}),n.d(t,"b",function(){return o}),n.d(t,"a",function(){return c});var r=n(3),i=new r.c(function(){return Promise.all([n.e(6),n.e(7),n.e(9),n.e(10),n.e(125)]).then(n.bind(null,3408))}),a=Object(r.d)(i,function(e){return e.AttachmentThumbnailView}),o=Object(r.d)(i,function(e){return e.AttachmentIconView}),c=Object(r.d)(i,function(e){return e.AttachmentDocInfoView})},2707:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(1561),i=n(887);function a(e){if(e.__type===r.a.attachmentTypes.REFERENCE_ATTACHMENT_TYPE){var t=e;return{fileType:i.a.Cloud,name:t.Name,size:t.Size,providerId:"",providerType:4,location:t.AttachLongPathName,providerEndpointUrl:"",isFolder:!1,thumbnailUrl:t.AttachmentThumbnailUrl,previewUrl:t.AttachmentPreviewUrl,fileId:t.AttachmentId.Id,fileParentId:"",type:t.__type}}return{attachmentItemId:e.AttachmentId.Id,name:e.Name,size:e.Size,fileType:i.a.AttachmentItem,type:r.a.attachmentTypes.ITEM_ID_ATTACHMENT_TYPE}}},2946:function(e,t,n){var r=n(1028);e.exports=function(e,t){var n=r(e).getTime(),i=Number(t);return new Date(n+i)}},4170:function(e,t,n){"use strict";var r=n(0),i=n(254),a=n(1429),o=n(1106),c=n(1226);function s(e,t,n){return r.__awaiter(this,void 0,void 0,function(){var s,u;return r.__generator(this,function(r){switch(r.label){case 0:return(s=Object(a.a)(e))?Object(i.e)(s.model)?[4,c.e.import()]:[3,2]:[2];case 1:return r.sent()(s.model),[3,3];case 2:(u=s.download.url)&&Object(o.b)(u,t,n),r.label=3;case 3:return[2]}})})}var u=n(3),l=n(333);n.d(t,"c",function(){return f}),n.d(t,"d",function(){return p}),n.d(t,"a",function(){return l.c}),n.d(t,"b",function(){return s});var d=new u.c(function(){return Promise.all([n.e(6),n.e(7),n.e(9),n.e(10),n.e(125)]).then(n.bind(null,13914))}),f=new u.a(d,function(e){return e.clickAttachment}).importAndExecute,p=new u.a(d,function(e){return e.previewAttachment})},492:function(e,t,n){"use strict";function r(e){if(!e)return null;var t=e.lastIndexOf(".");return t>0?e.substr(t).toLowerCase():null}function i(e){var t=r(e);return t?t.replace(".",""):null}var a=n(1267),o=n(4);function c(e){var t;return e>=1073741824?(e/=1073741824,t=Object(o.a)(a.b)):e>=1048576?(e/=1048576,t=Object(o.a)(a.d)):e>=1024?(e/=1024,t=Object(o.a)(a.c)):t=Object(o.a)(a.a),Object(o.b)(t,Math.round(e))}function s(e){return e&&(t=e,(n=l.exec(t))&&n.length>1&&u[n[1].toLowerCase()]);var t,n}var u={"image/bmp":".bmp","image/x-ms-bmp":".bmp","image/gif":".gif","image/jpeg":".jpeg","image/png":".png","image/vnd.adobe.photoshop":".psd","image/tiff":".tiff"},l=/^\s*([^;\s]*)(?:;|\s|$)/;var d=n(77),f=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd"],p=[".tiff",".tif"];function m(e,t,n){void 0===n&&(n=!0);var i=r(e)||s(t);return!!i&&(f.indexOf(i.toLowerCase())>=0||n&&p.indexOf(i.toLowerCase())>=0&&(Object(d.d)()||Object(d.c)()||Object(d.g)()||Object(d.f)()&&!Object(d.i)()))}var h,v=n(6),b=[".pdf",".doc",".docx",".odt",".rtf",".ppt",".pptx",".pptm",".potx",".potm",".pot",".ppxx",".pps",".odp"];function g(e){if(!Object(v.e)("doc-attachment-documentThumbnail"))return!1;var t=r(e);return!!t&&b.indexOf(t.toLowerCase())>=0}function w(e){switch(e){case".doc":case".docm":case".docx":case".dot":case".dotm":case".dotx":case".odt":case".rtf":return h.Word;case".csv":case".ods":case".xls":case".xlsb":case".xlsm":case".xlsx":return h.Excel;case".odp":case".pot":case".potm":case".potx":case".pps":case".ppsm":case".ppsx":case".ppt":case".pptm":case".pptx":return h.PowerPoint;default:return null}}!function(e){e[e.Word=0]="Word",e[e.Excel=1]="Excel",e[e.PowerPoint=2]="PowerPoint"}(h||(h={})),n.d(t,"b",function(){return r}),n.d(t,"c",function(){return i}),n.d(t,"g",function(){return c}),n.d(t,"e",function(){return m}),n.d(t,"f",function(){return g}),n.d(t,"d",function(){return w}),n.d(t,"a",function(){return h})},518:function(e,t,n){"use strict";var r,i,a;n.d(t,"c",function(){return r}),n.d(t,"b",function(){return i}),n.d(t,"a",function(){return a}),function(e){e[e.Compose=0]="Compose",e[e.Extensibility=1]="Extensibility",e[e.ReadingPane=2]="ReadingPane",e[e.Fileshub=3]="Fileshub",e[e.Txp=4]="Txp"}(r||(r={})),function(e){e[e.SmimeSignature=0]="SmimeSignature",e[e.Safety=1]="Safety",e[e.Error=2]="Error",e[e.Info=3]="Info",e[e.Encryption=4]="Encryption",e[e.Translation=5]="Translation",e[e.Sensitivity=6]="Sensitivity"}(i||(i={})),function(e){e[e.Grey=0]="Grey",e[e.Red=1]="Red",e[e.Green=2]="Green",e[e.Yellow=3]="Yellow",e[e.Orange=4]="Orange",e[e.Green20=5]="Green20"}(a||(a={}))},691:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return a});var r=n(956);function i(e){return o(e.type)}function a(e){return o(Object(r.a)(e))}function o(e){return 1===e||3===e}},7572:function(e,t,n){var r=n(11016),i=n(31);"string"==typeof r&&(r=[[e.i,r]]);for(var a=0;a<r.length;a++)i.loadStyles(r[a][1],!1);r.locals&&(e.exports=r.locals)},887:function(e,t,n){"use strict";var r;n.d(t,"a",function(){return r}),function(e){e[e.Base64InlineImage=0]="Base64InlineImage",e[e.Cloud=1]="Cloud",e[e.Local=2]="Local",e[e.MailItem=3]="MailItem",e[e.Uri=4]="Uri",e[e.AttachmentItem=5]="AttachmentItem",e[e.CloudSuggestion=6]="CloudSuggestion",e[e.AttachmentItemSuggestion=7]="AttachmentItemSuggestion",e[e.Inline=8]="Inline",e[e.Smime=9]="Smime",e[e.FilesHub=10]="FilesHub",e[e.GroupFilesHub=11]="GroupFilesHub",e[e.MailSearchFileSuggestion=12]="MailSearchFileSuggestion",e[e.Unknown=13]="Unknown",e[e.ContextualSuggestion=14]="ContextualSuggestion"}(r||(r={}))},893:function(e,t,n){"use strict";var r;!function(e){e.InfoRestrictedAccess="infoRestrictedAccess"}(r||(r={}));var i=n(75);function a(e){switch(e){case 0:return r.InfoRestrictedAccess;default:return Object(i.a)(e)}}var o=n(10);function c(e){switch(e){case 0:return(t=Object(o.a)().AttachmentPolicy).ConditionalAccessDirectFileAccessOnPrivateComputersBlocked||t.ConditionalAccessDirectFileAccessOnPublicComputersBlocked||t.ConditionalAccessPrintWithoutDownloadBlocked||t.ConditionalAccessWacViewingOnPrivateComputersBlocked||t.ConditionalAccessWacViewingOnPublicComputersBlocked;default:return Object(i.a)(e)}var t}var s=[0],u=n(1561);function l(){return s.filter(c)}function d(e){return e&&e.length>0&&function(e){return e.some(function(e){return!((t=e).IsInline&&!function(e){return e.__type===u.a.attachmentTypes.REFERENCE_ATTACHMENT_TYPE}(t));var t})}(e)?s.filter(c):[]}var f=n(1677),p=n(4),m=n(518);function h(e){switch(e){case r.InfoRestrictedAccess:return{key:"access_control_info_bar",source:m.c.Compose,rank:m.b.Error,messageParts:[Object(p.a)(f.b),(t="https://docs.microsoft.com/en-us/intune-user-help/use-managed-devices-to-get-work-done",{text:Object(p.a)(f.a),action:function(){window.open(t,"_blank")}})],color:m.a.Red};default:return Object(i.a)(e)}var t}var v,b=n(492);!function(e){e[e.Undefined=0]="Undefined",e[e.Block=1]="Block",e[e.ForceSave=2]="ForceSave",e[e.Allow=3]="Allow",e[e.ConditionalAccess=4]="ConditionalAccess"}(v||(v={}));var g=function(){function e(e,t){this.attachmentPolicy=e,this.shouldTreatAsPublicLogon=t,this.shouldTreatAsPublicLogon?this.directFileAccessEnabled=this.attachmentPolicy.DirectFileAccessOnPublicComputersEnabled:this.directFileAccessEnabled=this.attachmentPolicy.DirectFileAccessOnPrivateComputersEnabled,this.saveAttachmentsToCloudEnabled=this.attachmentPolicy.AttachmentDataProviderAvailable&&this.attachmentPolicy.SaveAttachmentsToCloudEnabled,this.convertClassicToCloudyEnabled=this.attachmentPolicy.AttachmentDataProviderAvailable&&this.attachmentPolicy.ReferenceAttachmentsEnabled,this.convertCloudyToClassicEnabled=this.attachmentPolicy.AttachmentDataProviderAvailable&&this.attachmentPolicy.ClassicAttachmentsEnabled,this.fileTypeToPolicyMap=this.createPolicyMap(this.attachmentPolicy.BlockedFileTypes,this.attachmentPolicy.ForceSaveFileTypes,this.attachmentPolicy.AllowedFileTypes),this.mimeTypeToPolicyMap=this.createPolicyMap(this.attachmentPolicy.BlockedMimeTypes,this.attachmentPolicy.ForceSaveMimeTypes,this.attachmentPolicy.AllowedMimeTypes),this.policyForUnknownTypes=v[this.attachmentPolicy.ActionForUnknownFileAndMIMETypes],this.printWithoutDownloadEnabled=this.attachmentPolicy.PrintWithoutDownloadEnabled}return e.prototype.getPolicyInfo=function(e,t,n,r){e&&(e=e.toLowerCase());var i=this.getFileAccessLevel(e,t),a=!1,o=!1,c=!1,s="ReferenceAttachment:#Exchange"===r;return i!==v.Block&&n&&(this.isWacViewingEnabled(e)&&(a=!0),!this.directFileAccessEnabled&&s&&(a=!1),o=this.isForceBrowserViewingFirst(a),a&&null!=this.attachmentPolicy.WacEditableFileTypes&&null!=e&&(c="FileAttachment:#Exchange"===r?this.attachmentPolicy.WacEditableFileTypes.indexOf(e)>=0||this.attachmentPolicy.WacConvertibleFileTypes.indexOf(e)>=0:this.attachmentPolicy.WacEditableFileTypes.indexOf(e)>=0&&-1===this.attachmentPolicy.WacConvertibleFileTypes.indexOf(e)),a||this.directFileAccessEnabled||(i=v.ConditionalAccess)),{directFileAccessEnabled:this.directFileAccessEnabled,level:i,useWac:a,forceBrowserViewingFirst:o,wacEdit:c}},e.prototype.isPdfPreviewEnabled=function(){return this.shouldTreatAsPublicLogon?this.attachmentPolicy.WacViewingOnPublicComputersEnabled||this.attachmentPolicy.DirectFileAccessOnPublicComputersEnabled:this.attachmentPolicy.WacViewingOnPrivateComputersEnabled||this.attachmentPolicy.DirectFileAccessOnPrivateComputersEnabled},e.prototype.getFileAccessLevel=function(e,t){var n=this.fileTypeToPolicyMap[e];if(n||(n=v.Undefined),n===v.Block)return v.Block;var r=this.mimeTypeToPolicyMap[t];return r===v.Block?v.Block:n===v.ForceSave||r===v.ForceSave?v.ForceSave:n===v.Allow||r===v.Allow?v.Allow:this.policyForUnknownTypes},e.prototype.isWacViewingEnabled=function(e){return(this.shouldTreatAsPublicLogon?this.attachmentPolicy.WacViewingOnPublicComputersEnabled:this.attachmentPolicy.WacViewingOnPrivateComputersEnabled)&&this.attachmentPolicy.WacViewableFileTypes.indexOf(e)>=0},e.prototype.isForceBrowserViewingFirst=function(e){return!!e&&(this.shouldTreatAsPublicLogon?this.attachmentPolicy.ForceWacViewingFirstOnPublicComputers:this.attachmentPolicy.ForceWacViewingFirstOnPrivateComputers)},e.prototype.addPolicyIntoMap=function(e,t,n){t&&t.forEach(function(t){e[t]=n})},e.prototype.createPolicyMap=function(e,t,n){var r={};return this.addPolicyIntoMap(r,n,v.Allow),this.addPolicyIntoMap(r,t,v.ForceSave),this.addPolicyIntoMap(r,e,v.Block),r},e}(),w=null,x=null;function O(){if(!w){var e=Object(o.a)(),t=e.AttachmentPolicy,n=e.SessionSettings.IsPublicLogon||e.PublicComputersDetectionEnabled&&e.SessionSettings.IsPublicComputerSession;w=new g(t,n),n&&(x=w)}return w}function P(e,t){var n=Object(b.b)(e.Name),r=e.ContentType;return O().getPolicyInfo(n,r,t,e.__type)}function y(e,t){var n=Object(b.b)(e.Name),r=e.ContentType;return function(){if(!x){var e=Object(o.a)();if(e.SessionSettings.IsPublicLogon||e.PublicComputersDetectionEnabled&&e.SessionSettings.IsPublicComputerSession)return O();x=new g(e.AttachmentPolicy,!0)}return x}().getPolicyInfo(n,r,t,e.__type)}function I(e,t,n,r){if(r)return!1;var i=P(e,!0),a=O();return i.level!==v.Block&&a.saveAttachmentsToCloudEnabled&&!t&&n}n.d(t,"a",function(){return s}),n.d(t,"i",function(){return h}),n.d(t,"b",function(){return r}),n.d(t,"d",function(){return l}),n.d(t,"e",function(){return d}),n.d(t,"h",function(){return a}),n.d(t,"j",function(){return I}),n.d(t,"c",function(){return v}),n.d(t,"f",function(){return P}),n.d(t,"g",function(){return y}),n.d(t,"k",function(){return O})},985:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(1398);n.d(t,"c",function(){return r.a});var i=n(2447);n.d(t,"d",function(){return i.a});var a=n(1122);n.d(t,"e",function(){return a.a}),n.d(t,"b",function(){return a.b});var o=n(3),c=new o.c(function(){return n.e(223).then(n.bind(null,3381))}),s=Object(o.d)(c,function(e){return e.CloudIconWithOverlay})}},0,[5,15,40,85,344,6,7,9,10,125,0,1,526,178,12,47,121,514,105,525,174,24,116,223,312]]);
//# sourceMappingURL=owa.AttachmentsCompact.js.map
self.scriptsLoaded['owa.AttachmentsCompact.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.AttachmentsCompact.js'] = (new Date()).getTime();