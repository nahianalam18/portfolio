self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.625.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[625],{1026:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var i=n(648);function o(e){return Object(i.a)().options[e]}},1041:function(e,t,n){"use strict";var i;n.d(t,"a",function(){return i}),function(e){e[e.OptionsNotLoaded=0]="OptionsNotLoaded",e[e.OptionsLoading=1]="OptionsLoading",e[e.OptionsLoaded=2]="OptionsLoaded"}(i||(i={}))},1042:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var i=n(2),o=n(646),r=Object(i.action)("APPLY_DEFAULT_OPTIONS_ON_LOAD_FAIL",function(e){return void 0===e&&(e=Object(o.a)()),{defaultOptions:e}})},1309:function(e,t,n){"use strict";function i(e,t){return e+"_"+(null!=t.enabledTimeInUTCMs?t.enabledTimeInUTCMs:"")}n.d(t,"a",function(){return i})},1311:function(e,t,n){"use strict";var i=n(353);function o(){return new Date}var r=n(8);function a(e,t){if(null!=e.localStorage)return e.localStorage.removeItem(t)}var s="WebPushUserSettings",u=5;function c(e,t){for(var n=d(e),i=-1,o=0;o<n.length;++o)if(n[o].userPreferenceIdentifier==t.userPreferenceIdentifier){i=o;break}if(i>=0)n[i]=t;else{if(i=n.length,n.length>=u){i=0;var r=new Date(n[0].lastSessionDate);for(o=1;o<n.length;++o){var a=new Date(n[o].lastSessionDate);a.getTime()<r.getTime()&&(r=a,i=o)}}n[i]=t}l(e,n)}function d(e){var t=function(e,t){return null!=e.localStorage?e.localStorage.getItem(t):null}(e,s),n=new Array;try{var i=JSON.parse(t);null!=i&&(n=i)}catch(t){a(e,s)}return n}function l(e,t){if(t.length>0){var n=JSON.stringify(t);!function(e,t,n){if(null!=e.localStorage)try{e.localStorage.setItem(t,n)}catch(e){}}(e,s,n)}else a(e,s)}n.d(t,"d",function(){return f}),n.d(t,"c",function(){return b}),n.d(t,"a",function(){return p}),n.d(t,"g",function(){return S}),n.d(t,"f",function(){return g}),n.d(t,"b",function(){return O}),n.d(t,"e",function(){return w});var f=Object(r.select)({store:function(){return i.b}})(Object(r.action)("loadLocalWebPushUserSetting")(function(e,t,n){var i=function(e,t){for(var n=d(e),i=null,o=0;o<n.length;++o)if(n[o].userPreferenceIdentifier==t){i=n[o];break}return i}(e,t);null!=i?Object.keys(i).forEach(function(e){n.store[e]=i[e]}):n.store.userPreferenceIdentifier=t})),b=Object(r.select)({store:function(){return i.b}})(Object(r.action)("incrementUniqueDaysSessionCount")(function(e,t){var n=o().toDateString();t.store.lastSessionDate!=n&&(t.store.lastSessionDate=n,t.store.uniqueDaysSessionCount<4&&t.store.uniqueDaysSessionCount++,c(e,t.store))})),p=Object(r.select)({store:function(){return i.b}})(Object(r.action)("cleanupLocalWebpushUserSetting")(function(e,t,n){!function(e,t){for(var n=d(e),i=-1,o=0;o<n.length;++o)if(n[o].userPreferenceIdentifier==t){i=o;break}-1!=i&&(n.splice(i,1),l(e,n))}(e,n.store.userPreferenceIdentifier),n.store.userPreferenceIdentifier=t})),S=Object(r.select)({store:function(){return i.b}})(Object(r.action)("updateLocalWebPushEnabledStatus")(function(e,t,n,i){i.store.enabled=t,i.store.userPreferenceIdentifier=n,c(e,i.store)})),g=Object(r.select)({store:function(){return i.b}})(function(e,t){return null!=t.store&&null==t.store.enabled&&t.store.uniqueDaysSessionCount>=4&&t.store.lastPromptDate!=o().toDateString()&&t.store.promptCount<=3}),O=Object(r.select)({store:function(){return i.b}})(Object(r.action)("incrementLocalWebPushPromptCount")(function(e,t){t.store.promptCount++,t.store.lastPromptDate=o().toDateString(),c(e,t.store)})),w=Object(r.select)({store:function(){return i.b}})(Object(r.action)("resetLocalWebPushPromptCount")(function(e,t){t.store.promptCount=0,t.store.lastPromptDate=null,c(e,t.store)}))},1358:function(e,t,n){"use strict";n.d(t,"a",function(){return d});var i=n(0),o=n(10),r=n(8),a=n(6),s=n(570),u=n(226),c=n(11),d=Object(r.action)("signout")(function(e){return i.__awaiter(this,void 0,void 0,function(){var t,n;return i.__generator(this,function(i){switch(i.label){case 0:if(!Object(a.e)("fwk-webPushNotification")||!Object(a.e)("fwk-webPushNotificationSignout"))return[3,6];i.label=1;case 1:return i.trys.push([1,5,,6]),null==(t=Object(u.c)(u.a.WebPushNotifications))||t.enabled?[4,s.f.import()]:[3,4];case 2:return[4,i.sent()(window)];case 3:i.sent(),i.label=4;case 4:return[3,6];case 5:return n=i.sent(),c.d.error("[WebPush] Failed to unsubscribe on signout, error: "+n),[3,6];case 6:return Object(o.a)().ApplicationSettings.CloseWindowOnLogout,"sessionStorage"in window&&window.sessionStorage&&window.sessionStorage.clear(),e.assign("/owa/logoff.owa"),[2]}})})})},2012:function(e,t,n){"use strict";n.r(t);n(10228);var i,o=n(10),r=n(426),a=n(188),s=n(92),u=n(1358),c=n(18),d=n(25);!function(e){e[e.Aad=1]="Aad",e[e.Msa=2]="Msa"}(i||(i={}));var l,f=n(15);function b(){switch(Object(f.j)()){case"WW":case"FirstRelease":case"Microsoft":case"Dogfood":default:return l.WorldWide}}!function(e){e[e.WorldWide=1]="WorldWide",e[e.Trailblazer=4]="Trailblazer",e[e.Pathfinder=5]="Pathfinder"}(l||(l={}));var p=n(6),S=n(53),g="abtSignOutEventForHost",O="abtInitializeResult",w="OWA",v=500,m=Object(s.a)(),A=0;function P(e){if(e.data&&""!==e.data&&e.origin===Object(S.n)()){var t=JSON.parse(e.data);t.eventId&&(t.eventId===g?(Object(c.o)("ActivityTimeout::Signout",{sessionId:m}),Object(u.a)(location)):t.eventId===O&&t.detail&&t.detail.initializeResult&&("false"===t.detail.initializeResult?Object(a.a)(v).then(function(){A<3&&(Object(c.o)("ActivityTimeout::RetryingIntialized",{attempt:A,sessionId:m,failureMessage:t.detail.initializeMessage}),j())}):Object(c.o)("ActivityTimeout::Initialized",{sessionId:m})))}}function j(){var e={market:Object(o.a)().SessionSettings.UserCulture,environment:b(),userId:Object(o.a)().SessionSettings.UserPuid,authType:Object(d.o)()?i.Aad:i.Msa,timeout:Object(o.a)().PolicySettings.SharedActivityBasedTimeout,trackEvents:!0,enableLogging:!0,workloadName:w,tenantId:Object(o.a)().SessionSettings.TenantGuid,sessionId:m,signinState:Object(o.a)().PolicySettings.SignInState};Object(c.o)("ActivityTimeout::Initializing",{authType:e.authType,timeout:e.timeout,sessionId:m}),A++,window.AbtInteraction.AbtInitialize(e)}function h(e){Promise.all([n.e(0),n.e(1),n.e(610)]).then(n.t.bind(null,13594,7)).then(function(t){e&&e()})}function I(){Object(r.a)()&&Object(p.e)("auth-sharedActivityBasedTimeout")&&Object(o.a)().PolicySettings.IsSharedActivityBasedTimeoutEnabled&&(window.LoadAbtPromptJs={Download:h},window.addEventListener("message",P,!1),j())}n.d(t,"registerAndInitializeSharedABT",function(){return I})},226:function(e,t,n){"use strict";var i=n(39),o=(function(){}(),n(3)),r=n(22),a=n(1042),s=n(648),u=n(7),c=n(2),d=[i.a.SurfaceActions];Object(c.mutator)(a.a,function(e){var t=e.defaultOptions;d.forEach(function(e){t[e]&&Object(u.extendObservable)(Object(s.a)().options[e],t[e])})});var l=n(1026),f=n(646);n.d(t,"d",function(){return p}),n.d(t,"g",function(){return S}),n.d(t,"e",function(){return g}),n.d(t,"f",function(){return O}),n.d(t,"c",function(){return l.a}),n.d(t,"b",function(){return f.a}),n.d(t,"a",function(){return i.a});var b=new o.c(function(){return n.e(345).then(n.bind(null,13799))}),p=new o.a(b,function(e){return e.createOrUpdateOptionsForFeature}),S=new o.a(b,function(e){return e.updateAddinPinStatus}),g=new o.b(b,function(e){return e.getServerOptionsForFeature}),O=new o.a(b,function(e){return e.loadOptions});Object(r.c)(function(){O.importAndExecute()})},353:function(e,t,n){"use strict";n.d(t,"c",function(){return o}),n.d(t,"b",function(){return r}),n.d(t,"a",function(){return a});var i=n(2),o=Object(i.createStore)("webPushStore",{currentView:0,webPushPermission:window.Notification&&window.Notification.permission})(),r=Object(i.createStore)("localWebPushUserSettingStore",{userPreferenceIdentifier:null,lastSessionDate:null,uniqueDaysSessionCount:0,enabled:null,promptCount:0,lastPromptDate:null})();function a(){return r}},39:function(e,t,n){"use strict";var i;n.d(t,"a",function(){return i}),function(e){e[e.TestFeature=1]="TestFeature",e[e.SmartSuggestions=2]="SmartSuggestions",e[e.DiverseEmojis=4]="DiverseEmojis",e[e.SurfaceActions=5]="SurfaceActions",e[e.SkypeNotifications=6]="SkypeNotifications",e[e.WebPushNotifications=7]="WebPushNotifications",e[e.Confetti=8]="Confetti",e[e.GdprAdsPrefs=9]="GdprAdsPrefs",e[e.CalendarSurfaceAddins=10]="CalendarSurfaceAddins",e[e.ExternalImages=11]="ExternalImages",e[e.EventCapture=12]="EventCapture",e[e.LinkedInBindingDismissed=13]="LinkedInBindingDismissed",e[e.Translation=14]="Translation",e[e.CalendarSurfaceOptions=15]="CalendarSurfaceOptions",e[e.TxpEventNotifications=16]="TxpEventNotifications",e[e.MentionEventNotifications=17]="MentionEventNotifications",e[e.ComposeAssistance=18]="ComposeAssistance",e[e.ActivityFeed=19]="ActivityFeed",e[e.AmpDeveloper=20]="AmpDeveloper"}(i||(i={}))},570:function(e,t,n){"use strict";n.d(t,"h",function(){return f}),n.d(t,"g",function(){return b}),n.d(t,"f",function(){return p}),n.d(t,"e",function(){return S}),n.d(t,"a",function(){return g});var i=n(988);n.d(t,"d",function(){return i.a});var o=n(3),r=n(22),a=n(1311);n.d(t,"i",function(){return a.d});var s=n(353);n.d(t,"b",function(){return s.a});var u=n(1309);n.d(t,"c",function(){return u.a});var c=n(838);n.d(t,"k",function(){return c.b}),n.d(t,"j",function(){return c.a}),n.d(t,"l",function(){return c.f});var d=new o.c(function(){return Promise.all([n.e(0),n.e(1),n.e(583),n.e(458)]).then(n.bind(null,2330))}),l=new o.a(d,function(e){return e.bootStrapWebPushService}),f=new o.b(d,function(e){return e.userInitiatedWebPushSetupWorkflow}),b=new o.b(d,function(e){return e.userInitiatedWebPushDisableWorkflow}),p=new o.b(d,function(e){return e.unsubscribe}),S=(new o.b(d,function(e){return e.shouldShowWebPushLightning}),new o.b(d,function(e){return e.loadWebPushOptions})),g=Object(o.d)(d,function(e){return e.WebPushDiscovery});Object(r.c)(function(){Object(i.a)(window)&&l.importAndExecute(window)})},646:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var i=n(44),o=n(39),r=n(6);function a(){var e;return(e={})[o.a.SmartSuggestions]={smartSuggestionsEnabled:!0,browserLocationEnabled:!1},e[o.a.DiverseEmojis]={diverseEmojisSelectedSkinTone:""},e[o.a.SurfaceActions]={readSurfaceActions:["Reply","ReplyAll","Forward"].concat(Object(i.a)()?[]:["LikeUnlike"]),readSurfaceAddins:[],composeSurfaceActions:["AddAttachment","AddInlineImage","AddEmoji","ToggleDictation","ToggleRibbon"],composeSurfaceAddins:[]},e[o.a.SkypeNotifications]={skypeMessageNotification:1,skypeCallingNotification:1},e[o.a.Confetti]={confettiEnabled:!0},e[o.a.ComposeAssistance]={composeAssistanceEnabled:!0},e[o.a.GdprAdsPrefs]={feature:o.a.GdprAdsPrefs,consentString:null,allowStorageAndAccess:!1,allowPersonalization:!1,allowAdSelectionDeliveryReporting:!1,allowContentSelectionDeliveryReporting:!1,allowMeasurement:!1},e[o.a.CalendarSurfaceAddins]={calendarSurfaceAddins:[]},e[o.a.ExternalImages]={externalImagesSelectedOption:0},e[o.a.EventCapture]={autoCollectionEnabled:!1},e[o.a.LinkedInBindingDismissed]={linkedInBindingDismissedInPeoplePicker:!1},e[o.a.Translation]={translationMode:0,excludedLanguages:[]},e[o.a.CalendarSurfaceOptions]={agendaPaneIsClosed:!1},e[o.a.AmpDeveloper]={enabled:Object(r.e)("rp-ampDefault"),allowedSender:[]},e}},648:function(e,t,n){"use strict";var i,o=n(39),r=n(1041),a=n(2);t.a=Object(a.createStore)("owsOptionsStore",{options:(i={},i[o.a.SmartSuggestions]={feature:o.a.SmartSuggestions,smartSuggestionsEnabled:!1,browserLocationEnabled:!1},i[o.a.DiverseEmojis]={feature:o.a.DiverseEmojis,diverseEmojisSelectedSkinTone:""},i[o.a.SurfaceActions]={feature:o.a.SurfaceActions,readSurfaceActions:[],readSurfaceAddins:[],composeSurfaceActions:[],composeSurfaceAddins:[]},i[o.a.SkypeNotifications]={feature:o.a.SkypeNotifications,skypeMessageNotification:1,skypeCallingNotification:1},i[o.a.WebPushNotifications]={feature:o.a.WebPushNotifications,enabled:!1,applicationServerKey:null},i[o.a.Confetti]={feature:o.a.Confetti,confettiEnabled:!1},i[o.a.GdprAdsPrefs]={feature:o.a.GdprAdsPrefs,consentString:null,allowStorageAndAccess:!1,allowPersonalization:!1,allowAdSelectionDeliveryReporting:!1,allowContentSelectionDeliveryReporting:!1,allowMeasurement:!1},i[o.a.CalendarSurfaceAddins]={feature:o.a.CalendarSurfaceAddins,calendarSurfaceAddins:[]},i[o.a.ExternalImages]={feature:o.a.ExternalImages,externalImagesSelectedOption:null},i[o.a.EventCapture]={autoCollectionEnabled:!1},i[o.a.LinkedInBindingDismissed]={linkedInBindingDismissedInPeoplePicker:!1},i[o.a.Translation]={feature:o.a.Translation,translationMode:0,excludedLanguages:[]},i[o.a.CalendarSurfaceOptions]={feature:o.a.CalendarSurfaceOptions,agendaPaneIsClosed:!0},i[o.a.MentionEventNotifications]={feature:o.a.MentionEventNotifications,enabled:!1},i[o.a.TxpEventNotifications]={feature:o.a.TxpEventNotifications,enabled:!1},i[o.a.ComposeAssistance]={feature:o.a.ComposeAssistance,composeAssistanceEnabled:!1},i[o.a.AmpDeveloper]={feature:o.a.AmpDeveloper,enabled:!0,allowedSender:[]},i[o.a.ActivityFeed]={feature:o.a.ActivityFeed,OWASurfaceOptions:{SupportedTypes:[],DisabledInFeedPanel:[]}},i),loadState:r.a.OptionsNotLoaded})},838:function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"a",function(){return a}),n.d(t,"f",function(){return s}),n.d(t,"c",function(){return u}),n.d(t,"d",function(){return c}),n.d(t,"e",function(){return d});var i=n(18),o="WebPushSetup";function r(e){f("enabled",e)}function a(e,t){f("disabled",e),f("allClients",t)}function s(e){(window.webPushOptics.enabled||window.webPushOptics.disabled)&&(f("result",e),l())}function u(){f("lightning","ignored"),l()}function c(e){f("permission",e)}function d(e){f("roaming",e)}function l(){Object(i.o)(o,window.webPushOptics,{isCore:!0}),window.webPushOptics={}}function f(e,t){window.webPushOptics[e]=t}window.webPushOptics={}},988:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var i=n(6),o=n(125),r=n(10),a=n(392),s=function(e){return(Object(i.e)("fwk-webPushNotification")||Object(i.e)("fwk-webPushNotificationV2"))&&e.navigator&&null!=e.navigator.serviceWorker&&null!=e.PushManager&&(Object(o.j)()||Object(o.l)())&&(Object(o.d)()||Object(o.g)())&&!Object(r.a)().SessionSettings.IsUserCultureRightToLeft&&1==Object(a.b)()}}},0,[0,1,583,458,514,105,24,116]]);
//# sourceMappingURL=owa.625.js.map
self.scriptsLoaded['owa.625.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.625.js'] = (new Date()).getTime();