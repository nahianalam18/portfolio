self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailSmartPill.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[324],{1261:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return i}),n.d(t,"c",function(){return o});var r=n(2),a=Object(r.createStore)("UserVoiceNpsStore",{npsSurveyBody:"",npsSurveyRatings:"",isRatingSelected:!1,isSent:!1}),i=Object(r.createStore)("UserVoiceSuggestionStore",{message:"",isMessageEnabled:!1,isSent:!1,customFields:[]})(),o=Object(r.createStore)("userVoiceTrendingIdeasStore",{suggestions:[],pagination:{page:0,per_page:0,total_pages:0,total_records:0}})},1271:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(2),a=Object(r.action)("DEACTIVATE_HELP_CHARM")},12845:function(e){e.exports={a:"pRb"}},12846:function(e){e.exports={a:"nRb",b:"oRb"}},12847:function(e){e.exports={l:"bRb",f:"cRb",a:"dRb",b:"eRb",c:"fRb",d:"gRb",e:"hRb",g:"iRb",h:"jRb",i:"kRb",j:"lRb",k:"mRb"}},12848:function(e,t,n){var r=n(12849),a=n(31);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},12849:function(e,t,n){(t=e.exports=n(30)(!1)).push([e.i,"html[dir] ._1BIi6rH1j5rnLh1OlF1NvI{padding-top:10px}html[dir=ltr] ._1BIi6rH1j5rnLh1OlF1NvI{margin-left:52px}html[dir=rtl] ._1BIi6rH1j5rnLh1OlF1NvI{margin-right:52px}",""]),t.locals={bar:"_1BIi6rH1j5rnLh1OlF1NvI"}},1319:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("SHOW_QUICK_OPTIONS",function(){return{}})},1322:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(2),a=Object(r.action)("openPremiumDashboard")},1339:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(2),a=Object(r.action)("contactSupport")},1343:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(2),a=Object(r.createStore)("whatsNewStore",{cards:null})},1347:function(e,t,n){"use strict";var r;n.d(t,"a",function(){return r}),function(e){e.Read="Read",e.Unread="Unread"}(r||(r={}))},1349:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(2),a=Object(r.action)("TRY_TODO_PANEL")},13655:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(2),i=Object(a.action)("setSmartPillBlockVisibility",function(e,t){return{viewState:e,smartPillBlockVisible:t}}),o=Object(a.action)("setSmartPillFeedbackSubmitted",function(e,t){return{item:e,smartPillFeedbackSubmitted:t}}),u=n(6),c=n(11),s=n(856),l=n(843);function d(e){var t=e.featureName;if("SmartReply"===t)return Object(u.e)("mc-smartReply");if("SmartTime"===t)return Object(u.e)("mc-smartReplyWithCustomMeeting");if("SmartDoc"===t)return Object(u.e)("mc-smartReplyWithDoc");if("SmartTodo"===t||"SmartReminder"===t){var n=Object(l.a)()||Object(s.a)();return n||c.d.info("[isPillTypeEnabled] Disable Smart Todo - Todo/Time panel is unavailable."),Object(u.e)("mc-smartTask")&&n}return c.d.info("[isPillTypeEnabled] Unknown pill type: "+t),!1}function m(e){switch(e.logData.mainPayload.language){case"English":return!0;case"Spanish":return Object(u.e)("mc-smartReplySpanishMexico");default:return!1}}function f(e){if(e){if("SmartDoc"===e.featureName)return!0;null==e.confidenceScore&&c.d.info("[isConfidenceScoreAcceptable] confidence score is null. Feature: "+e.featureName+" EntityId: "+e.logData.mainPayload.EID);var t=e.confidenceScore;if(t>0){if(Object(u.e)("mc-smartPillConfidenceLevel_LOW"))return!0;if(Object(u.e)("mc-smartPillConfidenceLevel_MID"))switch(e.featureName){case"SmartTime":case"SmartTask":return t>=70;default:return!0}else switch(e.featureName){case"SmartTime":case"SmartTask":return t>=90;default:return!0}}}return!1}var g=1,p=2,b=3;function S(){var e=Object(u.e)("mc-smartReplyWithTextPositionThird");return[{aggregation:{SmartDoc:3},arrangement:["SmartDoc"]},{aggregation:{SmartReply:2,SmartTime:1},arrangement:e?["SmartTime","SmartReply"]:["SmartReply","SmartTime"]},{aggregation:{SmartReply:1,SmartTodo:1,SmartReminder:1},arrangement:e?["SmartTodo","SmartReminder","SmartReply"]:["SmartReply","SmartTodo","SmartReminder"]},{aggregation:{SmartTodo:1,SmartReminder:1},arrangement:["SmartTodo","SmartReminder"]},{aggregation:{SmartTime:1},arrangement:["SmartTime"]},{aggregation:{SmartReply:2,SmartTodo:1},arrangement:e?["SmartTodo","SmartReply"]:["SmartReply","SmartTodo"]},{aggregation:{SmartTodo:1},arrangement:["SmartTodo"]},{aggregation:{SmartReply:3},arrangement:["SmartReply"]}]}function h(e){if(e)for(var t=function(e){var t,n,a={};try{for(var i=r.__values(e),o=i.next();!o.done;o=i.next()){var u=o.value;a[u.featureName]=void 0===a[u.featureName]?1:a[u.featureName]+1}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return a}(e),n=S(),a=0;a<n.length;a++){for(var i=!0,o=n[a],u=0;u<o.arrangement.length;u++){if(o.aggregation[o.arrangement[u]]>(void 0===t[o.arrangement[u]]?0:t[o.arrangement[u]])){i=!1;break}}if(i)return o}return null}var v={selectPills:function(e){return function(e,t){var n=[];return t&&e.length>0&&t.arrangement.forEach(function(a){n.push.apply(n,r.__spread(function(e,t,n){return e.filter(function(e){return e.featureName===t}).slice(0,n)}(e,a,t.aggregation[a])))}),n}(e,h(e))}};function y(e,t,n,r){var a=[];return e.forEach(function(e){n(e)?a.push(e):(e.logData.mainPayload.renderStory|=r,t.push(e))}),a}var O={arbitratePills:function(e){var t=[],n=[];if(e){var a=y(e,n,d,1),i=y(a,n,m,8),o=y(i,n,f,4);if(o.length>0){if(Object(u.e)("mc-smartPillsRenderingStrategiesV2")){var c=v;t.push.apply(t,r.__spread(c.selectPills(o)))}else{var s=function(e){if(e){var t=e.some(function(e){return"SmartTime"===e.featureName}),n=e.some(function(e){return"SmartReply"===e.featureName}),r=e.some(function(e){return"SmartDoc"===e.featureName}),a=e.some(function(e){return"SmartTodo"===e.featureName}),i=e.some(function(e){return"SmartReminder"===e.featureName});if(r)return{smartDoc:{numOfPills:b}};if(t&&n)return{smartTime:{numOfPills:g},smartReply:{numOfPills:p}};if(a&&i&&n)return{smartReply:{numOfPills:g},smartReminder:{numOfPills:g},smartTodo:{numOfPills:g}};if(a&&n)return{smartTodo:{numOfPills:g},smartReply:{numOfPills:p}};if(a&&i)return{smartReminder:{numOfPills:g},smartTodo:{numOfPills:g}};if(a)return{smartTodo:{numOfPills:g}};if(t)return{smartTime:{numOfPills:g}};if(n)return{smartReply:{numOfPills:b}}}return null}(o);if(s)new Map([["SmartDoc",s.smartDoc],["SmartReply",s.smartReply],["SmartTime",s.smartTime],["SmartTodo",s.smartTodo],["SmartReminder",s.smartReminder]]).forEach(function(e,n){var a,i;e&&t.push.apply(t,r.__spread((a=n,i=e,o.filter(function(e){return e.featureName===a}).slice(0,i.numOfPills))))})}for(var l=function(e){var r=o[e];t.some(function(e){return e===r})||(r.logData.mainPayload.renderStory|=2,n.push(r))},S=0;S<o.length;S++)l(S)}}return{pillsToShow:t,pillsToHide:n,arbitratorId:"complexArbitrator"}}};var P=3;function j(e,t){void 0===t&&(t=P);var n=[],r=null;if(e)for(var a=Object.keys(e),i=0;i<a.length;i++)for(var o=e[a[i]],u=0;u<o.length;u++)if(r=o&&o[u]){if(!(n.length<t))return n;n.push(r)}else c.d.info("[extractAttachmentSuggestions] ReplyWithAttachmentSuggestion is null");return n}var T="EntityExtraction/SubstrateSearchSuggestions",I="EntityExtraction/ReplyWithQueryCoverage";var R=n(65),w="/ows/search/api/v1/";function _(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,a,i,o=this;return r.__generator(this,function(u){switch(u.label){case 0:return u.trys.push([0,3,,4]),t=function(e){var t={},n=function(e){var t=[];if(null!=e.ReplyWithQueryCoverage)for(var n=JSON.parse(e.ReplyWithQueryCoverage.Value)[0],r=n.coverageCheckResults,a=Object.keys(r),i=0;i<a.length;i++){var o=a[i];r[o]||t.push(o)}return t}(e);return JSON.parse(e.SubstrateSearchSuggestions.Value)[0].requests.forEach(function(e){var r=e.InputText;if(!n.includes(r)){var a=function(e,t){for(var n,r,a=w+e,i=0;i<t.length;i++)n=t[i].Key,r=t[i].Value,a+=0==i?"?":"&",a+=n+"="+r;return a}(e.Endpoint,e.UrlParameters);t[r]=a}}),t}(e),n={},(a=Object.keys(t)).length>0?[4,Promise.all(a.map(function(e){return r.__awaiter(o,void 0,void 0,function(){var a,i;return r.__generator(this,function(r){switch(r.label){case 0:return a=n,i=e,[4,D(t[e])];case 1:return[2,a[i]=r.sent()]}})})}))]:[3,2];case 1:return u.sent(),[2,E(n)];case 2:return[3,4];case 3:return i=u.sent(),c.d.info("Failed to parse property, error: "+i.message),[3,4];case 4:return[2,null]}})})}function D(e){return r.__awaiter(this,void 0,void 0,function(){var t,n;return r.__generator(this,function(r){switch(r.label){case 0:t=null,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Object(R.b)(e)];case 2:return t=r.sent(),[3,4];case 3:return n=r.sent(),c.d.info("[getReplyWithSuggestions_executeAndLog3SQuery] Failed to make service call, error: "+n.message),[3,4];case 4:return[2,t]}})})}function E(e){try{var t={};return Object.keys(e).forEach(function(n){t[n]=e[n].Groups[0].Suggestions;for(var r=0;r<t[n].length;r++)t[n][r].Endpoint=0}),t}catch(e){return c.d.info("getSentenceToAttachmentSuggestionsMap: Failed to execute, error: "+e.message),null}}var x=n(4382),k=n(4414);function C(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,a;return r.__generator(this,function(r){switch(r.label){case 0:return t=null,e?[4,x.c.import()]:[3,4];case 1:return[4,r.sent()(e.ItemId.Id,k.a.SmartDoc)];case 2:return(n=r.sent())&&(a=function(e){var t={SubstrateSearchSuggestions:null,ReplyWithQueryCoverage:null},n=e.ExtendedProperty;if(n)for(var r=n.length,a=0;a<r;a++){var i=n[a];i.ExtendedFieldURI.PropertyName===T?t.SubstrateSearchSuggestions=i:i.ExtendedFieldURI.PropertyName===I&&(t.ReplyWithQueryCoverage=i)}return t}(n))?[4,_(a)]:[3,4];case 3:t=r.sent(),r.label=4;case 4:return[2,t]}})})}var A=Object(a.action)("createMessageWithAttachmentAction",function(e,t){return{item:e,attachment:t}}),N=n(4407);function F(e){return r.__awaiter(this,void 0,void 0,function(){var t,n;return r.__generator(this,function(r){switch(r.label){case 0:return(n=e.AttachmentSuggestions)?[3,2]:[4,C(e)];case 1:n=r.sent(),r.label=2;case 2:return(t=n)?[2,j(t).map(function(t,n){return function(e,t,n){var r=Object(N.b)("SmartDoc","suggestion"+n);return{ariaLabel:e.FileName,featureName:"SmartDoc",icon:{iconName:L(e.FileExtension)},onClick:function(){A(t,e)},logData:r,index:n,text:e.FileName}}(t,e,n)})]:[2,[]]}})})}function L(e){return e.indexOf("doc")>=0?"WordLogo":e.indexOf("ppt")>=0?"PowerPointLogo":e.indexOf("xls")>=0?"ExcelLogo":e.indexOf("pdf")>=0?"Pdf":"OfficeLogo"}var M=n(1518),V=n(3626);function U(e,t){return r.__awaiter(this,void 0,void 0,function(){var n;return r.__generator(this,function(r){switch(r.label){case 0:return n=null,Object(V.i)()!==V.c.NotLoaded?[3,2]:[4,V.k.import()];case 1:return r.sent()(function(r){n=B(Object(V.g)(),e),t(n)}),[3,3];case 2:n=B(Object(V.g)(),e),t(n),r.label=3;case 3:return[2]}})})}function B(e,t){var n=function(e){for(var t=0;t<e.length;t++)if(0===e[t].type)return e[t].model.Id;return c.d.warn("createCloudFileFromAttachmentData: Could not get OneDrive Pro provider ID. Attachment will not upload."),""}(e);return{fileType:M.a.CloudSuggestion,name:t.FileName,size:null,providerId:n,providerType:0,location:t.Url,providerEndpointUrl:null,isFolder:!1,fileId:t.Id,fileParentId:null,thumbnailUrl:null,previewUrl:null,type:null}}var G=n(535);Object(a.orchestrator)(A,function(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,a,i=this;return r.__generator(this,function(o){switch(o.label){case 0:t=e.item,n=e.attachment,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,U(n,function(e){return r.__awaiter(i,void 0,void 0,function(){return r.__generator(this,function(n){return function(e,t){r.__awaiter(this,void 0,void 0,function(){var n,a,i;return r.__generator(this,function(r){switch(r.label){case 0:return t?[4,G.w.import()]:[3,5];case 1:return n=r.sent(),[4,G.h.import()];case 2:return a=r.sent(),(i=Object(G.b)(e.ConversationId.Id))?[3,4]:[4,n({referenceItemOrId:e,isReplyAll:!0,useFullCompose:!1,actionSource:null,instrumentationContexts:null,conversationId:e.ConversationId.Id,body:null})];case 3:i=r.sent(),r.label=4;case 4:a([t],i,{isInline:!1,isHiddenInline:!1,shouldShare:!0},null,null,null,null),r.label=5;case 5:return[2]}})})}(t,e),[2]})})})];case 2:return o.sent(),[3,4];case 3:return a=o.sent(),c.d.error("[createMessageWithAttachmentOrchestrator] Error when creating cloud file: "+a.message),[3,4];case 4:return[2]}})})});var W="EntityExtraction/SmartReplyForEmail",H=n(608),z=Object(a.action)("updateSIGSDataOnClickAction",function(e,t,n){return{composeViewState:e,timeClicked:t,clickIndex:n}});var q=Object(a.action)("cacheSmartReplyDataAction",function(e,t,n,r,a){return{item:e,validPropertyExists:t,smartReplies:n,loggableSmartReplies:r,smartReplyExtractionID:a}}),J="2018-06-20T00:00:00.0000000Z",Q="@extractionTimeUtc",K="@EntityId",$=3;function X(e,t){var n=!1;if(e&&t)try{var r=JSON.parse(t.Value)[0],a=r[Q];if(a)Date.parse(a)>=Date.parse(J)&&(n=function(e,t){for(var n=t[K],r=[],a=[],i=!1,o=t.entities.length,u=0;u<o;u++)r.push(t.entities[u].value),a.push(t.entities[u].valueRaw||t.entities[u].value);n&&r.length==$?q(e,i=!0,r,a,n):c.d.info("[getSmartRepliesForItem_extractAndCacheSmartRepliesFromProperty] Unexpected number of smart replies on item. Expected "+$+" but found "+r.length);return i}(e,r));else c.d.info("[getSmartRepliesForItem_parseSmartReplyProperty] Time stamp not found on property, aborting smart reply parsing.")}catch(e){c.d.info("[getSmartRepliesForItem_parseSmartReplyProperty] Malformed property, cannot parse. Error: "+e.message)}else c.d.info("[getSmartRepliesForItem_parseSmartReplyProperty] No item or property found.");e&&!n&&q(e,n)}function Y(e){return r.__awaiter(this,void 0,void 0,function(){var t,n;return r.__generator(this,function(a){switch(a.label){case 0:return e?e.SmartReplyData?[3,3]:[4,x.c.import()]:[3,4];case 1:return[4,a.sent()(e.ItemId.Id,k.a.SmartReply)];case 2:(t=a.sent())&&(n=function(e,t){var n=e.ExtendedProperty;if(n)for(var r=n.length,a=0;a<r;a++){var i=n[a];if(i.ExtendedFieldURI.PropertyName===t)return i}return null}(t,W),X(t,n)),a.label=3;case 3:return e.SmartReplyData&&e.SmartReplyData.ExtractionID?[2,e.SmartReplyData.SmartReplies.map(function(t,n){return function(e,t,n,a,i){var o=this,u=Object(N.b)("SmartReply",n);return u.mainPayload.EID=a,u.mainPayload.confidenceScore=i+1,{ariaLabel:"Suggested reply: "+t,featureName:"SmartReply",onClick:function(n){return r.__awaiter(o,void 0,void 0,function(){var a;return r.__generator(this,function(r){switch(r.label){case 0:return[4,H.h.importAndExecute(e.ItemId.Id,e.ConversationId.Id,t,1)];case 1:return a=r.sent(),z(a,n.logData.mainPayload.timeClicked,n.logData.mainPayload.position),[2]}})})},logData:u,index:i,text:t,toolTip:t,confidenceScore:u.mainPayload.confidenceScore}}(e,t,e.SmartReplyData.LoggableSmartReplies[n],e.SmartReplyData.ExtractionID,n)})]:[3,5];case 4:c.d.info("[getSmartRepliesForItem] No item, cannot produce smart replies."),a.label=5;case 5:return[2,[]]}})})}var Z=n(7);Object(a.mutator)(q,function(e){var t={SmartReplies:null,LoggableSmartReplies:null,ExtractionID:null,SuggestionAppropriatenessMap:null,FeedbackSubmitted:!1},n=e.item,r=e.validPropertyExists,a=e.smartReplies,i=e.loggableSmartReplies,o=e.smartReplyExtractionID;if(r){t={SmartReplies:a,LoggableSmartReplies:i,ExtractionID:o,SuggestionAppropriatenessMap:new Z.ObservableMap,FeedbackSubmitted:!1};for(var u=0;u<a.length;u++){var c=String(u);t.SuggestionAppropriatenessMap.set(c,"")}}n.SmartReplyData=t}),Object(a.mutator)(z,function(e){var t=e.composeViewState,n=e.timeClicked,r=e.clickIndex;t&&(t.smartReplyComposeSIGSData={isSmartSuggestionsClicked:!0,suggestionsClickedTime:n,clickIndex:r})});var ee=n(12845),te="EntityExtraction/Events1.0";var ne=n(5),re=n(147);var ae=Object(a.action)("cacheSmartTimeExtendedPropertyAction",function(e,t,n){return{item:e,validPropertyExists:t,smartTimesExtendedProp:n}}),ie="@EntityId",oe="confidence";var ue=n(4),ce=n(289),se=n(7399),le=n(493);function de(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,a,i,o,s,l,d,m,f,g,p;return r.__generator(this,function(b){switch(b.label){case 0:return t=[],e?e.SmartTimeExtendedProperty?[3,3]:[4,x.c.import()]:[3,7];case 1:return[4,b.sent()(e.ItemId.Id,k.a.SmartTime)];case 2:(n=b.sent())&&(a=function(e){var t=null;if(e){var n=e.ExtendedProperty;n&&n.some(function(e){return e.ExtendedFieldURI.PropertyName==te&&(t=e,!0)})}return t}(n),function(e,t){var n,a;if(t){var i=null,o=!1;try{var u=JSON.parse(t.Value);if(u&&u.length>0){var s=u[0][ie],l=u[0][oe];try{for(var d=r.__values(u),m=d.next();!m.done;m=d.next()){var f=m.value;if(f.times&&f.times.length>0){var g=f.times[0];i={beginingOfTimeRange:g.beginingOfTimeRange,endOfTimeRange:g.endOfTimeRange,duration:g.duration,entityId:s,hasIntent:!0,confidenceScore:l},o=!0}}}catch(e){n={error:e}}finally{try{m&&!m.done&&(a=d.return)&&a.call(d)}finally{if(n)throw n.error}}}}catch(e){c.d.warn("[getSmartTimeForItem_parseSmartTimeProperty] Malformed property, cannot parse. Error: "+e.message)}finally{ae(e,o,i)}}else c.d.info("[getSmartTimeForItem_parseSmartTimeProperty] No smart time extended property found.")}(n,a)),b.label=3;case 3:return(i=e.SmartTimeExtendedProperty)?(o=i.entityId,s=100*i.confidenceScore,l=null,d=null,Object(u.e)("mc-smartReplyWithMeeting-SuggestedTimeToCAS")&&(l=function(e){var t=null;if(e&&e.SmartTimeExtendedProperty){var n=Object(re.g)();try{var r=Object(ne.cc)(e.SmartTimeExtendedProperty.beginingOfTimeRange),a=Object(ne.cc)(e.SmartTimeExtendedProperty.endOfTimeRange);r>=n&&(t={startTime:r,endTime:a})}catch(e){c.d.error("[getSmartTimeSuggestion] Unable to parse suggested time. "+e)}}return t}(e))?[4,Object(se.a)(e,l)]:[3,5]):[3,6];case 4:b.sent(),d=Object(le.b)().conversationReadingPaneViewState.calendarInlineComposeViewState,b.label=5;case 5:m=e,f=Object(u.e)("mc-smartReplyWithMeeting-Cortana"),g=function(e,t,n,r,a){var i=Object(N.b)("SmartTime",Object(ue.a)(ee.a)),o=null!=r,u=n.ToRecipients?n.ToRecipients.length:0,c=n.CcRecipients?n.CcRecipients.length:0;i.mainPayload.EID=e,i.mainPayload.confidenceScore=t,i.mainPayload.hasSuggestedTime=o,i.mainPayload.NumToRecipient=u,i.mainPayload.NumCCRecipient=c,i.mainPayload.isCortanaEnabled=a,o&&(i.mainPayload.suggestedStartTime=r.startTime,i.mainPayload.suggestedEndTime=r.endTime);return i}(o,s,m,l,f),p=null,f&&(p={items:ge(e,d,o,m,g)}),t.push(function(e,t,n,r,a,i,o){return{ariaLabel:"Suggested time: "+t,featureName:"SmartTime",onClick:n,index:e,logData:r,text:t,toolTip:t,icon:i,confidenceScore:a,menuProps:o}}(t.length,Object(ue.a)(ee.a),function(){return me(e,d,o,m)},g,s,{iconName:"DateTime2"},p)),b.label=6;case 6:return[3,8];case 7:c.d.info("[getSmartTimesForItem] No item, cannot produce smart times."),b.label=8;case 8:return[2,t]}})})}function me(e,t,n,r){ce.j.importAndExecute(e.ItemId.Id,t,!1,null,n,r.InternetMessageId)}function fe(e,t,n,r){var a={data:[e.mainPayload]};a.data[0].subtype=t,a.data[0].timeClicked=r,Object(N.g)("SmartPillClicked",[JSON.stringify(a)],n)}function ge(e,t,n,r,a){var i=[];return i.push({key:"OutlookMeeting",text:"Outlook Calendar",onClick:function(){fe(a,"OutlookMeeting",r.InternetMessageId,(new Date).toISOString()),me(e,t,n,r)}}),i.push({key:"CortanaMeeting",text:"Cortana Assistant",onClick:function(){fe(a,"CortanaMeeting",r.InternetMessageId,(new Date).toISOString()),function(e){H.h.importAndExecute(e.ItemId.Id,e.ConversationId.Id,"Cortana, can you help us schedule a meeting?",2)}(e)}}),i}Object(a.mutator)(ae,function(e){var t={beginingOfTimeRange:null,endOfTimeRange:null,duration:null,entityId:null,hasIntent:!1,confidenceScore:0},n=e.item,r=e.validPropertyExists,a=e.smartTimesExtendedProp;r&&a&&(t={beginingOfTimeRange:a.beginingOfTimeRange,endOfTimeRange:a.endOfTimeRange,duration:a.duration,entityId:a.entityId,hasIntent:!0,confidenceScore:a.confidenceScore}),n.SmartTimeExtendedProperty=t});var pe=n(12846),be=n(706),Se=n(143);function he(e,t,n,r){var a=Object(N.b)("SmartTodo",n);return a.mainPayload.confidenceScore=e.confidenceScore,a.mainPayload.EID=e.entityId,{ariaLabel:"Suggested todo: "+e.description,featureName:"SmartTodo",icon:{iconName:"ToDoLogoOutline"},onClick:function(){!function(e,t,n){if(Object(l.a)())return void be.i.importAndExecute("SmartTask",e,t,n);if(Object(s.a)())Se.k.importAndExecute(e,t,n)}(e.description,t,e.entityId)},logData:a,index:r,text:n,toolTip:n,confidenceScore:e.confidenceScore}}var ve=Object(a.action)("cacheSmartTaskData",function(e,t,n){return{item:e,validPropertyExists:t,smartTasks:n}}),ye="@EntityId",Oe="@sourceConfidenceScore";function Pe(e,t){var n=!1;if(e&&t)try{n=function(e,t){var n=JSON.parse(t.Value),r=!1;if(!t)return c.d.info("[getSmartTaskForItem_parseSmartTaskProperty] No smart task extended property found."),r;var a=[];if(n&&n.length>0)for(var i=n.length,o=0;o<i;o++){var u=n[o];a.push({entityId:u[ye],description:u.description,confidenceScore:100*Number(u[Oe])})}a.length>0?ve(e,r=!0,a):c.d.info("[getSmartTasksForItem_extractAndCacheSmartTaskFromProperty] There are zero smart tasks for this item");return r}(e,t)}catch(e){c.d.info("[getSmartTasksForItem_parseSmartTaskProperty] Malformed property, cannot parse. Error: "+e.message)}else c.d.info("[getSmartTasksForItem_parseSmartTaskProperty] No item or property found.");e&&!n&&ve(e,!1)}var je,Te="EntityExtraction/RequestForAction1.0";function Ie(e,t){return r.__awaiter(this,void 0,void 0,function(){var n,a;return r.__generator(this,function(r){switch(r.label){case 0:return e?e.SmartTaskData?[3,3]:[4,x.c.import()]:[3,4];case 1:return[4,r.sent()(e.ItemId.Id,k.a.SmartTask)];case 2:(n=r.sent())&&(a=function(e){var t=null;if(e){var n=e.ExtendedProperty;n&&n.some(function(e){return e.ExtendedFieldURI.PropertyName==Te&&(t=e,!0)})}return t}(n),Pe(n,a)),r.label=3;case 3:return e.SmartTaskData&&e.SmartTaskData.SmartTasks?[2,e.SmartTaskData.SmartTasks.map(function(n,r){return t==je.Todo&&e.ItemId?he(n,e.ItemId.Id,Object(ue.a)(pe.a),r):function(e,t,n,r,a){var i=Object(N.b)("SmartReminder",r);return i.mainPayload.confidenceScore=e.confidenceScore,i.mainPayload.EID=e.entityId,{ariaLabel:"Suggested reminder: "+e.description,featureName:"SmartReminder",icon:{iconName:"AddEvent"},onClick:function(){ce.j.importAndExecute(t,null,!1,null,e.entityId,n,!0)},logData:i,index:a,text:r,toolTip:r,confidenceScore:e.confidenceScore}}(n,e.ItemId.Id,e.InternetMessageId,Object(ue.a)(pe.b),r)})]:[3,5];case 4:c.d.info("[getSmartTodosOrRemindersForItem] No item, cannot produce smart tasks."),r.label=5;case 5:return[2,[]]}})})}!function(e){e[e.Todo=0]="Todo",e[e.Reminder=1]="Reminder"}(je||(je={}));Object(a.mutator)(ve,function(e){var t={SmartTasks:null},n=e.item;if(e.validPropertyExists){var r=e.smartTasks;t.SmartTasks=r}n.SmartTaskData=t});function Re(e){var t=[];return t.push(function(e){return{buildPills:function(){return de(e)}}}(e)),t.push(function(e){return{buildPills:function(){return F(e)}}}(e)),t.push(function(e){return{buildPills:function(){return Y(e)}}}(e)),t.push(function(e){return{buildPills:function(){return Ie(e,je.Todo)}}}(e)),Object(u.e)("mc-smartTaskWithReminder")&&t.push(function(e){return{buildPills:function(){return Ie(e,je.Reminder)}}}(e)),t}function we(e){var t=this;return{updateLogData:function(n){return r.__awaiter(t,void 0,void 0,function(){var t,a,i;return r.__generator(this,function(r){return e&&(t=e.stampedLanguage&&e.stampedLanguage.language,a=e.stampedLanguage&&e.stampedLanguage.locale,i=e.InternetMessageId,n.forEach(function(e){e.logData.mainPayload.language=t,e.logData.mainPayload.locale=a,e.logData.cosmosOnlyData=i})),[2]})})}}}var _e=Object(a.action)("updateItemLanguageAction",function(e){return{item:e}});function De(e){var t=this;return{preRun:function(){return r.__awaiter(t,void 0,void 0,function(){var t;return r.__generator(this,function(n){switch(n.label){case 0:return[4,x.c.import()];case 1:return[4,n.sent()(e.ItemId.Id,k.a.LanguageAndLocale)];case 2:return(t=n.sent())&&!t.stampedLanguage&&_e(t),[2]}})})}}}var Ee=n(12847);function xe(e,t){var n;t.UniqueBody?n=t.UniqueBody.Value:t.NormalizedBody&&(n=t.NormalizedBody.Value);var r={subtitle:void 0,dSATOptions:void 0,donationJson:{messageBody:n}},a=e.some(function(e){return"SmartTime"===e.featureName});return e.some(function(e){return"SmartReply"===e.featureName})?(r.subtitle=Object(ue.a)(Ee.f),r.dSATOptions=a?[{logString:"They aren't relevant",uiString:Object(ue.a)(Ee.a)},{logString:"They don't sound like me",uiString:Object(ue.a)(Ee.c)},{logString:"They're offensive or rude",uiString:Object(ue.a)(Ee.d)},{logString:"I'm not the person who should schedule the meeting",uiString:Object(ue.a)(Ee.i)},{logString:"I don't want help scheduling a meeting",uiString:Object(ue.a)(Ee.k)},{logString:"Other",uiString:Object(ue.a)(Ee.e)}]:[{logString:"They aren't relevant",uiString:Object(ue.a)(Ee.a)},{logString:"The meaning isn't clear",uiString:Object(ue.a)(Ee.b)},{logString:"They don't sound like me",uiString:Object(ue.a)(Ee.c)},{logString:"They're offensive or rude",uiString:Object(ue.a)(Ee.d)},{logString:"Other",uiString:Object(ue.a)(Ee.e)}]):a?(r.subtitle=Object(ue.a)(Ee.l),r.dSATOptions=[{logString:"The meeting is already on my calendar",uiString:Object(ue.a)(Ee.g)},{logString:"A meeting suggestion isn't relevant",uiString:Object(ue.a)(Ee.h)},{logString:"I'm not the person who should schedule the meeting",uiString:Object(ue.a)(Ee.i)},{logString:"I want to schedule the meeting later",uiString:Object(ue.a)(Ee.j)},{logString:"I don't want help scheduling a meeting",uiString:Object(ue.a)(Ee.k)},{logString:"Other",uiString:Object(ue.a)(Ee.e)}]):r.subtitle=Object(ue.a)(Ee.f),r}var ke=n(5638);var Ce=n(6902),Ae=n(19),Ne=n(7971),Fe=n(1),Le=n(12848),Me=function(e){function t(t){var n=e.call(this,t)||this,r=n.props.item;return n.smartPillBuilders=Re(r),n.smartPillArbitrator=O,n.smartPillLogDataUpdaters=function(e){return[we(e)]}(r),n.smartPillPreRunners=function(e){return[De(e)]}(r),n.loggedToSIGS=!1,n}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.runSmartPillBuilders()},t.prototype.componentDidUpdate=function(){this.loggedToSIGS||(Object(Ce.b)(this.props.item),this.loggedToSIGS=!0)},t.prototype.componentWillUnmount=function(){this.smartPillBuilders=null,this.smartPillArbitrator=null,this.smartPillData=null,this.smartPillPreRunners=null,i(this.props.viewState,!1)},t.prototype.render=function(){var e=this.props,t=e.item,n=e.viewState.smartPillBlockVisible;if(!!t.RightsManagementLicenseData||!n||!this.smartPillData||0==this.smartPillData.pillsToShow.length&&0==this.smartPillData.pillsToHide.length)return null;var r=this.smartPillData.pillsToShow.length>0;return Fe.createElement("div",{className:r?Le.bar:void 0},Fe.createElement(Ne.a,{arbitratedPills:this.smartPillData,enableFeedbackForm:!t.smartPillFeedbackSubmitted,feedbackData:xe(this.smartPillData.pillsToShow,t)}))},t.prototype.runSmartPillBuilders=function(){return r.__awaiter(this,void 0,void 0,function(){var e;return r.__generator(this,function(t){switch(t.label){case 0:return c.d.info("[MailSmartPillBlock] Running smart pill builders"),e=this,[4,Object(N.a)(this.smartPillBuilders,this.smartPillArbitrator,this.smartPillPreRunners,this.smartPillLogDataUpdaters,5e3)];case 1:return e.smartPillData=t.sent(),n=this.props.item,r=this.smartPillData,a=r?r.pillsToShow.filter(function(e){return"SmartReply"===e.featureName}):[],o=a.length>0?a[0].logData.mainPayload.EID:"",u=r&&r.pillsToShow.length>0?"True":"False",s="True"===u?r.pillsToShow.map(function(e){return e.featureName}).toString():"",l="True"===u?r.pillsToShow.map(function(e){return e.text}).join("$"):"",Object(ke.a)(n.ItemId.Id,u,s,l,o),this.smartPillData&&this.smartPillData.pillsToShow.length>0&&i(this.props.viewState,!0),[2]}var n,r,a,o,u,s,l})})},t=r.__decorate([Ae.observer],t)}(Fe.Component),Ve=(Object(a.mutator)(i,function(e){e.viewState.smartPillBlockVisible=e.smartPillBlockVisible}),Object(a.mutator)(o,function(e){e.item.smartPillFeedbackSubmitted=e.smartPillFeedbackSubmitted}),n(4863));function Ue(e){var t=function(e){var t=e.ExtendedProperty;if(t){var n=t.filter(function(e){return e.ExtendedFieldURI.PropertyName===Ve.b});if(n.length>0)return n[0]}return null}(e),n=void 0,r=void 0,a=0,i=void 0;try{if(t){var o=JSON.parse(t.Value)[0],u=o[Ve.d],s=o[Ve.e];i=o[Ve.c],r=Object.keys(s)[0],n=u&&u[Ve.f]&&u[Ve.f].toLowerCase(),a=parseInt(Object.values(s)[0])}}catch(e){c.d.info("[getStampedLanguage] Failed to parse property, error: "+e.message)}return{locale:n,language:r,confidenceScore:a,entityId:i}}var Be=n(18);Object(a.mutator)(_e,function(e){var t=e.item;t.stampedLanguage=Ue(t),Object(u.e)("mc-logMessagesInSpanish")&&function(e,t,n,r){void 0===r&&(r=Ve.a),function(e,t){return e.UniqueBody&&e.UniqueBody.Value.length>t||e.NormalizedBody&&e.NormalizedBody.Value.length>t}(e,r)&&e.stampedLanguage.language.toLowerCase()===t.toLowerCase()&&Object(Be.o)(n,{entityId:e.stampedLanguage.entityId,confidenceScore:e.stampedLanguage.confidenceScore},{isCore:!0})}(t,Ve.g,Ve.h)});n.d(t,"MailSmartPillBlock",function(){return Me})},143:function(e,t,n){"use strict";var r=n(3),a=n(0),i=n(351),o=n(6),u=n(328),c=n(2),s=(Object(c.orchestrator)(i.c,function(){return a.__awaiter(void 0,void 0,void 0,function(){return a.__generator(this,function(e){return Object(o.e)("auth-PremiumDashboardApril")?u.e.importAndExecute("premium","features"):Object(o.e)("auth-PremiumDashboard")?u.e.importAndExecute("general","Premium"):window.open("https://premium.outlook.com","_blank"),[2]})})}),n(1339)),l=n(82),d=(Object(c.orchestrator)(s.a,function(){Object(o.e)("fwk-o365shellheader")?window.O365Shell.FlexPane.OpenFlexPaneForProvider("OwaHelp"):Object(l.c)(2)}),n(846));Object(c.orchestrator)(d.a,function(){Object(o.e)("fwk-o365shellheader")?window.O365Shell.FlexPane.OpenFlexPaneForProvider("OwaSettings"):Object(l.c)(4)}),n(1698);n.d(t,"b",function(){return f}),n.d(t,"e",function(){return g}),n.d(t,"c",function(){return p}),n.d(t,"d",function(){return b}),n.d(t,"h",function(){return S}),n.d(t,"l",function(){return h}),n.d(t,"n",function(){return v}),n.d(t,"f",function(){return y}),n.d(t,"q",function(){return O}),n.d(t,"g",function(){return P}),n.d(t,"r",function(){return j}),n.d(t,"p",function(){return T}),n.d(t,"o",function(){return I}),n.d(t,"m",function(){return R}),n.d(t,"a",function(){return w}),n.d(t,"j",function(){return _}),n.d(t,"k",function(){return D}),n.d(t,"i",function(){return E});var m=new r.c(function(){return Promise.all([n.e(2),n.e(3),n.e(544),n.e(53),n.e(270)]).then(n.bind(null,13678))}),f=Object(r.d)(m,function(e){return e.DiagnosticsPane}),g=Object(r.d)(m,function(e){return e.FeatureFlagsPane}),p=Object(r.d)(m,function(e){return e.FeatureFlagsHeader}),b=Object(r.d)(m,function(e){return e.FeatureFlagsList}),S=Object(r.d)(m,function(e){return e.HelpPane}),h=Object(r.d)(m,function(e){return e.MeCardPane}),v=Object(r.d)(m,function(e){return e.SettingsPane}),y=Object(r.d)(m,function(e){return e.FeedbackPane}),O=Object(r.d)(m,function(e){return e.WafflePane}),P=Object(r.d)(m,function(e){return e.GetStartedPane}),j=Object(r.d)(m,function(e){return e.WhatsNewPane}),T=Object(r.d)(m,function(e){return e.TodoPane}),I=Object(r.d)(m,function(e){return e.TimePanelPane}),R=Object(r.d)(m,function(e){return e.MiniMavenPane}),w=Object(r.d)(m,function(e){return e.ActivityFeedPane}),_=new r.a(m,function(e){return e.launchHelpPane}),D=new r.a(m,function(e){return e.showTodoPanelWithSubject}),E=new r.a(m,function(e){return e.toggleGetStartedPane})},1698:function(e,t,n){"use strict";var r=n(2),a=n(1349),i=n(82),o=n(6);Object(r.orchestrator)(a.a,function(){Object(o.e)("fwk-o365shellheader")?window.O365Shell.FlexPane.OpenFlexPaneForProvider("OwaToDo"):Object(i.c)(9)})},351:function(e,t,n){"use strict";var r=n(3),a=n(22),i=n(1343),o=n(1347);function u(){var e=Object(i.a)();return e.cards?Object.keys(e.cards).filter(function(t){return e.cards[t].status===o.a.Unread}).length:0}n(846);var c=n(1322);n.d(t,"a",function(){return l}),n.d(t,"b",function(){return u}),n.d(t,"c",function(){return c.a});var s=new r.c(function(){return n.e(459).then(n.bind(null,13656))}),l=Object(r.d)(s,function(e){return e.WhatsNewContainer}),d=new r.b(s,function(e){return e.initializeWhatsNew});Object(a.c)(function(){d.import().then(function(e){return e()})})},3554:function(e,t,n){"use strict";var r=n(2),a=n(7),i=n(3641),o={providers:new a.ObservableMap,loadState:i.a.NotLoaded,removalPending:new a.ObservableMap},u=Object(r.createStore)("fileProviderStoreV2",o);t.a=u},3567:function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return a}),n.d(t,"c",function(){return o});var r=n(2),a=Object(r.action)("FILE_PROVIDER_ADDED",function(e){return{providerViewState:e}}),i=Object(r.action)("FILE_PROVIDER_REMOVED",function(e){return{providerType:e}}),o=Object(r.action)("PROVIDERS_LOADED",function(e){return{providers:e}})},3594:function(e,t,n){"use strict";var r=n(0),a=n(4056),i=n.n(a),o=n(3774),u=n.n(o);function c(e){var t=u()({ProviderType:e});return i()(t)}var s=n(4057),l=n.n(s),d=n(3775),m=n.n(d);function f(e){var t=m()({ProviderType:e});return l()(t)}var g=n(4018),p=n(6);n.d(t,"a",function(){return j}),n.d(t,"b",function(){return R});var b="code",S="token",h=3e3,v=3;function y(e){return{state:e}}function O(e){return e.state}function P(e){return e.code}function j(e,t,n,a,i){var o={providerType:e,getAuthUrlInfo:null,getCSRFToken:O,getOAuthCode:P};return function e(t,n,a,i,o,u,s){return r.__awaiter(this,void 0,void 0,function(){var l,d;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),l=void 0,7!==t&&9!==t&&8!==t?[3,2]:[4,f(t)];case 1:return d=r.sent(),l=d.AttachmentDataProviderCreator.ProviderAppKey,a=d.AttachmentDataProviderCreator.AuthorizationUri,[3,4];case 2:return[4,c(t)];case 3:d=r.sent(),l=d.ProviderAppKey,r.label=4;case 4:return n.getAuthUrlInfo=Object(g.d)(t,a,i,l,o,u),[3,6];case 5:return r.sent(),s>0&&setTimeout(function(){return e(t,n,a,i,o,u,--s)},h),[3,6];case 6:return[2]}})})}(e,o,t,n,a,i,v),o}var T=null;function I(){if(!T){(T={})[3]=j(3,"https://app.box.com/api/oauth2/authorize",Object(g.c)(3),b,y),T[2]=j(2,"https://www.dropbox.com/oauth2/authorize",Object(g.b)(2),b,y);var e=j(6,"https://www.facebook.com/dialog/oauth",Object(g.b)(6),S,function(e){return{state:e,scope:"user_photos,email"}});e.getCSRFToken=O,e.getOAuthCode=function(e){return e.access_token},T[6]=e;var t=j(5,"https://accounts.google.com/o/oauth2/auth",g.a+"/ADPRedirect.aspx",b,function(e){var t={state:e,provider:5..toString(),url:Object(g.b)()};return{state:JSON.stringify(t),scope:"https://www.googleapis.com/auth/drive",access_type:"offline",prompt:"consent",include_granted_scopes:"true"}});t.getCSRFToken=function(e){return JSON.parse(e.state).state},T[5]=t,T[1]=j(1,"https://login.live.com/oauth20_authorize.srf",Object(g.c)(1),b,function(e){return{state:e,scope:"wl.basic onedrive.readwrite wl.offline_access"}}),Object(p.e)("doc-fileProvider-wopiClient")&&(T[7]=j(7,"",Object(g.c)(7),b,y),T[8]=j(8,"",Object(g.c)(8),b,y),T[9]=j(9,"",Object(g.c)(9),b,y))}return T}function R(e){var t=I();return e in t?t[e]:null}},3601:function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return o});var r=n(0),a=n(3554),i=function(){return r.__spread(Object(a.a)().providers.values())},o=function(e){return Object(a.a)().providers.get(e)||null}},3617:function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"a",function(){return i}),n.d(t,"c",function(){return o});var r,a=n(0);!function(e){e[e.Groups=1e4]="Groups"}(r||(r={}));var i=Object.freeze([1,3,2,6,5,7,8,9]),o=Object.freeze(a.__spread(i,[0,4,10]))},3626:function(e,t,n){"use strict";var r=n(3),a=n(3748),i=n(3694),o=(n(3554),n(3567)),u=n(3617),c=(n(3979),n(3960),n(3601));var s=n(3679),l=n(3641),d=n(3594);n.d(t,"k",function(){return f}),n.d(t,"m",function(){return g}),n.d(t,"j",function(){return p}),n.d(t,"l",function(){return b}),n.d(t,"b",function(){return a.a}),n.d(t,"h",function(){return i.a}),n.d(t,"d",function(){return o.a}),n.d(t,"e",function(){return o.b}),n.d(t,"n",function(){return o.c}),n.d(t,"a",function(){return u.b}),n.d(t,"g",function(){return c.b}),n.d(t,"i",function(){return s.a}),n.d(t,"c",function(){return l.a}),n.d(t,"f",function(){return d.b});var m=new r.c(function(){return Promise.all([n.e(6),n.e(7),n.e(9),n.e(14),n.e(226)]).then(n.bind(null,13752))}),f=new r.b(m,function(e){return e.loadProviders}),g=new r.b(m,function(e){return e.removeFileProvider}),p=new r.b(m,function(e){return e.addFileProvider}),b=new r.b(m,function(e){return e.removeAndAddFileProvider})},3641:function(e,t,n){"use strict";var r;n.d(t,"a",function(){return r}),function(e){e[e.Loaded=0]="Loaded",e[e.Loading=1]="Loading",e[e.NotLoaded=2]="NotLoaded"}(r||(r={}))},3679:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(3554);function a(){return Object(r.a)().loadState}},3694:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r=n(4055),a=n(3959),i=n(4029),o=n(4),u=n(75);function c(e,t){if(void 0===t&&(t=!1),t)return"";switch(e){case 0:return Object(o.a)(i.b);case 1:return Object(o.a)(i.a);case 2:case 9:return Object(o.a)(r.b);case 3:case 7:return Object(o.a)(r.a);case 5:return Object(o.a)(r.e);case 6:return Object(o.a)(r.d);case 4:return Object(o.a)(r.f);case 10:return Object(o.a)(a.b);case 8:return Object(o.a)(r.c);default:return Object(u.a)(e)}}},3748:function(e,t,n){"use strict";var r;!function(e){e[e.None=0]="None",e[e.Images=1]="Images"}(r||(r={})),t.a=r},3774:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetNewAttachmentDataProviderCreationInfoRequest:#Exchange"},e)}},3775:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetAttachmentDataProviderCreatorRequest:#Exchange"},e)}},3959:function(e){e.exports={a:"SAa",b:"TAa"}},3960:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var r=n(10),a=n(44),i=n(75),o=n(6);function u(e){var t=Object(r.a)();switch(e){case 5:return t.AttachmentPolicy.GoogleDriveAttachmentsEnabled&&t.AttachmentPolicy.ThirdPartyAttachmentsEnabled&&Object(o.e)("doc-fileProvider-gdrive");case 4:case 0:return!0;case 3:return t.AttachmentPolicy.BoxAttachmentsEnabled&&t.AttachmentPolicy.ThirdPartyAttachmentsEnabled&&Object(o.e)("doc-fileProvider-box");case 2:return t.AttachmentPolicy.DropboxAttachmentsEnabled&&t.AttachmentPolicy.ThirdPartyAttachmentsEnabled&&Object(o.e)("doc-fileProvider-dropbox");case 6:return t.AttachmentPolicy.ThirdPartyAttachmentsEnabled&&Object(o.e)("doc-fileProvider-facebook");case 1:return!!Object(a.a)()||Object(o.e)("doc-filePicker-oneDriveConsumerForO365")&&t.AttachmentPolicy.OnedriveAttachmentsEnabled&&t.AttachmentPolicy.ThirdPartyAttachmentsEnabled;case 10:return Object(o.e)("doc-filePicker-mailMessageAttachment");case 7:case 8:case 9:return t.AttachmentPolicy.ThirdPartyAttachmentsEnabled&&Object(o.e)("doc-fileProvider-wopiClient");default:return Object(i.a)(e)}}},3979:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return i});var r=n(3617),a="file provider is not addable";function i(e){return r.a.indexOf(e)>-1}},4018:function(e,t,n){"use strict";var r=n(53),a=n(15);function i(e,t,n){if(!e||!t||!n)throw new Error("Key and Value parameters should not be null");return e.indexOf("?")>0?e+"&"+t+"="+n:e+"?"+t+"="+n}n.d(t,"a",function(){return o}),n.d(t,"b",function(){return u}),n.d(t,"c",function(){return c}),n.d(t,"d",function(){return s});var o=Object(a.u)()?"https://exchangelabs.live-int.com/owa":"https://outlook.office.com/owa";function u(e){var t=e?encodeURIComponent("?provider="+e):"",n=e&&6===e?"AddFacebookFileProvider.html":"AddFileProvider.html";return Object(r.n)()+"/mail/"+n+t}function c(e){var t=Object(r.n)()+"/mail/AddFileProvider.html",n=encodeURIComponent("provider="+e+"&url="+t);return o+"/ADPRedirect.aspx?"+n}function s(e,t,n,r,a,o){return function(){var e=function(){for(var e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".split(""),t=e.length-1,n=[],r=0;r<16;r++)n.push(e[Math.round(Math.random()*t)]);return"owa_csrf_token_"+n.join("")}(),u=i(t,"client_id",r);if(u=i(u,"redirect_uri",n),u=i(u,"response_type",a),o){var c=o(e);u=Object.keys(c).reduce(function(e,t){return i(e,t,c[t])},u)}return{authUrl:u,redirectUrl:n,csrfToken:e}}}},4029:function(e){e.exports={b:"LBa",a:"MBa"}},4055:function(e){e.exports={b:"FBa",a:"GBa",e:"HBa",d:"IBa",f:"JBa",c:"KBa"}},4056:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(56),a=n(3774);t.default=function(e,t){return void 0===e||e.__type||(e=a.default(e)),r.makeServiceRequest("GetNewAttachmentDataProviderCreationInfo",e,t)}},4057:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(56),a=n(3775);t.default=function(e,t){return void 0===e||e.__type||(e=a.default(e)),r.makeServiceRequest("GetAttachmentDataProviderCreator",e,t)}},4407:function(e,t,n){"use strict";var r=n(0),a=2500,i=n(11);function o(e,t,n,o,u){return r.__awaiter(this,void 0,void 0,function(){var c,s,l;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,6,,7]),n?[4,Promise.all(n.map(function(e){return e.preRun()}))]:[3,2];case 1:r.sent(),r.label=2;case 2:return[4,Promise.all(e.map(function(e){return Promise.race([e.buildPills(),(t=u||a,new Promise(function(e){setTimeout(e,t,[])}))]);var t}))];case 3:return c=r.sent(),s=[].concat.apply([],c),o?[4,Promise.all(o.map(function(e){return e.updateLogData(s)}))]:[3,5];case 4:r.sent(),r.label=5;case 5:return[2,t.arbitratePills(s)];case 6:return l=r.sent(),i.d.warn("[getPillsToRender] Please investigate error: "+l.message),[2,{pillsToShow:[],pillsToHide:[],arbitratorId:void 0}];case 7:return[2]}})})}function u(e,t,n){return{mainPayload:{renderStory:0,loggableText:t,type:e,timeClicked:null,position:-1},cosmosOnlyData:n}}var c=n(123),s=n(450);function l(e,t,n){var r=new s.a(e,t,{isCore:!0,isCosmosDatapoint:!0});n&&r.addCosmosOnlyData(n),c.g.importAndExecute(r)}function d(e,t,n){var r=void 0;e.concat(t).forEach(function(e){!r&&e.logData.cosmosOnlyData&&(r=e.logData.cosmosOnlyData)});var a={data:e.map(function(e){return e.logData.mainPayload})},i={data:t.map(function(e){return e.logData.mainPayload})};l("SmartPillsRendered",[e.length,t.length,JSON.stringify(a),JSON.stringify(i),n],r)}function m(e,t,n,r,a,i,o){l("SmartReply_Rendered",[e,!1,t.join("$"),!1,n.toString(),r.toString(),a,i],o)}function f(e){var t={data:[e.logData.mainPayload]};l("SmartPillClicked",[JSON.stringify(t)],e.logData.cosmosOnlyData)}function g(e,t,n,r,a,i,o){l("SmartReply_Clicked",[e,t,n,!1,r,a,i],o)}n(18);n.d(t,"a",function(){return o}),n.d(t,"b",function(){return u}),n.d(t,"e",function(){return d}),n.d(t,"f",function(){return m}),n.d(t,"c",function(){return f}),n.d(t,"d",function(){return g}),n.d(t,"g",function(){return l})},4414:function(e,t,n){"use strict";var r,a=n(3),i=n(5638),o=n(2),u=n(37);Object(o.mutator)(i.a,function(e){var t=e.itemId,n=e.isSmartSuggestionsRendered,r=e.suggestionTypesRendered,a=e.suggestionsRendered,i=e.extractionId,o=Object(u.t)().items.get(t);o&&o.SIGSData&&(o.SIGSData.SmartPillData={IsSmartSuggestionsRendered:n,SuggestionTypesRendered:r,SuggestionsRendered:a,ExtractionId:i})});!function(e){e.LanguageAndLocale="SmartPill_LanguageAndLocale",e.SmartDoc="SmartPill_SmartDoc",e.SmartReply="SmartPill_SmartReply",e.SmartTask="SmartPill_SmartTask",e.SmartTime="SmartPill_SmartTime"}(r||(r={})),n.d(t,"b",function(){return s}),n.d(t,"a",function(){return r});var c=new a.c(function(){return n.e(420).then(n.bind(null,13596))}),s=new a.a(c,function(e){return e.logToSIGSOnMessageSent})},448:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("TOGGLE_CHARM",function(e){return{charm:e}})},463:function(e){e.exports={c:"Tsb",f:"Usb",e:"Vsb",b:"Wsb",g:"Xsb",a:"Ysb",d:"Zsb"}},4863:function(e,t,n){"use strict";n.d(t,"g",function(){return i}),n.d(t,"h",function(){return o}),n.d(t,"a",function(){return u}),n.d(t,"d",function(){return c}),n.d(t,"f",function(){return s}),n.d(t,"e",function(){return l}),n.d(t,"c",function(){return d}),n.d(t,"b",function(){return m}),n.d(t,"i",function(){return f}),n.d(t,"k",function(){return g}),n.d(t,"l",function(){return p}),n.d(t,"m",function(){return b}),n.d(t,"n",function(){return S}),n.d(t,"j",function(){return h});var r=n(308),a=n.n(r),i="spanish",o="SpanishLanguageMessage",u=20,c="Language",s="Locale",l="LanguageScores",d="@EntityId",m="EntityExtraction/ExtractLanguage1.0",f=a()({PropertyName:m,DistinguishedPropertySetId:"Common",PropertyType:"String"}),g=a()({PropertyName:"EntityExtraction/SmartReplyForEmail",DistinguishedPropertySetId:"Common",PropertyType:"String"}),p=a()({PropertyName:"EntityExtraction/Events1.0",DistinguishedPropertySetId:"Common",PropertyType:"String"}),b=a()({PropertyName:"EntityExtraction/RequestForAction1.0",DistinguishedPropertySetId:"Common",PropertyType:"String"}),S=a()({PropertyName:"EntityExtraction/SubstrateSearchSuggestions",DistinguishedPropertySetId:"Common",PropertyType:"String"}),h=a()({PropertyName:"EntityExtraction/ReplyWithQueryCoverage",DistinguishedPropertySetId:"Common",PropertyType:"String"})},5638:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("initializeSIGSDataAction",function(e,t,n,r,a){return{itemId:e,isSmartSuggestionsRendered:t,suggestionTypesRendered:n,suggestionsRendered:r,extractionId:a}})},579:function(e,t,n){"use strict";n.d(t,"f",function(){return c}),n.d(t,"g",function(){return s}),n.d(t,"h",function(){return l}),n.d(t,"b",function(){return d});var r=n(3),a=n(833);n.d(t,"a",function(){return a.m}),n.d(t,"c",function(){return a.n}),n.d(t,"e",function(){return a.o});var i=n(1261);n.d(t,"i",function(){return i.b});var o=n(1271);n.d(t,"d",function(){return o.a});var u=new r.c(function(){return Promise.all([n.e(2),n.e(3),n.e(5),n.e(6),n.e(454)]).then(n.bind(null,2282))}),c=new r.a(u,function(e){return e.launchInAppFeedback}),s=new r.b(u,function(e){return e.postSuggestionAndSendLogDatapoint}),l=new r.b(u,function(e){return e.showUserVoiceSuggestionDialog}),d=Object(r.d)(u,function(e){return e.UserVoiceNps})},6902:function(e,t,n){"use strict";n.d(t,"b",function(){return c}),n.d(t,"a",function(){return s});var r=n(0),a=n(18),i=n(37),o=n(11),u=4e3;function c(e){if(e.SIGSData&&e.SIGSData.SmartPillData){var t=e.SIGSData.SmartPillData,n=t.IsSmartSuggestionsRendered,r=t.SuggestionTypesRendered,i=t.SuggestionsRendered,c=t.ExtractionId,s=e.InternetMessageId,l=e.UniqueBody&&e.UniqueBody.Value||e.NormalizedBody&&e.NormalizedBody.Value;if(l&&(l=l.substring(0,u)),"True"===n){var d={InternetMessageId:s,MessageBody:l,SuggestionTypesRendered:r,SuggestionsRendered:i,ExtractionId:c};a.k.importAndExecute("SmartSuggestionsRendered",{compliance:"CustomerContent",customProperties:d})}}else o.d.warn("SIGSData object not initialized on item.")}function s(e,t,n){try{if(e){var c=Object(i.t)().items.get(e);if(c&&c.SIGSData&&c.SIGSData.SmartPillData){var s=c.InternetMessageId,l=c.NormalizedBody&&c.NormalizedBody.Value||c.UniqueBody&&c.UniqueBody.Value;l&&(l=l.substring(0,u));var d=t.substring(0,u);a.k.importAndExecute("SmartSuggestionsClicked",{compliance:"CustomerContent",customProperties:r.__assign({InternetMessageId:s,MessageBody:l},c.SIGSData.SmartPillData,{IsSmartSuggestionsClicked:n&&n.isSmartSuggestionsClicked?"True":"False",SuggestionsClickedTime:n&&n.suggestionsClickedTime,ClickIndex:n&&n.clickIndex.toString(),ReplyBody:d})})}}}catch(e){o.d.error("[logToSIGSOnMessageSent] Error: "+e.message)}}},706:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return o}),n.d(t,"e",function(){return u}),n.d(t,"h",function(){return c}),n.d(t,"f",function(){return s}),n.d(t,"c",function(){return l}),n.d(t,"i",function(){return d}),n.d(t,"j",function(){return m}),n.d(t,"g",function(){return f}),n.d(t,"d",function(){return g});var r=n(3),a=new r.c(function(){return Promise.all([n.e(579),n.e(53),n.e(435)]).then(n.bind(null,2322))}),i=Object(r.d)(a,function(e){return e.TimePanel}),o=Object(r.d)(a,function(e){return e.TimePanelHeaderBar}),u=new r.a(a,function(e){return e.preloadTimePanelData}),c=new r.a(a,function(e){return e.openEventDetailsView}),s=new r.a(a,function(e){return e.openAttendeeTrackingView}),l=new r.a(a,function(e){return e.closeAttendeeTrackingView}),d=new r.a(a,function(e){return e.openTasksView}),m=new r.a(a,function(e){return e.openCalendarView}),f=new r.a(a,function(e){return e.openConflictsView}),g=new r.a(a,function(e){return e.closeConflictsView});new r.a(a,function(e){return e.openEventQuickComposeView})},7971:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(3),a=new r.c(function(){return n.e(421).then(n.bind(null,9288))}),i=(Object(r.d)(a,function(e){return e.SmartPill}),Object(r.d)(a,function(e){return e.SmartPillBlock}))},82:function(e,t,n){"use strict";var r=n(2),a=Object(r.action)("DEACTIVATE_CHARM",function(e){return{charm:e}}),i=Object(r.createStore)("headerViewState",{activeCharm:null});Object(r.mutator)(a,function(e){var t=e.charm,n=i();n.activeCharm===t&&(n.activeCharm=null)});var o=n(448);Object(r.mutator)(o.a,function(e){var t=e.charm,n=i();n.activeCharm===t?n.activeCharm=null:n.activeCharm=t});var u=n(1319),c=(Object(r.orchestrator)(u.a,function(){Object(o.a)(4)}),Object(r.action)("HIDE_QUICK_OPTIONS",function(){return{}})),s=(Object(r.orchestrator)(c,function(){a(4)}),n(579));Object(r.orchestrator)(s.d,function(){a(2)});function l(){return i().activeCharm}n.d(t,"a",function(){return a}),n.d(t,"b",function(){return l}),n.d(t,"c",function(){return o.a})},833:function(e,t,n){"use strict";n.d(t,"g",function(){return c}),n.d(t,"b",function(){return s}),n.d(t,"a",function(){return l}),n.d(t,"j",function(){return d}),n.d(t,"h",function(){return m}),n.d(t,"c",function(){return f}),n.d(t,"i",function(){return g}),n.d(t,"k",function(){return p}),n.d(t,"f",function(){return b}),n.d(t,"m",function(){return S}),n.d(t,"n",function(){return h}),n.d(t,"o",function(){return v}),n.d(t,"p",function(){return y}),n.d(t,"q",function(){return O}),n.d(t,"l",function(){return P}),n.d(t,"e",function(){return j}),n.d(t,"d",function(){return T});var r=n(0),a=n(463),i=n(4),o=n(524),u=n.n(o),c="N/A",s="",l="CheckErrorDetails",d="React/Nps",m="UVNpsRating",f="UVFeedback",g="React/Feedback",p="Search_{0}",b="NoUserMessage",S="https://outlook.uservoice.com/forums/{0}",h=601444,v=907141,y=4,O=15;function P(){return[{name:"NoResults",label:Object(i.a)(a.c)},{name:"SlowResults",label:Object(i.a)(a.f)},{name:"ResultsNotRelevant",label:Object(i.a)(a.e)},{name:"ItemNotFound",label:Object(i.a)(a.b)},{name:"SuggestionsNotUseful",label:Object(i.a)(a.g)},{name:"ClientUXHardToUse",label:Object(i.a)(a.a)},{name:"Other",label:Object(i.a)(a.d)}]}function j(e){return e?"1":"2"}function T(){return r.__awaiter(this,void 0,void 0,function(){var e;return r.__generator(this,function(t){switch(t.label){case 0:return[4,u()()];case 1:return[2,(e=t.sent()).ConsumerSubscriptions?e.ConsumerSubscriptions.join(","):s]}})})}},843:function(e,t,n){"use strict";var r=n(6),a=n(25),i=n(53);function o(){return(!Object(i.u)()||!window.opener)&&(Object(r.e)("cal-time-panel")&&!Object(a.f)().SessionSettings.IsShadowMailbox)}var u=n(2),c=Object(u.action)("openTimePanel",function(e){return{source:e}}),s=Object(u.action)("popView");n.d(t,"a",function(){return o}),n.d(t,"b",function(){return c}),n.d(t,"c",function(){return s})},846:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(2),a=Object(r.action)("OPEN_QUICK_SETTINGS")},856:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(6),a=n(25),i=n(53);function o(){return(!Object(i.u)()||!window.opener)&&(Object(r.e)("todo-panel")&&!Object(r.e)("cal-time-panel")&&!Object(a.f)().SessionSettings.IsShadowMailbox)}}},0,[5,15,40,85,344,6,7,9,14,226,2,3,544,53,270,4,304,0,1,526,178,579,435,521,141,514,105,525,174,24,116,114,242,312,316,331,421,425]]);
//# sourceMappingURL=owa.MailSmartPill.js.map
self.scriptsLoaded['owa.MailSmartPill.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailSmartPill.js'] = (new Date()).getTime();