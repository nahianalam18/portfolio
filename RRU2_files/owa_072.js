self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.AccCheckerPlugin.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[99],{11736:function(t){t.exports={g:"mhb",h:"nhb",c:"ohb",d:"phb",b:"qhb",j:"rhb",k:"shb",e:"thb",f:"uhb",a:"vhb",i:"whb"}},11737:function(t,e,r){var o=r(11738),n=r(31);"string"==typeof o&&(o=[[t.i,o]]);for(var a=0;a<o.length;a++)n.loadStyles(o[a][1],!1);o.locals&&(t.exports=o.locals)},11738:function(t,e,r){(e=t.exports=r(30)(!1)).push([t.i,".WMdljJqO5VpCedHG6rPcu{font-size:17px;font-weight:300}html[dir] .WMdljJqO5VpCedHG6rPcu{padding-bottom:10px}._2xKfDR2FzdtzIJWrlTI6dc{font-size:12px;font-weight:400}html[dir] ._2xKfDR2FzdtzIJWrlTI6dc{padding-bottom:10px}._2QjYMmxcldgsfy0slqk828{height:32px}html[dir] ._2QjYMmxcldgsfy0slqk828{margin:10px 0 20px 0;border-radius:2px}",""]),e.locals={sectionHeader:"WMdljJqO5VpCedHG6rPcu",sectionMessage:"_2xKfDR2FzdtzIJWrlTI6dc",accCheckerButton:"_2QjYMmxcldgsfy0slqk828"}},177:function(t,e,r){"use strict";var o=r(7),n=(r(1),r(54)),a=r(481),i=r(3),c=new i.c(function(){return r.e(922).then(r.t.bind(null,13551,7))}),s=new i.b(c,function(t){return t.default}),u=r(25);function l(t){if("string"==typeof t||Array.isArray(t))return t;var e=Object(u.f)().UserOptions,r=(void 0===e?{}:e).KeyboardShortcutsMode;switch(void 0===r?"":r){case 0:return t.hotmail;case 2:return t.yahoo;case 3:return t.gmail;case 4:return t.owa;default:return}}function d(t,e){if(t.ctrlKey||t.altKey||t.metaKey||e)return!1;var r=t.target;return"INPUT"==r.tagName||"SELECT"==r.tagName||"TEXTAREA"==r.tagName||r.contentEditable&&"true"==r.contentEditable}var p="__keydownHandlerMap",h="__keydownHandlerHooksAdded";function b(t,e,r,i){return void 0===e&&(e=!0),void 0===r&&(r=!0),void 0===i&&(i=!1),function(c,u,b){if("object"==typeof window&&(c[p]=c[p]||{},c[p][u]={command:Object(a.a)(t),stopPropagation:e,preventDefault:r,allowHotkeyOnTextFields:i},!c[h])){var f=c.componentDidMount;c.componentDidMount=function(){var t=this;f&&f.call(this);var e,r=s.import(),a=function(){t.__mousetrap&&t.__mousetrap.reset(),e&&e()},i=r.then(function(r){t.__mousetrap=new r(n.findDOMNode(t)),e=Object(o.autorun)(function(t){var e=this;this.__mousetrap.reset();for(var r=t[p],o=Object.keys(r),n=function(n){var i=o[n],c=l(r[i].command);c&&a.__mousetrap.bind(c,function(o){d(o,r[i].allowHotkeyOnTextFields)||(r[i].stopPropagation&&o.stopPropagation(),r[i].preventDefault&&o.preventDefault(),t[i].call(e,o))})},a=this,i=0;i<o.length;i++)n(i)}.bind(t,c))}).catch(a);this.__cleanupMousetrap=i.then(function(){return a})};var g=c.componentWillUnmount;c.componentWillUnmount=function(){g&&g.call(this),this.__cleanupMousetrap&&this.__cleanupMousetrap.then(function(t){return t()})},c[h]=!0}}}var f=r(0);function g(t,e,r){var n=void 0===r?{}:r,i=n.allowHotkeyOnTextFields,c=void 0!==i&&i,u=n.isEnabled,d=n.stopPropagation,p=void 0===d||d,h=n.preventDefault,b=void 0===h||h;return f.__awaiter(this,void 0,void 0,function(){var r,n,i,d;return f.__generator(this,function(h){switch(h.label){case 0:return[4,s.import()];case 1:return r=h.sent(),n=new r(document.body),i=function(t){return l(t=Object(a.a)(t))}(t),d=Object(o.autorun)(function(){!function(t,e,r){t.reset(),e&&t.bind(e,r)}(n,i,m(c,u,p,b,e))}),[2,function(){n.reset(),d()}]}})})}function m(t,e,r,o,n){return function(a){d(a,t)||e&&!e()||(r&&a.stopPropagation(),o&&a.preventDefault(),n())}}r.d(e,"c",function(){return b}),r.d(e,"a",function(){return g}),r.d(e,"b",function(){return a.a})},4023:function(t,e,r){"use strict";r.d(e,"b",function(){return a}),r.d(e,"a",function(){return i});var o=r(3),n=new o.c(function(){return Promise.all([r.e(2),r.e(233)]).then(r.bind(null,4884))}),a=new o.a(n,function(t){return t.mountAndShowFlexPane}),i=new o.a(n,function(t){return t.hideFlexPane})},481:function(t,e,r){"use strict";var o=r(125);function n(t,e){return t?e(t):t}function a(t){return t.replace(/\bctrl\b/,"command")}var i=[function(t){if(Array.isArray(t)){if(t.includes("del"))return t.concat("backspace")}else if("del"===t)return["del","backspace"];return t},function(t){return Array.isArray(t)?t.map(a):a(t)}];function c(t){return Object(o.j)()?function(t,e){return Array.isArray(t)||"string"==typeof t?e.reduce(function(t,e){return e(t)},t):{hotmail:e.reduce(function(t,e){return n(t,e)},t.hotmail),owa:e.reduce(function(t,e){return n(t,e)},t.owa),gmail:e.reduce(function(t,e){return n(t,e)},t.gmail),yahoo:e.reduce(function(t,e){return n(t,e)},t.yahoo)}}(t,i):t}r.d(e,"a",function(){return c})},615:function(t,e,r){"use strict";r.d(e,"b",function(){return a}),r.d(e,"a",function(){return i});var o=r(13),n=r(427);function a(t){var e,r,n,a,i=t.semanticColors,c=t.palette,s=i.buttonBackground,u=i.buttonBackgroundPressed,l=i.buttonBackgroundHovered,d=i.buttonText,p=i.buttonTextHovered,h=i.buttonTextChecked,b=i.buttonTextCheckedHovered;return{root:{backgroundColor:s,color:d},rootHovered:{backgroundColor:l,color:p,selectors:(e={},e[o.HighContrastSelector]={borderColor:"Highlight",color:"Highlight"},e)},rootPressed:{backgroundColor:u,color:h},rootExpanded:{backgroundColor:u,color:h},rootChecked:{backgroundColor:u,color:h},rootCheckedHovered:{backgroundColor:u,color:b},rootDisabled:{selectors:(r={},r[o.HighContrastSelector]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},r)},splitButtonContainer:{selectors:(n={},n[o.HighContrastSelector]={border:"none"},n)},splitButtonMenuButton:{color:c.white,backgroundColor:"transparent",selectors:{":hover":{backgroundColor:c.neutralLight,selectors:(a={},a[o.HighContrastSelector]={color:"Highlight"},a)}}},splitButtonMenuButtonDisabled:{backgroundColor:i.buttonBackgroundDisabled,selectors:{":hover":{backgroundColor:i.buttonBackgroundDisabled}}},splitButtonDivider:{backgroundColor:c.neutralTertiaryAlt},splitButtonDividerDisabled:{backgroundColor:t.palette.neutralTertiaryAlt},splitButtonMenuButtonChecked:{backgroundColor:c.neutralQuaternaryAlt,selectors:{":hover":{backgroundColor:c.neutralQuaternaryAlt}}},splitButtonMenuButtonExpanded:{backgroundColor:c.neutralQuaternaryAlt,selectors:{":hover":{backgroundColor:c.neutralQuaternaryAlt}}},splitButtonMenuIcon:{color:i.buttonText},splitButtonMenuIconDisabled:{color:i.buttonTextDisabled}}}function i(t){var e,r,a,i,c,s,u,l,d=t.palette,p=t.semanticColors;return{root:{backgroundColor:p.primaryButtonBackground,color:p.primaryButtonText,border:"none",selectors:(e={},e[o.HighContrastSelector]={color:"Window",backgroundColor:"WindowText",MsHighContrastAdjust:"none"},e["."+n.a+" &:focus"]={selectors:{":after":{outline:"none",borderColor:d.white}}},e)},rootHovered:{backgroundColor:p.primaryButtonBackgroundHovered,color:p.primaryButtonTextHovered,selectors:(r={},r[o.HighContrastSelector]={color:"Window",backgroundColor:"Highlight"},r)},rootPressed:{backgroundColor:p.primaryButtonBackgroundPressed,color:p.primaryButtonTextPressed,selectors:(a={},a[o.HighContrastSelector]={color:"Window",backgroundColor:"WindowText",MsHighContrastAdjust:"none"},a)},rootExpanded:{backgroundColor:p.primaryButtonBackgroundPressed,color:p.primaryButtonTextPressed},rootChecked:{backgroundColor:p.primaryButtonBackgroundPressed,color:p.primaryButtonTextPressed},rootCheckedHovered:{backgroundColor:p.primaryButtonBackgroundPressed,color:p.primaryButtonTextPressed},rootDisabled:{selectors:(i={},i[o.HighContrastSelector]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},i)},splitButtonContainer:{selectors:(c={},c[o.HighContrastSelector]={border:"none"},c)},splitButtonDivider:{backgroundColor:d.neutralTertiaryAlt},splitButtonMenuButton:{backgroundColor:p.primaryButtonBackground,color:p.primaryButtonText,selectors:{":hover":{backgroundColor:p.primaryButtonBackgroundHovered,selectors:(s={},s[o.HighContrastSelector]={color:"Highlight"},s)}}},splitButtonMenuButtonDisabled:{backgroundColor:p.primaryButtonBackgroundDisabled,selectors:{":hover":{backgroundColor:p.primaryButtonBackgroundDisabled}}},splitButtonMenuButtonChecked:{backgroundColor:p.primaryButtonBackgroundPressed,selectors:{":hover":{backgroundColor:p.primaryButtonBackgroundPressed}}},splitButtonMenuButtonExpanded:{backgroundColor:p.primaryButtonBackgroundPressed,selectors:{":hover":{backgroundColor:p.primaryButtonBackgroundPressed}}},splitButtonMenuIcon:{color:p.primaryButtonText,selectors:(u={},u[o.HighContrastSelector]={color:"Window"},u)},splitButtonMenuIconDisabled:{color:d.neutralTertiary,selectors:(l={},l[o.HighContrastSelector]={color:"GrayText"},l)}}}},6557:function(t,e,r){"use strict";r.r(e);var o=r(0),n=r(8),a=Object(n.action)("addOrRemoveAccCheckerError")(function(t,e,r){var o=t.errors.indexOf(e);r?o<0&&t.errors.push(e):o>=0&&t.errors.splice(o,1)}),i=r(11736),c=r(4),s=Object(n.action)("resetAccCheckerViewState")(function(t){t.isOpen=!1,t.errors=[]}),u=Object(n.action)("setAccCheckerPaneIsOpen")(function(t,e){t.isOpen=e}),l=r(19),d=r(888),p=r(4023),h=r(177),b=r(1),f=r(11737),g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.setScrollRegionRef=function(t){t&&t.parentElement&&(e.scrollRegion=t.parentElement,e.scrollRegion.style.marginTop="10px",e.scrollRegion.style.paddingTop="0px")},e}return o.__extends(e,t),e.prototype.render=function(){return this.props.viewState?b.createElement("div",{ref:this.setScrollRegionRef},this.renderNoIssuesFoundSection(),this.renderImageAltSection(),this.renderTableHeaderRowSection(),this.renderIssuesFoundSection(),this.renderButtonSection()):null},e.prototype.UNSAFE_componentWillUpdate=function(){this.scrollRegion&&(this.scrollRegion.scrollTop=0)},e.prototype.componentWillUnmount=function(){s(this.props.viewState)},e.prototype.onClose=function(t){this.props.viewState.isOpen&&(t.stopPropagation(),p.a.importAndExecute())},e.prototype.renderNoIssuesFoundSection=function(){return 0==this.props.viewState.errors.length&&b.createElement("div",null,b.createElement("div",{className:f.sectionHeader},Object(c.a)(i.g)),b.createElement("div",{className:f.sectionMessage},Object(c.a)(i.h)))},e.prototype.renderImageAltSection=function(){var t=this.props,e=t.viewState,r=t.fixImageAltText;return e.errors.indexOf(0)>=0&&b.createElement("div",null,b.createElement("div",{className:f.sectionHeader},Object(c.a)(i.c)),b.createElement("div",{className:f.sectionMessage},Object(c.a)(i.d)),b.createElement(d.a,{onClick:r,className:f.accCheckerButton},Object(c.a)(i.b)))},e.prototype.renderTableHeaderRowSection=function(){var t=this.props,e=t.viewState,r=t.fixTableHeaderRow;return e.errors.indexOf(1)>=0&&b.createElement("div",null,b.createElement("div",{className:f.sectionHeader},Object(c.a)(i.j)),b.createElement("div",{className:f.sectionMessage},Object(c.a)(i.k)),b.createElement(d.a,{onClick:r,className:f.accCheckerButton},Object(c.a)(i.b)))},e.prototype.renderIssuesFoundSection=function(){return this.props.viewState.errors.length>0&&b.createElement("div",null,b.createElement("div",{className:f.sectionHeader},Object(c.a)(i.e)),b.createElement("div",{className:f.sectionMessage},Object(c.a)(i.f)))},e.prototype.renderButtonSection=function(){var t=this.props.runChecker;return b.createElement(d.a,{onClick:t,className:f.accCheckerButton},Object(c.a)(i.a))},o.__decorate([Object(h.c)("escape")],e.prototype,"onClose",null),e=o.__decorate([l.observer],e)}(b.Component),m=g;function v(t,e,r,n,a){return o.__awaiter(this,void 0,void 0,function(){return o.__generator(this,function(o){return u(t,!0),a&&p.b.importAndExecute(b.createElement(g,{viewState:t,runChecker:e,fixImageAltText:r,fixTableHeaderRow:n}),{headerText:function(){return Object(c.a)(i.i)},overlayOnSmallWidth:!1}),[2]})})}var k=r(4189),C=r(3849),y=new RegExp("\\w*\\.\\w+","g"),x="alt",B=function(){function t(t,e){var r=this;void 0===e&&(e=!0),this.adapter=t,this.useFlexPane=e,this.closeChecker=function(){p.a.importAndExecute()},this.openChecker=function(){return o.__awaiter(r,void 0,void 0,function(){return o.__generator(this,function(t){switch(t.label){case 0:return this.runChecker(),[4,v(this.adapter(),this.runChecker,this.fixImageAltText,this.fixTableHeaderRow,this.useFlexPane)];case 1:return t.sent(),[2]}})})},this.runChecker=function(){if(r.editor){var t=r.adapter();a(t,0,r.hasImageAltTextErrors()),a(t,1,r.hasTableHeaderRowErrors())}},this.fixImageAltText=function(){return o.__awaiter(r,void 0,void 0,function(){var t,e,r=this;return o.__generator(this,function(o){switch(o.label){case 0:return t=this.imagesWithAltTextErrors.pop(),[4,C.f.import()];case 1:e=o.sent(),o.label=2;case 2:return t?[4,e(t,function(e){t.setAttribute(x,e)},function(){r.imagesWithAltTextErrors=[]})]:[3,4];case 3:return o.sent(),t=this.imagesWithAltTextErrors.pop(),[3,2];case 4:return this.runChecker(),[2]}})})},this.fixTableHeaderRow=function(){return o.__awaiter(r,void 0,void 0,function(){var t;return o.__generator(this,function(e){switch(e.label){case 0:t=this.tablesWithoutHeaderRows.pop(),e.label=1;case 1:return t?[4,k.c.import()]:[3,3];case 2:return e.sent()(this.editor,t,!1),t=this.tablesWithoutHeaderRows.pop(),[3,1];case 3:return this.runChecker(),[2]}})})},this.imagesWithAltTextErrors=[],this.tablesWithoutHeaderRows=[]}return t.prototype.getName=function(){return"AccChecker"},t.prototype.initialize=function(t){this.editor=t},t.prototype.dispose=function(){var t=this.adapter();t&&t.isOpen&&p.a.importAndExecute(),this.imagesWithAltTextErrors=null,this.tablesWithoutHeaderRows=null},t.prototype.hasImageAltTextErrors=function(){var t=this,e=!1;return this.imagesWithAltTextErrors=[],this.editor.queryElements("img",function(r){var o=r.getAttribute(x);t.hasPresentationRole(r)||(Object(c.g)(o)||null!=o.match(y))&&(e=!0,t.imagesWithAltTextErrors.push(r))}),e},t.prototype.hasTableHeaderRowErrors=function(){var t=this,e=!1;return this.editor.queryElements("table",function(r){var o=r.querySelectorAll("th");t.hasPresentationRole(r)||0==o.length&&(e=!0,t.tablesWithoutHeaderRows.push(r))}),e},t.prototype.hasPresentationRole=function(t){var e=t.getAttribute("role");return e&&"presentation"==e},t}();r.d(e,"AccCheckerPlugin",function(){return B}),r.d(e,"AccCheckerPane",function(){return m})},888:function(t,e,r){"use strict";var o=r(0),n=r(1),a=r(277),i=r(274),c=r(886),s=r(13),u=r(244),l=r(276),d=r(340),p=r(615),h=Object(u.b)(function(t,e,r){var o=Object(l.a)(t),n=Object(d.a)(t),a={root:{minWidth:"80px",height:"32px"},label:{fontWeight:s.FontWeights.semibold}};return Object(s.concatStyleSets)(o,a,r?Object(p.a)(t):Object(p.b)(t),n,e)});r.d(e,"a",function(){return b});var b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._skipComponentRefResolution=!0,e}return o.__extends(e,t),e.prototype.render=function(){var t=this.props,e=t.primary,r=void 0!==e&&e,c=t.styles,s=t.theme;return n.createElement(a.a,o.__assign({},this.props,{variantClassName:r?"ms-Button--primary":"ms-Button--default",styles:h(s,c,r),onRenderDescription:i.b}))},e=o.__decorate([Object(c.a)("DefaultButton",["theme","styles"],!0)],e)}(i.a)}},0,[4,10,15,17,273,50,215,2,233]]);
//# sourceMappingURL=owa.AccCheckerPlugin.js.map
self.scriptsLoaded['owa.AccCheckerPlugin.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.AccCheckerPlugin.js'] = (new Date()).getTime();