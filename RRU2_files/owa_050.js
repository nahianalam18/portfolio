self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.ExpandedListSelectionActions.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[212],{13836:function(e,t,n){"use strict";n.r(t);var a=n(4),o=n(7),i=n(12),r=n(160),s=n(3907),d=n(11);function c(e,t){var n=function(e){var t={},n=r.a.conversationNodes.get(e);for(;n;){if(t[n.internetMessageId]){d.d.error("Invalid loop found in ParentInternetMessageId pointers");break}if(Object(s.b)(n.internetMessageId)&&(t[n.internetMessageId]=!0),Object(a.g)(n.parentInternetMessageId))break;n=r.a.conversationNodes.get(n.parentInternetMessageId)}return t}(e);if(1===Object.keys(n).length)return function(e,t){var n=new o.ObservableMap({});return t.forEach(function(t){var a=r.a.conversationNodes.get(t),o=t===e?i.a.CheckMark:i.a.None;n.set(a.internetMessageId,o)}),n}(e,t);for(var c=new o.ObservableMap({}),u=!1,v=!1,l=0,p=0;p<t.length;p++){var w=r.a.conversationNodes.get(t[p]);n[w.internetMessageId]?(u?l+1===Object.keys(n).length?(c.set(w.internetMessageId,i.a.BusEnd),v=!0):c.set(w.internetMessageId,i.a.BusStop):(c.set(w.internetMessageId,i.a.BusStart),u=!0),l++):!u||v?c.set(w.internetMessageId,i.a.None):c.set(w.internetMessageId,i.a.NoStop)}return c}var u=n(275),v=n(80),l=n(6702),p=n(37),w=n(2);function b(){v.a.expandedConversationViewState.expandedRowKey=null,v.a.expandedConversationViewState.selectedNodeIds=[],v.a.expandedConversationViewState.shouldBeExpanded=!1,v.a.expandedConversationViewState.busStopStateMap=new o.ObservableMap({})}Object(w.mutator)(u.t,function(e){var t=e.nodeId,n=e.allNodeIds,a=v.a.expandedConversationViewState.selectedNodeIds;a.indexOf(t)>-1?(a.splice(a.indexOf(t),1),1===a.length&&(v.a.expandedConversationViewState.busStopStateMap=c(a[0],n))):a.push(t)}),Object(w.mutator)(u.h,function(e){v.a.expandedConversationViewState.busStopStateMap=new o.ObservableMap({})}),Object(w.mutator)(u.q,function(e){var t=e.rowKey,n=e.nodeIdToSelect,a=e.allNodeIds;v.a.expandedConversationViewState.expandedRowKey=t,v.a.expandedConversationViewState.selectedNodeIds=[n],v.a.expandedConversationViewState.busStopStateMap=c(n,a)}),Object(w.mutator)(u.u,function(e){var t=v.a.expandedConversationViewState;e.mailListItemSelectionSource==p.e.MailListItemCheckbox&&t.expandedRowKey!=e.rowKey&&b()}),Object(w.mutator)(u.p,function(e){var t=v.a.expandedConversationViewState;e.shouldSelect||t.expandedRowKey!=e.rowKey||b()}),Object(w.mutator)(u.i,function(e){b()}),Object(w.mutator)(u.k,function(e){b()}),Object(w.mutator)(u.r,function(e){var t=v.a.expandedConversationViewState;e.mailListItemSelectionSource==p.e.MailListItemTwisty&&t.expandedRowKey!=e.rowKey&&(t.expandedRowKey=e.rowKey,t.shouldBeExpanded=!0)}),Object(w.mutator)(u.o,function(e){v.a.expandedConversationViewState.shouldBeExpanded=e.shouldBeExpanded}),Object(w.mutator)(l.a,function(e){if(1===v.a.expandedConversationViewState.selectedNodeIds.length){var t=v.a.expandedConversationViewState.selectedNodeIds[0],n=p.H.conversations.get(e.conversationId).conversationNodeIds;v.a.expandedConversationViewState.busStopStateMap=c(t,n)}});var I=n(0),f=n(2062),O=n(703),S=n(289);Object(w.orchestrator)(u.b,function(e){m(e.itemId,e.tableView,e.nodeId,e.allNodeIds,p.e.MailListItemExpansion)});function m(e,t,n,a,o){Object(O.f)(t,!0,o),S.k.importAndExecute(e),u.q(i.O.expandedConversationViewState.expandedRowKey,n,a,t.id)}function x(e,t){var n,a,o=i.b.getConversationId(e,t),r=p.H.conversations.get(o);try{for(var d=I.__values(r.conversationNodeIds),c=d.next();!c.done;c=d.next()){var u=c.value,v=Object(s.b)(u);if(v){m(v.ItemId.Id,t,u,r.conversationNodeIds,p.e.RowRemoval);break}}}catch(e){n={error:e}}finally{try{c&&!c.done&&(a=d.return)&&a.call(d)}finally{if(n)throw n.error}}}function j(){u.i()}Object(w.orchestrator)(u.e,function(e){if(e.mailListItemSelectionSource==p.e.MailListItemTwisty){if(1==e.listViewType)throw new Error("Toggle expansion action cannot be called from message view");var t,n;Object(f.a)(e.rowKey)?j():(t=e.rowKey,n=e.tableView,u.o(!1),x(t,n))}}),Object(w.orchestrator)(u.c,function(e){Object(f.a)(e.rowKey)&&j()}),Object(w.orchestrator)(u.m,function(e){for(var t=i.b.getConversationId(e.rowKey,e.tableView),n=p.H.conversations.get(t),a=null,o=null,r=n.conversationNodeIds.indexOf(i.O.expandedConversationViewState.selectedNodeIds[0])+1;r<n.conversationNodeIds.length;r++){var d=n.conversationNodeIds[r],c=Object(s.b)(d);if(c){o=c.ItemId.Id,a=d;break}}a?m(o,e.tableView,a,n.conversationNodeIds,p.e.RowRemoval):x(e.rowKey,e.tableView)});var g=n(6091),V=n(6116),C=(Object(w.orchestrator)(V.a,function(e){Object(g.a)(),1===Object(i.E)().expandedConversationViewState.selectedNodeIds.length&&u.h()}),n(7398)),N=n(616);Object(w.orchestrator)(C.a,function(e){if(i.O.expandedConversationViewState.expandedRowKey){var t=p.H.conversations.get(e.conversationId);u.q(i.O.expandedConversationViewState.expandedRowKey,e.conversationNodeId,t.conversationNodeIds,Object(N.a)())}})},6091:function(e,t,n){"use strict";var a=n(0),o=n(4418),i=n(2127),r=n(1407),s=n(535),d=n(299),c=n(1140),u=n(8),v=n(12);t.a=Object(u.select)({composeViewState:function(){return d.a.viewStates.get(d.a.primaryComposeId)},conversationItems:function(){return v.O.conversationItems}})(Object(u.action)("reloadReadingPane")(function(e){var t=Object(v.C)(),n=t?a.__spread(t.selectedRowKeys.keys()):[];if(1==n.length){var d=v.b.getRowClientItemId(n[0],t),u=Object(c.a)(n,t)[0];switch(t.tableQuery.listViewType){case 0:var l=e.conversationItems.get(d.Id);e.composeViewState&&e.composeViewState.isInlineCompose?s.z.importAndExecute(e.composeViewState).then(function(){Object(o.b)(d,u,l.subject)}):Object(o.b)(d,u,l.subject);break;case 1:e.composeViewState&&e.composeViewState.isInlineCompose?s.z.importAndExecute(e.composeViewState).then(function(){Object(i.a)(d,u,r.a)}):Object(i.a)(d,u,r.a)}}}))},6116:function(e,t,n){"use strict";var a=n(2),o=Object(a.action)("ON_CONVERSATION_OPTION_SAVED");t.a=o},6702:function(e,t,n){"use strict";var a=n(2);t.a=Object(a.action)("UPDATE_LOADED_CONVERSATION_READING_PANE",function(e,t){return{conversationId:e,nodeIdCollectionChanged:t}})},7398:function(e,t,n){"use strict";var a=n(2);t.a=Object(a.action)("ON_ITEM_PART_SELECTED",function(e,t){return{conversationNodeId:e,conversationId:t}})}},0,[2,4,8,15,378,5,40,85,344,6,7,9,10,125,3,304,23,328,0,1,526,178,12,47,121,521,141,514,105,525,174,24,116,312,331,425]]);
//# sourceMappingURL=owa.ExpandedListSelectionActions.js.map
self.scriptsLoaded['owa.ExpandedListSelectionActions.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.ExpandedListSelectionActions.js'] = (new Date()).getTime();