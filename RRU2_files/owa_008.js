self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.642.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[642],{1183:function(e,t,n){"use strict";var r=n(12),a=n(37);function i(e,t){var n;switch(t){case 0:n=a.c;break;case 1:n=Object(a.q)()}return{categoryName:null,folderId:e,focusedViewFilter:-1,listViewType:t,viewFilter:"All",sortBy:r.c.getDefaultSortBy(),requestShapeName:n,type:2,shouldTryToUseSessionDataResponse:!1,scenarioType:"group",inboxClassificationFilter:0}}var o=n(10);function c(){var e=Object(o.a)().UserOptions.GlobalListViewTypeReact;return null==e?0:e}n.d(t,"a",function(){return i}),n.d(t,"b",function(){return c})},13760:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(12),i=n(1034),o=n(80),c=n(305),d=n(2),u=Object(d.mutatorAction)("removeSingleItemFromConversation",function(e,t){var n,i,c=o.a.tableViews.get(t),d=Object(a.B)([e.itemConversationId.Id],c);try{for(var u=r.__values(d),s=u.next();!s.done;s=u.next()){l(s.value,e,t)}}catch(e){n={error:e}}finally{try{s&&!s.done&&(i=u.return)&&i.call(u)}finally{if(n)throw n.error}}});function l(e,t,n){var r=Object(i.a)(t.itemConversationId.Id),a=Object(c.a)(e,n),o=a.itemIds.indexOf(t.itemId);o>=0&&(a.itemIds.splice(o,1),t.isRead||a.unreadCount--),(o=r.globalItemIds.indexOf(t.itemId))>=0&&(r.globalItemIds.splice(o,1),t.isRead||r.globalUnreadCount--),(o=a.draftItemIds.indexOf(t.itemId))>=0&&a.draftItemIds.splice(o,1)}var s=n(1458),f=n(310),b=n(873),v=n(3),m=n(1701),O=Object(v.e)(b.a,"clone_deleteItemsStoreUpdate",function(e){var t,n,a=e.itemContexts[0],i=Object(s.a)(a&&a.mailboxInfo,e.parentFolderId,!0);try{for(var o=r.__values(i),c=o.next();!c.done;c=o.next()){var d=c.value;1==d.tableQuery.listViewType?w(e.itemContexts,d):0==d.tableQuery.listViewType&&I(e.itemContexts,d)}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}});function w(e,t){var n=e.map(function(e){return e.itemId}),r=Object(a.B)(n,t),i=r.filter(function(e){return t.rowKeys.indexOf(e)>=0});0!=i.length&&(Object(m.a)(i,t),p(t,r))}function I(e,t){var n,i,o,d;try{for(var l=r.__values(e),s=l.next();!s.done;s=l.next()){var f=s.value,b=Object(a.B)([f.itemConversationId.Id],t);try{for(var v=(o=void 0,r.__values(b)),O=v.next();!O.done;O=v.next()){var w=O.value,I=Object(c.a)(w,t.id);I&&(1==I.itemIds.length&&I.itemIds[0]==f.itemId?(Object(m.a)([w],t),p(t,[w])):u(f,t.id))}}catch(e){o={error:e}}finally{try{O&&!O.done&&(d=v.return)&&d.call(v)}finally{if(o)throw o.error}}}}catch(e){n={error:e}}finally{try{s&&!s.done&&(i=l.return)&&i.call(l)}finally{if(n)throw n.error}}}function p(e,t){0!==e.tableQuery.type&&2!==e.tableQuery.type||f.a.add(t,e.serverFolderId,3)}var j=n(1743),y=n(2729),S=n(275),h=n(2192),g=Object(v.e)(S.f,"clone_mailListItemExpansionOrchestrator",function(e){var t=Object(o.b)().expandedConversationViewState,n=t.selectedNodeIds;n&&-1!=n.indexOf(e.nodeId)||S.q(t.expandedRowKey,e.nodeId,e.allNodeIds,e.tableViewId),Object(j.b)(e.contextMenuAnchor,h.a.All,y.a.MailListItemPart)}),V=n(1146),R=n(1940),x=n(126),P=n(841),C=n(223),T=n(256),F=n(318),_=n(568),A=n(145),M=n(8);var U=Object(M.select)({tableViews:function(){return a.O.tableViews}})(function(e,t,n,r,i){var o=i.tableViews.get(t);0===o.tableQuery.type&&(f.a.add(e,o.serverFolderId,1),function(e,t){var n=e[e.length-1];if(t.selectedRowKeys.has(n)){var r=t.rowKeys.indexOf(n);r<t.rowKeys.length-1?Object(x.l)(t,t.rowKeys[r+1],!1,A.a.RowRemoval):Object(x.h)(t,A.a.Reset)}}(e,o)),Object(a.z)(e,t).forEach(function(e){i.tableViews.forEach(function(i){i.tableQuery.folderId==o.tableQuery.folderId&&Object(a.B)([e],i).forEach(function(e){(r(e,i.id,n),0===i.tableQuery.type)&&(Object(C.l)(i,2),function(e,t,n,r,a){var i,o=Object(V.a)(r,n);if(o<0)throw new Error("Row being pinned / unpinnned must exist in the list");var c=a?0:o+1;return o<(i=!a&&Object(_.e)(r,n.id)?Object(T.f)(n,c):Object(R.a)(e,t,n,c,!a))&&i--,-1==i?(Object(P.a)([r],n),!1):(F.a.updateRowPosition(i,r,n),!0)}(a.b.getLastDeliveryOrRenewTimeStamp(e,i),a.b.getLastDeliveryTimeStamp(e,i),i,e,n)||i.id!=t||f.a.add([e],o.serverFolderId,3))})})})}),k=n(1688),L=n(499),B=Object(v.e)(k.a,"clone_markConversationsAsPinnedStoreUpdate",function(e){var t=e.rowKeys,n=e.tableViewId,r=e.shouldMarkAsPinned;U(t,n,r,Q)});function Q(e,t,n){var r=Object(c.a)(e,t);if(r)if(n){var a=Object(L.d)();a&&(r.lastDeliveryOrRenewTimeStamp=a)}else r.lastDeliveryOrRenewTimeStamp=r.lastDeliveryTimeStamp}var E=n(1949),D=n(1237),K=Object(v.e)(D.a,"clone_markConversationAsReadStoreUpdate",function(e){var t=e.conversationIds,n=e.tableViewId,r=e.isReadValue,i=e.isExplicit,o=a.O.tableViews.get(n),c=Object(a.B)(t,o);Object(E.a)(c,r,o,!0),Object(a.Q)(o,r,i)?(f.a.add(c,o.serverFolderId,3),Object(P.a)(c,o)):f.a.add(c,o.serverFolderId,2)}),N=n(1687),q=n(37),z=Object(v.e)(N.a,"clone_markItemsAsPinnedStoreUpdate",function(e){var t=e.rowKeys,n=e.tableViewId,r=e.shouldMarkAsPinned;U(t,n,r,G)});function G(e,t,n){var r=Object(a.G)(e,t);if(r){var i=q.H.items.get(r.clientId.Id);if(n){var o=Object(L.d)();o&&(i.ReceivedOrRenewTime=o)}else i.ReceivedOrRenewTime=i.DateTimeReceived}}var H=n(1950),$=n(1238),J=Object(v.e)($.a,"clone_markItemsAsReadStoreUpdateOrchestrator",function(e){var t=e.itemIds,n=e.isReadValue,r=e.isExplicit,i=e.tableViewId,o=a.O.tableViews.get(i);if(o){Object(H.a)(o,t,n);var c=[],d=Object(a.Q)(o,n,r);1==o.tableQuery.listViewType?c=Object(a.B)(t,o):t.forEach(function(e){var t=q.H.items.get(e).ConversationId.Id,n=Object(a.B)([t],o);n.forEach(function(e){var t=Object(a.F)(e,i);d&&0!=t.unreadCount||n.push(e)})}),0!=c.length&&(d?(f.a.add(c,o.serverFolderId,3),Object(P.a)(c,o)):f.a.add(c,o.serverFolderId,2))}}),W=n(1183),X=n(362),Y=n(289),Z=n(449),ee=n(1928),te=n(536),ne=n(20),re=Object(v.e)(ee.a,"clone_onListViewTypeOptionSavedOrchestrator",function(e){return r.__awaiter(void 0,void 0,void 0,function(){var t,n,a,i,o;return r.__generator(this,function(r){if(t=e.newListViewType,n=Object(X.a)().tableQuery,a=Object(te.a)(),i=a&&a.treeType,1===n.type||i===ne.c||i===ne.l)return[2];switch(o=2===n.type?Object(W.a)(n.folderId,t):Object(C.c)(n.folderId,t,n.scenarioType,n.focusedViewFilter,n.viewFilter,n.categoryName,n.sortBy,n.inboxClassificationFilter),Object(Z.d)(o),t){case 0:Y.n.itemReadingPaneViewState=null;break;case 1:Y.n.conversationReadingPaneViewState=null}return[2]})})}),ae=n(1456),ie=n(229),oe=n(369),ce=Object(v.e)(ie.p,"clone_removeSearchTableFromStore",function(e){Object(ae.a)(e.tableViewId)}),de=Object(v.e)(oe.q,"clone_removeSearchTableFromStoreNext",function(e){Object(ae.a)(e.tableViewId)});n.d(t,"deleteItemsStoreUpdateOrchestrator",function(){return O}),n.d(t,"mailListItemExpansionOrchestrators",function(){return g}),n.d(t,"markConversationsAsPinnedStoreUpdateOrchestrator",function(){return B}),n.d(t,"markConversationsAsReadStoreUpdateOrchestrator",function(){return K}),n.d(t,"markItemsAsPinnedStoreUpdateOrchestrator",function(){return z}),n.d(t,"markItemsAsReadStoreUpdateOrchestrator",function(){return J}),n.d(t,"onListViewTypeOptionSavedOrchestrator",function(){return re}),n.d(t,"removeSearchTableFromStoreOrchestrator",function(){return ce}),n.d(t,"removeSearchTableFromStoreNextOrchestrator",function(){return de})},1407:function(e,t,n){"use strict";var r=n(493),a=n(8);t.a=Object(a.action)("setItemReadingPaneViewState")(function(e){r.a.itemReadingPaneViewState=e})},1409:function(e,t,n){"use strict";var r=n(493),a=n(8);t.a=Object(a.action)("setItemPrintPaneViewState")(function(e){r.a.itemPrintPaneViewState=e})},1743:function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return o});var r=n(80),a=n(8),i=Object(a.action)("showMailItemContextMenu")(Object(a.select)({listViewStore:function(){return r.a}})(function(e,t,n,r){r.listViewStore.itemContextMenuState={anchor:e,menuType:t,menuSource:n}})),o=Object(a.action)("hideMailItemContextMenu")(Object(a.select)({listViewStore:function(){return r.a}})(function(e){e.listViewStore.itemContextMenuState=null}))},2192:function(e,t,n){"use strict";var r;!function(e){e[e.All=0]="All",e[e.MoveTo=1]="MoveTo",e[e.Categorize=2]="Categorize"}(r||(r={})),t.a=r},2729:function(e,t,n){"use strict";var r;!function(e){e[e.MailListItem=0]="MailListItem",e[e.MailListItemPart=1]="MailListItemPart"}(r||(r={})),t.a=r},289:function(e,t,n){"use strict";n.d(t,"d",function(){return u}),n.d(t,"a",function(){return l}),n.d(t,"l",function(){return s}),n.d(t,"m",function(){return f}),n.d(t,"h",function(){return b}),n.d(t,"e",function(){return v}),n.d(t,"i",function(){return m}),n.d(t,"k",function(){return O}),n.d(t,"f",function(){return w}),n.d(t,"g",function(){return I}),n.d(t,"b",function(){return j}),n.d(t,"c",function(){return y}),n.d(t,"j",function(){return S});var r=n(3),a=n(873),i=n(1237),o=n(1238),c=(n(1407),n(1409),n(493));n.d(t,"n",function(){return c.a});var d=new r.c(function(){return Promise.all([n.e(2),n.e(4),n.e(8),n.e(15),n.e(378)]).then(n.bind(null,2583))}),u=new r.a(d,function(e){return e.loadConversationReadingPane}),l=(new r.a(d,function(e){return e.reloadReadingPane}),new r.a(d,function(e){return e.applyConversationFlagInReadingPane})),s=new r.a(d,function(e){return e.updateLoadedConversation}),f=new r.a(d,function(e){return e.updateOnItemMandatoryPropertiesChange}),b=new r.a(d,function(e){return e.moveReadingPaneToTab}),v=new r.a(d,function(e){return e.loadConversationReadingPaneForSingleMailItemSelected}),m=new r.a(d,function(e){return e.print}),O=new r.a(d,function(e){return e.setItemIdToScrollTo}),w=new r.a(d,function(e){return e.loadItemReadingPane}),I=new r.a(d,function(e){return e.loadItemReadingPaneForSingleMailItemSelected}),p=new r.a(d,function(e){return e.initializeStitches});Object(r.f)(a.a,d,function(e){return e.deleteItemsStoreUpdateOrchestrator}),Object(r.f)(i.a,d,function(e){return e.markConversationsAsReadStoreUpdateOrchestrator}),Object(r.f)(o.a,d,function(e){return e.markItemsAsReadStoreUpdateOrchestrator});var j=new r.b(d,function(e){return e.getLastestNonDraftItemId}),y=new r.b(d,function(e){return e.isUnsupportedItem}),S=(new r.a(d,function(e){return e.setCalendarInlineComposeViewState}),new r.a(d,function(e){return e.replyByMeeting}));p.importAndExecute()},493:function(e,t,n){"use strict";n.d(t,"b",function(){return i});var r=n(730),a=n(2),i=Object(a.createStore)("readingpane",{conversationReadingPaneViewState:null,floatingActionBarViewState:{isVisible:!1,itemId:""},itemReadingPaneViewState:null,itemPreviewPaneViewState:null,itemPrintPaneViewState:null,deeplinkId:null}),o=i();r.a.registerReference(function(){return o.conversationReadingPaneViewState&&o.conversationReadingPaneViewState.conversationId.Id}),t.a=o}},0,[2,4,8,15,378,5,40,85,344,6,7,9,10,125,3,322,323,23,328,571,399,573,404,0,1,526,178,12,47,121,514,105,525,174,557,335,24,116,221,291,312,321,495]]);
//# sourceMappingURL=owa.642.js.map
self.scriptsLoaded['owa.642.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.642.js'] = (new Date()).getTime();