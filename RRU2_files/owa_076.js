self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.AttachmentModelStore.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[121],{1028:function(e,t,n){var r=n(1264),i=36e5,a=6e4,o=2,c=/[T ]/,s=/:/,u=/^(\d{2})$/,l=[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],d=/^(\d{4})/,f=[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],h=/^-(\d{2})$/,m=/^-?(\d{3})$/,p=/^-?(\d{2})-?(\d{2})$/,v=/^-?W(\d{2})$/,b=/^-?W(\d{2})-?(\d{1})$/,g=/^(\d{2}([.,]\d*)?)$/,w=/^(\d{2}):?(\d{2}([.,]\d*)?)$/,y=/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,O=/([Z+-].*)$/,P=/^(Z)$/,I=/^([+-])(\d{2})$/,T=/^([+-])(\d{2}):?(\d{2})$/;function A(e,t,n){t=t||0,n=n||0;var r=new Date(0);r.setUTCFullYear(e,0,4);var i=7*t+n+1-(r.getUTCDay()||7);return r.setUTCDate(r.getUTCDate()+i),r}e.exports=function(e,t){if(r(e))return new Date(e.getTime());if("string"!=typeof e)return new Date(e);var n=(t||{}).additionalDigits;n=null==n?o:Number(n);var _=function(e){var t,n={},r=e.split(c);if(s.test(r[0])?(n.date=null,t=r[0]):(n.date=r[0],t=r[1]),t){var i=O.exec(t);i?(n.time=t.replace(i[1],""),n.timezone=i[1]):n.time=t}return n}(e),E=function(e,t){var n,r=l[t],i=f[t];if(n=d.exec(e)||i.exec(e)){var a=n[1];return{year:parseInt(a,10),restDateString:e.slice(a.length)}}if(n=u.exec(e)||r.exec(e)){var o=n[1];return{year:100*parseInt(o,10),restDateString:e.slice(o.length)}}return{year:null}}(_.date,n),C=E.year,j=function(e,t){if(null===t)return null;var n,r,i,a;if(0===e.length)return(r=new Date(0)).setUTCFullYear(t),r;if(n=h.exec(e))return r=new Date(0),i=parseInt(n[1],10)-1,r.setUTCFullYear(t,i),r;if(n=m.exec(e)){r=new Date(0);var o=parseInt(n[1],10);return r.setUTCFullYear(t,0,o),r}if(n=p.exec(e)){r=new Date(0),i=parseInt(n[1],10)-1;var c=parseInt(n[2],10);return r.setUTCFullYear(t,i,c),r}if(n=v.exec(e))return a=parseInt(n[1],10)-1,A(t,a);if(n=b.exec(e)){a=parseInt(n[1],10)-1;var s=parseInt(n[2],10)-1;return A(t,a,s)}return null}(E.restDateString,C);if(j){var x,F=j.getTime(),D=0;return _.time&&(D=function(e){var t,n,r;if(t=g.exec(e))return(n=parseFloat(t[1].replace(",",".")))%24*i;if(t=w.exec(e))return n=parseInt(t[1],10),r=parseFloat(t[2].replace(",",".")),n%24*i+r*a;if(t=y.exec(e)){n=parseInt(t[1],10),r=parseInt(t[2],10);var o=parseFloat(t[3].replace(",","."));return n%24*i+r*a+1e3*o}return null}(_.time)),_.timezone?(k=_.timezone,x=(R=P.exec(k))?0:(R=I.exec(k))?(S=60*parseInt(R[2],10),"+"===R[1]?-S:S):(R=T.exec(k))?(S=60*parseInt(R[2],10)+parseInt(R[3],10),"+"===R[1]?-S:S):0):(x=new Date(F+D).getTimezoneOffset(),x=new Date(F+D+x*a).getTimezoneOffset()),new Date(F+D+x*a)}var k,R,S;return new Date(e)}},1223:function(e,t,n){"use strict";var r=n(75),i=n(34),a=n(1769),o=n(234);function c(e,t,n,o,c){void 0===c&&(c=!0);var s=t,u=s.AttachmentId,d=s.Name,f=s.OriginalPermissionType,h=s.PermissionType,m=l(t),p=e.mailboxInfo.type===i.a.GroupMailbox?e.mailboxInfo.primarySmtpAddress+"/":null;switch(n){case 0:case 3:return a.b(u,m,n,o,h,f,c,d,p);case 1:return t.AttachmentPreviewUrl?t.AttachmentPreviewUrl:a.b(u,m,1,o,h,f,c,d,p);case 2:return t.AttachmentThumbnailUrl;default:return Object(r.a)(n)}}function s(e,t,n,r){return void 0===n&&(n=!1),void 0===r&&(r=!0),a.a(e.mailboxInfo.routingKey,e,t,n,r)}function u(e,t,n,r,i){void 0===i&&(i=!1);var u=n?c(e,t,1,r,!1):s(e,1,i,!1);if(n)return{url:u,init:{credentials:"include"}};var l=Object(a.c)(),d=new Headers;return d.set("X-Token",l),d.set("X-OWA-CANARY",Object(o.getOwaCanaryCookie)()),{url:u,init:{headers:d}}}function l(e){var t=null;return(t=e.AttachLongPathName)||(t=e.WebUrl),t}function d(e,t,n,r,i,a){return void 0===a&&(a=!1),r?c(e,t,n,i):s(e,n,a)}n.d(t,"a",function(){return d}),n.d(t,"b",function(){return s}),n.d(t,"c",function(){return u}),n.d(t,"d",function(){return l})},1264:function(e,t){e.exports=function(e){return e instanceof Date}},1267:function(e){e.exports={b:"Wba",d:"Xba",c:"Yba",a:"Zba"}},1404:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"FindItemRequest:#Exchange"},e)}},1405:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(56),i=n(1855);t.default=function(e,t){return void 0===e||e.__type||(e=i.default(e)),r.makeServiceRequest("FindItem",e,t)}},1518:function(e,t,n){"use strict";var r=n(887),i={BOX:"Box",DROPBOX:"Dropbox",FACEBOOK:"Facebook",GDRIVE:"GDrive",MAILBOX:"Mailbox",ONE_DRIVE_CONSUMER:"OneDriveConsumer",ONE_DRIVE_PRO:"OneDrivePro",RECENT_ATTACHMENTS:"RecentAttachments",WOPI:"Wopi",WOPI_BOX:"WopiBox",WOPI_EGNYTE:"WopiEgnyte"};function a(e){switch(e?e.toLowerCase():null){case i.ONE_DRIVE_PRO.toLowerCase():return 0;case i.GDRIVE.toLowerCase():return 5;case i.ONE_DRIVE_CONSUMER.toLowerCase():return 1;case i.DROPBOX.toLowerCase():return 2;case i.BOX.toLowerCase():return 3;case i.WOPI_BOX.toLowerCase():return 7;case i.WOPI_EGNYTE.toLowerCase():return 8;case i.MAILBOX.toLowerCase():return 4;case i.FACEBOOK.toLowerCase():return 6;default:return null}}function o(e){return null==e?null:{attachmentItemId:e.Id,name:e.Name,size:e.Size,fileType:r.a.AttachmentItem,type:"ItemIdAttachment:#Exchange"}}function c(e){return null==e?null:{fileType:r.a.Cloud,name:e.Name,size:e.Size,providerId:e.AttachmentProviderId,providerType:e.ProviderType,location:e.Location,providerEndpointUrl:e.ProviderEndpointUrl,isFolder:1===e.Type,fileId:e.Id,fileParentId:e.ParentId,thumbnailUrl:e.Thumbnail?e.Thumbnail.Url:"",previewUrl:e.Preview?e.Preview.Url:"",type:e.MimeType}}function s(e){if(!e)return null;for(var t=[],n=0;n<e.length;n++){var i=e[n],a={fileType:r.a.Local,name:i.name,size:i.size,type:i.type,fileObject:i};t.push(a)}return t}function u(e,t,n){var i=[],a={fileType:r.a.MailItem,name:e,size:n||0,mimeContent:t};return i.push(a),i}var l=n(11);function d(e,t,n){if(e.length!=t.length)return l.d.error("The sizes of subjects and latestItemIds are different"),null;for(var i=[],a=0;a<e.length;a++){var o={fileType:r.a.MailItem,name:e[a],size:n&&n[a]||0,itemId:t[a]};i.push(o)}return i}var f=n(492);function h(e){return e.map(function(e){return{fileType:r.a.Uri,name:e.name,type:Object(f.b)(e.url),size:0,uri:e.url}})}n.d(t,"b",function(){return a}),n.d(t,"e",function(){return s}),n.d(t,"g",function(){return d}),n.d(t,"c",function(){return o}),n.d(t,"d",function(){return c}),n.d(t,"h",function(){return h}),n.d(t,"f",function(){return u}),n.d(t,"a",function(){return r.a})},1561:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r={attachmentTypes:{FILE_ATTACHMENT_TYPE:"FileAttachment:#Exchange",ITEM_ATTACHMENT_TYPE:"ItemAttachment:#Exchange",ITEM_ID_ATTACHMENT_TYPE:"ItemIdAttachment:#Exchange",REFERENCE_ATTACHMENT_TYPE:"ReferenceAttachment:#Exchange"}}},1677:function(e){e.exports={a:"Jba",b:"Kba"}},1762:function(e,t,n){"use strict";n.d(t,"a",function(){return h}),n.d(t,"c",function(){return m}),n.d(t,"b",function(){return p});var r=n(0),i=n(4),a=n(2444),o=n(2456),c=n.n(o),s=n(10),u=n(18),l=n(11),d=Object(a.b)({timeBetweenRetryInMS:function(){return 3e4}}),f=function(){function e(e,t,n){var a=this;this.downloadTokenRefreshMinutes=e,this.downloadUrlBase=t,this.refreshDownloadTokenAndRetryInCaseOfFailure=function(){return r.__awaiter(a,void 0,void 0,function(){function e(){return r.__awaiter(this,void 0,void 0,function(){var e;return r.__generator(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,c()()];case 1:return[2,t.sent()];case 2:throw e=t.sent(),l.d.warn("Unable to get the download token "+e),e;case 3:return[2]}})})}var t,n,i,a,o=this;return r.__generator(this,function(c){switch(c.label){case 0:if(this.isRefreshingDownloadToken)return[3,4];this.isRefreshingDownloadToken=!0,t=0,n=d(function(){return r.__awaiter(o,void 0,void 0,function(){var n;return r.__generator(this,function(r){switch(r.label){case 0:return t++,n=this,[4,e()];case 1:return n.downloadToken=r.sent(),this.isRefreshingDownloadToken=!1,[2]}})})}).retriableFunc,i=new u.b("AttachmentRefreshDownloadToken"),c.label=1;case 1:return c.trys.push([1,3,,4]),[4,n()];case 2:return c.sent(),i.addCustomData([t]),i.end(),[3,4];case 3:return a=c.sent(),l.d.warn("Retry to refresh token failed: "+a),i.addCustomData([t]),i.endWithError("ServerError",a),this.isRefreshingDownloadToken=!1,[3,4];case 4:return[2]}})})},this.useDownloadUrlBase=!Object(i.g)(this.downloadUrlBase),this.downloadToken=n,this.downloadTokenRefreshMinutes<1&&(this.downloadTokenRefreshMinutes=1),this.useDownloadUrlBase&&setInterval(this.refreshDownloadTokenAndRetryInCaseOfFailure,6e4*this.downloadTokenRefreshMinutes)}return e.getInstance=function(){if(!e.instance){var t=Object(s.a)().ApplicationSettings;e.instance=new e(t.DownloadTokenRefreshMinutes,t.DownloadUrlBase,t.FirstDownloadToken)}return e.instance},e.resetInstanceForTesting=function(){e.instance=null},e.prototype.getDownloadToken=function(){return this.downloadToken},e.prototype.getUseDownloadUrlBase=function(){return this.useDownloadUrlBase},e.prototype.getDownloadUrlBase=function(){return this.downloadUrlBase},e}();function h(){return f.getInstance().getDownloadToken()}function m(){return f.getInstance().getUseDownloadUrlBase()}function p(){return f.getInstance().getDownloadUrlBase()}},1769:function(e,t,n){"use strict";var r=n(2445);n.d(t,"a",function(){return r.a}),n.d(t,"b",function(){return r.b});var i=n(1762);n.d(t,"c",function(){return i.a})},1855:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"FindItemJsonRequest:#Exchange"},e)}},2243:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetAccessTokenForDataProviderRequest:#Exchange"},e)}},2249:function(e,t,n){var r=n(2946),i=6e4;e.exports=function(e,t){var n=Number(t);return r(e,n*i)}},2444:function(e,t,n){"use strict";function r(e){void 0===e&&(e={}),function(e){e.timeBetweenRetryInMS=e.timeBetweenRetryInMS||function(){return 6e4}}(e);var t=e.maximumAttempts,n=e.timeBetweenRetryInMS;return function(e){var r=0,i=!1,a=function(o,c){i?c(new Error("The function retry was cancelled")):(r++,e().then(function(e){return o(e)}).catch(function(e){t&&r>=t?c(e):setTimeout(function(){return a(o,c)},n(r))}))};return{retriableFunc:function(){return new Promise(function(e,t){return a(e,t)})},cancel:function(){return i=!0}}}}function i(e){return function(t){return Math.pow(2,t)*e}}n.d(t,"b",function(){return r}),n.d(t,"a",function(){return i})},2445:function(e,t,n){"use strict";var r=n(75),i=n(4),a=n(234),o="/owa/",c="service.svc/s/GetFileAttachment?id={0}",s="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}",u="service.svc/s/GetAttachmentThumbnail?id={0}&thumbnailType=2",l="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}&isImagePreview=True",d="service.svc/s/GetAttachmentThumbnail?id={0}",f="pdfprint.aspx?id={0}",h="pdfprint.aspx?id={0}&location={1}",m=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd",".tiff",".tif"];var p=n(1762),v=n(44),b=n(125),g=n(15);function w(e,t,n,c,u,d,f,p,v){var b;switch(void 0===u&&(u=0),void 0===d&&(d=0),void 0===f&&(f=!0),void 0===p&&(p=null),void 0===v&&(v=null),n){case 0:b=s;break;case 3:b=h;break;case 1:if(!function(e){if(!e)return!1;var t=null,n=e.lastIndexOf(".");return n>0&&(t=e.substr(n).toLowerCase()),!!t&&m.indexOf(t.toLowerCase())>=0}(p))return null;b=l;break;default:Object(r.a)(n)}var g=c?d:u;!g&&u&&(g=u);var w=Object(i.b)("{0}{1}{2}&permissionLevel={3}",o,v,Object(i.b)(b,encodeURIComponent(e.Id),encodeURIComponent(t)),g);f&&(w=w+"&X-OWA-CANARY="+Object(a.getOwaCanaryCookie)());return w}function y(e,t,n,s,l){var h;switch(void 0===s&&(s=!1),void 0===l&&(l=!0),n){case 0:h=c;break;case 1:h=u;break;case 2:h=d;break;case 3:h=f;break;default:return Object(r.a)(n)}return Object(i.g)(h)?null:Object(i.b)("{0}{1}{2}",function(e,t,n,r,c){if(void 0===c&&(c=!1),!t||!t.Id)return null;var s=Object(i.b)(n,encodeURIComponent(t.Id));if(!Object(p.c)()||c&&"Firefox"===Object(b.a)().browser)return o+s+"&X-OWA-CANARY="+Object(a.getOwaCanaryCookie)();var u="{0}{1}/{2}&owa={3}&scriptVer={4}";Object(v.a)()&&(u+="&isc=1");var l=Object(i.b)(u,Object(p.b)(),e,s,window.location.hostname,Object(g.f)()||"unofficial");return r&&(l+="&X-OWA-CANARY="+Object(a.getOwaCanaryCookie)(),l+="&token="+Object(p.a)()),l}(e,t,h,l,3===n),s?"&isDownload=true":"","&animation=true")}n.d(t,"b",function(){return w}),n.d(t,"a",function(){return y})},2456:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(56);t.default=function(e){return r.makeServiceRequest("GetAttachmentDownloadToken",{},e)}},2461:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(56),i=n(2243);t.default=function(e,t){return void 0===e||e.__type||(e=i.default(e)),r.makeServiceRequest("GetAccessTokenforDataProvider",e,t)}},2517:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(2),a=Object(i.action)("checkPendingAttachmentOperation",function(e,t,n,r,i){return{attachmentId:e,itemId:t,operationId:n,operationType:r,completeHandler:i}}),o=n(6098),c=n.n(o),s=n(7414),u=n.n(s);function l(e,t,n,r,i){var a=function(e,t,n,r){return c()({ewsAttachmentId:e,itemId:t,operationId:n,operationType:r})}(e,t,n,r);return u()(a,i)}var d=n(11),f=(Object(i.orchestrator)(a,function(e){return r.__awaiter(void 0,void 0,void 0,function(){var t,n,i;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),t=e.itemId?e.itemId.mailboxInfo:e.attachmentId.mailboxInfo,[4,l(e.attachmentId?e.attachmentId.Id:null,e.itemId?e.itemId.Id:null,e.operationId,e.operationType,t.requestOptions)];case 1:return n=r.sent(),e.completeHandler(n),[3,3];case 2:return i=r.sent(),d.d.warn("checkPendingAttachmentOperationAction is failing with error: "+i),[3,3];case 3:return[2]}})})}),n(1536)),h=n(1429),m=n(3600),p=n(5784);Object(i.orchestrator)(m.n,function(e){return r.__awaiter(void 0,void 0,void 0,function(){var t,n;return r.__generator(this,function(r){switch(r.label){case 0:return"object"!=typeof e.id?[3,2]:(t=Object(h.a)(e.id))?(n=t.model,[4,Object(p.a)([e.id],n.PermissionType)]):[3,2];case 1:r.sent(),Object(f.a)(t.id),r.label=2;case 2:return[2]}})})});var v=n(4013),b=n(8),g=Object(b.action)("setPreviewImageUrl")(function(e,t){Object(h.a)(e).previewImage.url=t}),w=n(4434),y=n(5291),O=n(309),P=n(2482),I=n(691),T=n(1223);function A(e){return r.__awaiter(this,void 0,void 0,function(){var t;return r.__generator(this,function(n){switch(n.label){case 0:return[4,Object(P.a)(e)];case 1:if(null==(t=n.sent()))throw new Error("URL not available");return"2",[2,t+"2"]}})})}var _=Object(b.action)("refreshPreviewImageUrl")(function(e,t,n){return void 0===n&&(n=!1),r.__awaiter(this,void 0,void 0,function(){var i,a,o;return r.__generator(this,function(r){switch(r.label){case 0:return i=Object(h.a)(e),Object(I.b)(i.model)&&i.model.ProviderType===O.f?[4,A(i.model)]:[3,2];case 1:return a=r.sent(),g(e,a),[3,3];case 2:Object(I.b)(i.model)&&i.model.ProviderType!==O.l&&i.model.ProviderType!==O.m||(o=Object(T.a)(e,i.model,1,1===i.type,t,n),g(e,o)),r.label=3;case 3:return[2]}})})}),E=n(4250),C=n(4631),j=Object(b.action)("setAttachmentInfo")(function(e,t){Object(h.a)(e).info=t});n.d(t,"addAndInitializeAttachments",function(){return v.a}),n.d(t,"setPreviewImageUrl",function(){return g}),n.d(t,"refreshDownloadUrl",function(){return w.a}),n.d(t,"refreshThumbnailImageUrl",function(){return y.a}),n.d(t,"refreshPreviewImageUrl",function(){return _}),n.d(t,"getAttachment",function(){return h.a}),n.d(t,"checkPendingAttachmentOperation",function(){return a}),n.d(t,"shouldShowImageView",function(){return E.a}),n.d(t,"createAttachmentInfo",function(){return C.a}),n.d(t,"setAttachmentInfo",function(){return j})},2946:function(e,t,n){var r=n(1028);e.exports=function(e,t){var n=r(e).getTime(),i=Number(t);return new Date(n+i)}},492:function(e,t,n){"use strict";function r(e){if(!e)return null;var t=e.lastIndexOf(".");return t>0?e.substr(t).toLowerCase():null}function i(e){var t=r(e);return t?t.replace(".",""):null}var a=n(1267),o=n(4);function c(e){var t;return e>=1073741824?(e/=1073741824,t=Object(o.a)(a.b)):e>=1048576?(e/=1048576,t=Object(o.a)(a.d)):e>=1024?(e/=1024,t=Object(o.a)(a.c)):t=Object(o.a)(a.a),Object(o.b)(t,Math.round(e))}function s(e){return e&&(t=e,(n=l.exec(t))&&n.length>1&&u[n[1].toLowerCase()]);var t,n}var u={"image/bmp":".bmp","image/x-ms-bmp":".bmp","image/gif":".gif","image/jpeg":".jpeg","image/png":".png","image/vnd.adobe.photoshop":".psd","image/tiff":".tiff"},l=/^\s*([^;\s]*)(?:;|\s|$)/;var d=n(77),f=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd"],h=[".tiff",".tif"];function m(e,t,n){void 0===n&&(n=!0);var i=r(e)||s(t);return!!i&&(f.indexOf(i.toLowerCase())>=0||n&&h.indexOf(i.toLowerCase())>=0&&(Object(d.d)()||Object(d.c)()||Object(d.g)()||Object(d.f)()&&!Object(d.i)()))}var p,v=n(6),b=[".pdf",".doc",".docx",".odt",".rtf",".ppt",".pptx",".pptm",".potx",".potm",".pot",".ppxx",".pps",".odp"];function g(e){if(!Object(v.e)("doc-attachment-documentThumbnail"))return!1;var t=r(e);return!!t&&b.indexOf(t.toLowerCase())>=0}function w(e){switch(e){case".doc":case".docm":case".docx":case".dot":case".dotm":case".dotx":case".odt":case".rtf":return p.Word;case".csv":case".ods":case".xls":case".xlsb":case".xlsm":case".xlsx":return p.Excel;case".odp":case".pot":case".potm":case".potx":case".pps":case".ppsm":case".ppsx":case".ppt":case".pptm":case".pptx":return p.PowerPoint;default:return null}}!function(e){e[e.Word=0]="Word",e[e.Excel=1]="Excel",e[e.PowerPoint=2]="PowerPoint"}(p||(p={})),n.d(t,"b",function(){return r}),n.d(t,"c",function(){return i}),n.d(t,"g",function(){return c}),n.d(t,"e",function(){return m}),n.d(t,"f",function(){return g}),n.d(t,"d",function(){return w}),n.d(t,"a",function(){return p})},494:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"ItemResponseShape:#Exchange"},e)}},5022:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"SetAttachmentPermissionsRequest:#Exchange"},e)}},518:function(e,t,n){"use strict";var r,i,a;n.d(t,"c",function(){return r}),n.d(t,"b",function(){return i}),n.d(t,"a",function(){return a}),function(e){e[e.Compose=0]="Compose",e[e.Extensibility=1]="Extensibility",e[e.ReadingPane=2]="ReadingPane",e[e.Fileshub=3]="Fileshub",e[e.Txp=4]="Txp"}(r||(r={})),function(e){e[e.SmimeSignature=0]="SmimeSignature",e[e.Safety=1]="Safety",e[e.Error=2]="Error",e[e.Info=3]="Info",e[e.Encryption=4]="Encryption",e[e.Translation=5]="Translation",e[e.Sensitivity=6]="Sensitivity"}(i||(i={})),function(e){e[e.Grey=0]="Grey",e[e.Red=1]="Red",e[e.Green=2]="Green",e[e.Yellow=3]="Yellow",e[e.Orange=4]="Orange",e[e.Green20=5]="Green20"}(a||(a={}))},5217:function(e,t,n){"use strict";var r=n(1536),i=n(1429),a=n(4654),o=n(6),c=n(10),s=n(8);t.a=Object(s.action)("setAttachmentPermissionLevel")(function(e,t,n,s){var u=Object(i.a)(e),l=u.model;l.PermissionType=t,n&&(l.AttachLongPathName=n,u.openUrl=Object(a.a)(l,Object(c.a)())),Object(o.e)("doc-attachment-referenceAttachmentExpiration")&&u.info&&u.info.sharingInfo&&(u.info.sharingInfo.expirationDate=s),Object(r.a)(e)})},5291:function(e,t,n){"use strict";var r=n(0),i=n(1429),a=n(309),o=n(2482),c=n(691),s=n(1223),u=n(8);t.a=Object(u.action)("refreshThumbnailImageUrl")(function(e,t,n){return void 0===n&&(n=!1),r.__awaiter(this,void 0,void 0,function(){var u,l;return r.__generator(this,function(r){switch(r.label){case 0:if(u=Object(i.a)(e),!Object(c.b)(u.model))return[3,7];switch(u.model.ProviderType){case a.f:return[3,1]}return[3,5];case 1:return r.trys.push([1,3,,4]),[4,Object(o.a)(u.model)];case 2:return l=r.sent(),u.thumbnailImage.url=l,[3,4];case 3:return r.sent(),u.thumbnailImage.url=null,[3,4];case 4:case 5:return[3,6];case 6:return[3,8];case 7:l=Object(s.a)(e,u.model,2,Object(c.b)(u.model),t,n),u.thumbnailImage.url=l,r.label=8;case 8:return[2]}})})})},542:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"IndexedPageView:#Exchange"},e)}},5784:function(e,t,n){"use strict";var r=n(0),i=n(8),a=n(5),o=n(5217),c=n(5022),s=n.n(c),u=n(6099),l=n.n(u);function d(e,t,n,r){void 0===n&&(n=null),void 0===r&&(r=!1);var i=function(e,t,n,r){return void 0===n&&(n=null),void 0===r&&(r=!1),s()({AttachmentIds:e,PermissionLevel:t,NewAttachLongPathNames:n,SetToOriginalPermissionLevel:r})}(e,t,n,r);return l()({request:i})}t.a=Object(i.action)("changeAttachmentPermission")(function(e,t,n,i){return void 0===n&&(n=null),void 0===i&&(i=!1),r.__awaiter(this,void 0,void 0,function(){var c;return r.__generator(this,function(r){switch(r.label){case 0:return[4,d(e.map(function(e){return e.Id}),t,n,i)];case 1:if(!(c=r.sent()).OperationSucceeded||!c.NewAttachLongPathNames||c.NewAttachLongPathNames.length!==e.length)throw new Error("Error setting attachment permissions");return e.forEach(function(e,n){var r=null;c.ExpirationDates&&c.ExpirationDates[n]&&(r=Object(a.cc)(c.ExpirationDates[n])),Object(o.a)(e,t,c.NewAttachLongPathNames[n],r)}),[2]}})})})},6098:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"CheckPendingAttachmentOperationRequest:#Exchange"},e)}},6099:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(56),i=n(5022);t.default=function(e,t){return void 0===e.request||e.request.__type||(e.request=i.default(e.request)),r.makeServiceRequest("SetAttachmentPermissionsV2",e,t)}},7414:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(56),i=n(6098);t.default=function(e,t){return void 0===e||e.__type||(e=i.default(e)),r.makeServiceRequest("CheckPendingAttachmentOperation",e,t)}},887:function(e,t,n){"use strict";var r;n.d(t,"a",function(){return r}),function(e){e[e.Base64InlineImage=0]="Base64InlineImage",e[e.Cloud=1]="Cloud",e[e.Local=2]="Local",e[e.MailItem=3]="MailItem",e[e.Uri=4]="Uri",e[e.AttachmentItem=5]="AttachmentItem",e[e.CloudSuggestion=6]="CloudSuggestion",e[e.AttachmentItemSuggestion=7]="AttachmentItemSuggestion",e[e.Inline=8]="Inline",e[e.Smime=9]="Smime",e[e.FilesHub=10]="FilesHub",e[e.GroupFilesHub=11]="GroupFilesHub",e[e.MailSearchFileSuggestion=12]="MailSearchFileSuggestion",e[e.Unknown=13]="Unknown",e[e.ContextualSuggestion=14]="ContextualSuggestion"}(r||(r={}))},893:function(e,t,n){"use strict";var r;!function(e){e.InfoRestrictedAccess="infoRestrictedAccess"}(r||(r={}));var i=n(75);function a(e){switch(e){case 0:return r.InfoRestrictedAccess;default:return Object(i.a)(e)}}var o=n(10);function c(e){switch(e){case 0:return(t=Object(o.a)().AttachmentPolicy).ConditionalAccessDirectFileAccessOnPrivateComputersBlocked||t.ConditionalAccessDirectFileAccessOnPublicComputersBlocked||t.ConditionalAccessPrintWithoutDownloadBlocked||t.ConditionalAccessWacViewingOnPrivateComputersBlocked||t.ConditionalAccessWacViewingOnPublicComputersBlocked;default:return Object(i.a)(e)}var t}var s=[0],u=n(1561);function l(){return s.filter(c)}function d(e){return e&&e.length>0&&function(e){return e.some(function(e){return!((t=e).IsInline&&!function(e){return e.__type===u.a.attachmentTypes.REFERENCE_ATTACHMENT_TYPE}(t));var t})}(e)?s.filter(c):[]}var f=n(1677),h=n(4),m=n(518);function p(e){switch(e){case r.InfoRestrictedAccess:return{key:"access_control_info_bar",source:m.c.Compose,rank:m.b.Error,messageParts:[Object(h.a)(f.b),(t="https://docs.microsoft.com/en-us/intune-user-help/use-managed-devices-to-get-work-done",{text:Object(h.a)(f.a),action:function(){window.open(t,"_blank")}})],color:m.a.Red};default:return Object(i.a)(e)}var t}var v,b=n(492);!function(e){e[e.Undefined=0]="Undefined",e[e.Block=1]="Block",e[e.ForceSave=2]="ForceSave",e[e.Allow=3]="Allow",e[e.ConditionalAccess=4]="ConditionalAccess"}(v||(v={}));var g=function(){function e(e,t){this.attachmentPolicy=e,this.shouldTreatAsPublicLogon=t,this.shouldTreatAsPublicLogon?this.directFileAccessEnabled=this.attachmentPolicy.DirectFileAccessOnPublicComputersEnabled:this.directFileAccessEnabled=this.attachmentPolicy.DirectFileAccessOnPrivateComputersEnabled,this.saveAttachmentsToCloudEnabled=this.attachmentPolicy.AttachmentDataProviderAvailable&&this.attachmentPolicy.SaveAttachmentsToCloudEnabled,this.convertClassicToCloudyEnabled=this.attachmentPolicy.AttachmentDataProviderAvailable&&this.attachmentPolicy.ReferenceAttachmentsEnabled,this.convertCloudyToClassicEnabled=this.attachmentPolicy.AttachmentDataProviderAvailable&&this.attachmentPolicy.ClassicAttachmentsEnabled,this.fileTypeToPolicyMap=this.createPolicyMap(this.attachmentPolicy.BlockedFileTypes,this.attachmentPolicy.ForceSaveFileTypes,this.attachmentPolicy.AllowedFileTypes),this.mimeTypeToPolicyMap=this.createPolicyMap(this.attachmentPolicy.BlockedMimeTypes,this.attachmentPolicy.ForceSaveMimeTypes,this.attachmentPolicy.AllowedMimeTypes),this.policyForUnknownTypes=v[this.attachmentPolicy.ActionForUnknownFileAndMIMETypes],this.printWithoutDownloadEnabled=this.attachmentPolicy.PrintWithoutDownloadEnabled}return e.prototype.getPolicyInfo=function(e,t,n,r){e&&(e=e.toLowerCase());var i=this.getFileAccessLevel(e,t),a=!1,o=!1,c=!1,s="ReferenceAttachment:#Exchange"===r;return i!==v.Block&&n&&(this.isWacViewingEnabled(e)&&(a=!0),!this.directFileAccessEnabled&&s&&(a=!1),o=this.isForceBrowserViewingFirst(a),a&&null!=this.attachmentPolicy.WacEditableFileTypes&&null!=e&&(c="FileAttachment:#Exchange"===r?this.attachmentPolicy.WacEditableFileTypes.indexOf(e)>=0||this.attachmentPolicy.WacConvertibleFileTypes.indexOf(e)>=0:this.attachmentPolicy.WacEditableFileTypes.indexOf(e)>=0&&-1===this.attachmentPolicy.WacConvertibleFileTypes.indexOf(e)),a||this.directFileAccessEnabled||(i=v.ConditionalAccess)),{directFileAccessEnabled:this.directFileAccessEnabled,level:i,useWac:a,forceBrowserViewingFirst:o,wacEdit:c}},e.prototype.isPdfPreviewEnabled=function(){return this.shouldTreatAsPublicLogon?this.attachmentPolicy.WacViewingOnPublicComputersEnabled||this.attachmentPolicy.DirectFileAccessOnPublicComputersEnabled:this.attachmentPolicy.WacViewingOnPrivateComputersEnabled||this.attachmentPolicy.DirectFileAccessOnPrivateComputersEnabled},e.prototype.getFileAccessLevel=function(e,t){var n=this.fileTypeToPolicyMap[e];if(n||(n=v.Undefined),n===v.Block)return v.Block;var r=this.mimeTypeToPolicyMap[t];return r===v.Block?v.Block:n===v.ForceSave||r===v.ForceSave?v.ForceSave:n===v.Allow||r===v.Allow?v.Allow:this.policyForUnknownTypes},e.prototype.isWacViewingEnabled=function(e){return(this.shouldTreatAsPublicLogon?this.attachmentPolicy.WacViewingOnPublicComputersEnabled:this.attachmentPolicy.WacViewingOnPrivateComputersEnabled)&&this.attachmentPolicy.WacViewableFileTypes.indexOf(e)>=0},e.prototype.isForceBrowserViewingFirst=function(e){return!!e&&(this.shouldTreatAsPublicLogon?this.attachmentPolicy.ForceWacViewingFirstOnPublicComputers:this.attachmentPolicy.ForceWacViewingFirstOnPrivateComputers)},e.prototype.addPolicyIntoMap=function(e,t,n){t&&t.forEach(function(t){e[t]=n})},e.prototype.createPolicyMap=function(e,t,n){var r={};return this.addPolicyIntoMap(r,n,v.Allow),this.addPolicyIntoMap(r,t,v.ForceSave),this.addPolicyIntoMap(r,e,v.Block),r},e}(),w=null,y=null;function O(){if(!w){var e=Object(o.a)(),t=e.AttachmentPolicy,n=e.SessionSettings.IsPublicLogon||e.PublicComputersDetectionEnabled&&e.SessionSettings.IsPublicComputerSession;w=new g(t,n),n&&(y=w)}return w}function P(e,t){var n=Object(b.b)(e.Name),r=e.ContentType;return O().getPolicyInfo(n,r,t,e.__type)}function I(e,t){var n=Object(b.b)(e.Name),r=e.ContentType;return function(){if(!y){var e=Object(o.a)();if(e.SessionSettings.IsPublicLogon||e.PublicComputersDetectionEnabled&&e.SessionSettings.IsPublicComputerSession)return O();y=new g(e.AttachmentPolicy,!0)}return y}().getPolicyInfo(n,r,t,e.__type)}function T(e,t,n,r){if(r)return!1;var i=P(e,!0),a=O();return i.level!==v.Block&&a.saveAttachmentsToCloudEnabled&&!t&&n}n.d(t,"a",function(){return s}),n.d(t,"i",function(){return p}),n.d(t,"b",function(){return r}),n.d(t,"d",function(){return l}),n.d(t,"e",function(){return d}),n.d(t,"h",function(){return a}),n.d(t,"j",function(){return T}),n.d(t,"c",function(){return v}),n.d(t,"f",function(){return P}),n.d(t,"g",function(){return I}),n.d(t,"k",function(){return O})}},0,[514,105,24,116,413]]);
//# sourceMappingURL=owa.AttachmentModelStore.js.map
self.scriptsLoaded['owa.AttachmentModelStore.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.AttachmentModelStore.js'] = (new Date()).getTime();