self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.CharmsCatalog.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[173],{13828:function(r,e,n){"use strict";n.r(e);var t=n(0),o=n(634),a=n(10),l=n(70),c=n(65),i=n(11),u="ows/v1.0/CalendarIcons/?AssetType=svg&Lang=",s=2,f=null;var d=n(8);function h(r){var e,n,o={IconId:r.iconId,Name:r.name,LocalizedName:r.locName,SvgFile:r.svgFile,Keywords:[],IsInDefaultSet:r.isInDefaultSet,SvgHtmlText:""};if(null!=r.keywords)try{for(var a=t.__values(r.keywords),l=a.next();!l.done;l=a.next()){var c=l.value;o.Keywords.push(c)}}catch(r){e={error:r}}finally{try{l&&!l.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}return o}var v=Object(d.action)("setCharmInfoInMap")(Object(d.select)({charmStore:function(){return o.a}})(function(r,e){var n=e.charmStore;return new Promise(function(e){var o,a;if(null==n||null==n.charmInfoMap||null==r||null==r.icons)return e();try{for(var l=t.__values(r.icons),c=l.next();!c.done;c=l.next()){var i=c.value,u=h(i);n.charmInfoMap.set(i.iconId.toString(),u)}}catch(r){o={error:r}}finally{try{c&&!c.done&&(a=l.return)&&a.call(l)}finally{if(o)throw o.error}}return e()})})),m=Object(d.action)("setCharmKeywordsInMap")(Object(d.select)({charmStore:function(){return o.a}})(function(r){var e=r.charmStore;return new Promise(function(r){var n,o;if(null==e||null==e.keywordsMap||null==e.charmInfoMapMaxId)return r();if(e.keywordsMap.size>3)return r();for(var a=0;a<=e.charmInfoMapMaxId;a++){var l=e.charmInfoMap.get(a.toString());if(null!=l)try{for(var c=(n=void 0,t.__values(l.Keywords)),i=c.next();!i.done;i=c.next()){var u=i.value;if(!e.keywordsMap.has(u)){var s={Keyword:u,IconId:l.IconId};e.keywordsMap.set(u.toLocaleLowerCase(),s)}}}catch(r){n={error:r}}finally{try{i&&!i.done&&(o=c.return)&&o.call(c)}finally{if(n)throw n.error}}}return r()})}));var I=Object(d.action)("loadCharmsCatalog")(Object(d.select)({charmStore:function(){return o.a}})(function(r){var e=r.charmStore;return new Promise(function(r){var n=function(){if(null!=f)return f;var r=Object(a.a)(),e="";if(r&&r.SessionSettings&&!Object(l.b)(r.SessionSettings.UserCulture)&&(e=r.SessionSettings.UserCulture.toLowerCase()),e.length<s)return i.d.error("[getCalendarIconsFromService] Failed to get locale, got: "+e+"."),null;var n=u+e;return f=new Promise(function(r){Object(c.b)(n).then(function(n){return null!=n?(i.d.info("[getCalendarIconsFromService] Got response for locale: "+e+"."),r(n)):(i.d.error("[getCalendarIconsFromService] Failed to get response for locale: "+e+"."),r(null))})})}();null!=n&&n.then(function(r){return null!=r&&null!=r.icons&&r.icons.length>0?(v(r),e.charmInfoMapMaxId=function(r){var e,n,o=0;try{for(var a=t.__values(r),l=a.next();!l.done;l=a.next()){var c=l.value;o<c.iconId&&(o=c.iconId)}}catch(r){e={error:r}}finally{try{l&&!l.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}return o}(r.icons),m(),void i.d.info("[loadCharmsCatalog] Loaded charms catalog into the charms store.")):void i.d.info("[loadCharmsCatalog] Failed to load charms from service. Continuing without charms.")}).then(function(){return r()})})})),w=n(5813);function g(r,e){return t.__awaiter(this,void 0,void 0,function(){return t.__generator(this,function(e){switch(e.label){case 0:return[4,Object(w.a)(r.SvgFile).then(function(e){r.SvgHtmlText=e})];case 1:return e.sent(),i.d.info("[setCharmInfoWithUpdatedSvgText] complete, iconId: "+r.IconId),[2]}})})}var S=Object(d.action)("loadCharmSvgTextInMap")(Object(d.select)({charmStore:function(){return o.a}})(function(r,e){return t.__awaiter(this,void 0,void 0,function(){var n;return t.__generator(this,function(t){switch(t.label){case 0:return null==r||null==e||null==e.charmStore||null==e.charmStore.charmInfoMapMaxId?[2]:null==(n=e.charmStore.charmInfoMap.get(r.toString()))||null!=n.SvgHtmlText&&""!=n.SvgHtmlText?[3,2]:[4,g(n,e.charmStore)];case 1:t.sent(),e.charmStore.charmInfoMap.set(n.IconId.toString(),n),t.label=2;case 2:return[2]}})})}));n.d(e,"loadCharmsCatalog",function(){return I}),n.d(e,"loadCharmSvgTextInMap",function(){return S})},5813:function(r,e,n){"use strict";e.a=function(r){if(null==r||""==r)return Promise.resolve("");var e=new Request(r);return e.headers.append("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),e.headers.append("Accept","application/x-www-form-urlencoded; charset=UTF-8"),fetch(e).then(function(r){return r.text()})}}},0,[514,105]]);
//# sourceMappingURL=owa.CharmsCatalog.js.map
self.scriptsLoaded['owa.CharmsCatalog.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.CharmsCatalog.js'] = (new Date()).getTime();