self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.AttachmentSuggestions.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[124],{1267:function(e){e.exports={b:"Wba",d:"Xba",c:"Yba",a:"Zba"}},1518:function(e,t,r){"use strict";var n=r(887),o={BOX:"Box",DROPBOX:"Dropbox",FACEBOOK:"Facebook",GDRIVE:"GDrive",MAILBOX:"Mailbox",ONE_DRIVE_CONSUMER:"OneDriveConsumer",ONE_DRIVE_PRO:"OneDrivePro",RECENT_ATTACHMENTS:"RecentAttachments",WOPI:"Wopi",WOPI_BOX:"WopiBox",WOPI_EGNYTE:"WopiEgnyte"};function a(e){switch(e?e.toLowerCase():null){case o.ONE_DRIVE_PRO.toLowerCase():return 0;case o.GDRIVE.toLowerCase():return 5;case o.ONE_DRIVE_CONSUMER.toLowerCase():return 1;case o.DROPBOX.toLowerCase():return 2;case o.BOX.toLowerCase():return 3;case o.WOPI_BOX.toLowerCase():return 7;case o.WOPI_EGNYTE.toLowerCase():return 8;case o.MAILBOX.toLowerCase():return 4;case o.FACEBOOK.toLowerCase():return 6;default:return null}}function i(e){return null==e?null:{attachmentItemId:e.Id,name:e.Name,size:e.Size,fileType:n.a.AttachmentItem,type:"ItemIdAttachment:#Exchange"}}function c(e){return null==e?null:{fileType:n.a.Cloud,name:e.Name,size:e.Size,providerId:e.AttachmentProviderId,providerType:e.ProviderType,location:e.Location,providerEndpointUrl:e.ProviderEndpointUrl,isFolder:1===e.Type,fileId:e.Id,fileParentId:e.ParentId,thumbnailUrl:e.Thumbnail?e.Thumbnail.Url:"",previewUrl:e.Preview?e.Preview.Url:"",type:e.MimeType}}function u(e){if(!e)return null;for(var t=[],r=0;r<e.length;r++){var o=e[r],a={fileType:n.a.Local,name:o.name,size:o.size,type:o.type,fileObject:o};t.push(a)}return t}function s(e,t,r){var o=[],a={fileType:n.a.MailItem,name:e,size:r||0,mimeContent:t};return o.push(a),o}var d=r(11);function l(e,t,r){if(e.length!=t.length)return d.d.error("The sizes of subjects and latestItemIds are different"),null;for(var o=[],a=0;a<e.length;a++){var i={fileType:n.a.MailItem,name:e[a],size:r&&r[a]||0,itemId:t[a]};o.push(i)}return o}var f=r(492);function h(e){return e.map(function(e){return{fileType:n.a.Uri,name:e.name,type:Object(f.b)(e.url),size:0,uri:e.url}})}r.d(t,"b",function(){return a}),r.d(t,"e",function(){return u}),r.d(t,"g",function(){return l}),r.d(t,"c",function(){return i}),r.d(t,"d",function(){return c}),r.d(t,"h",function(){return h}),r.d(t,"f",function(){return s}),r.d(t,"a",function(){return n.a})},2516:function(e,t,r){"use strict";r.r(t);var n=r(2),o=Object(n.action)("getAttachmentSuggestionsAction",function(e){return{referenceItemId:e}}),a=r(37),i=Object(n.action)("storeAttachmentSuggestionsOnItemAction",function(e,t){return{referenceItemId:e,attachmentSuggestions:t}}),c=(Object(n.mutator)(i,function(e){var t=a.H.items.get(e.referenceItemId);t&&(t.AttachmentSuggestions=e.attachmentSuggestions)}),Object(n.action)("storeContextualMRUSuggestionsOnItemAction",function(e,t){return{referenceItemId:e,contextualSuggestions:t}})),u=(Object(n.mutator)(c,function(e){var t=a.H.items.get(e.referenceItemId);t&&(t.ContextualAttachmentSuggestions=e.contextualSuggestions)}),r(1534)),s=Object(n.action)("storeMRUSuggestionsAction",function(e){return{mruAttachments:e}}),d=(Object(n.mutator)(s,function(e){Object(u.a)().attachments=e.mruAttachments}),Object(n.action)("getContextualMRUSuggestionsAction",function(e){return{referenceItemId:e}})),l=Object(n.action)("getMRUSuggestionsAction"),f=Object(n.action)("getReplyWithSuggestionsAction",function(e){return{referenceItemId:e}}),h=r(6);Object(n.orchestrator)(o,function(e){Object(h.e)("mc-replyWithContextualMRU")&&e.referenceItemId?d(e.referenceItemId):(f(e.referenceItemId),l())});var p=r(0),m=r(11);function v(e){return e.Source.LastModifiedBy?e.Source.LastModifiedBy.DisplayName:e.Source.LastShared.SharedBy.DisplayName}var b=r(18),g=r(303),O=r(242),y="application/json;charset=utf-8",S="/search/api/v1/recommendations",I="recEnableSharedClassicAttachments",j="maxMRUFiles1",_="suggestedattachments";function w(e){return p.__awaiter(this,void 0,void 0,function(){var t,r,n,o,a,i,c,u,s,d,l;return p.__generator(this,function(f){switch(f.label){case 0:t=null,r=0,n="",o=null,f.label=1;case 1:return f.trys.push([1,7,8,9]),Object(b.o)("MRUQueryExecuted"),o=new b.a("QueryResponseInformation",{logVerbose:!0}),a=Object(h.e)("mc-replyWithMRUClassic"),e?o.addCustomData({endpoint:3}):o.addCustomData({endpoint:1}),[4,A()];case 2:return i=f.sent(),c=function(e,t,r){var n={};n.headers=new Headers,n.headers.set("Authorization","Bearer "+e),n.headers.set("Content-Type",y),n.method="POST";var o=Object(g.getDefaultAnchorMailboxCookie)();o&&n.headers.append("X-AnchorMailbox",o);n.headers.set("X-Client-LocalTime",(new Date).toISOString());var a=[];r?a.push(_):t&&(a.push(I),Object(h.e)("mc-replyWithMRUCloudyLimited")&&a.push(j));a.length&&n.headers.set("X-Client-Flights",a.join(","));var i={EntityRequests:[r?{Context:{EntityId:r}}:{}],Scenario:{Name:"AttachFile"}};return n.body=JSON.stringify(i),n}(i,a,e),o.addCheckmark("Request"),[4,fetch(S,c)];case 3:return u=f.sent(),o.addCheckmark("Response"),u&&200==u.status?[4,u.text()]:[3,5];case 4:return s=f.sent(),d=JSON.parse(s),t=function(e,t){try{var r=e.EntitySets[0].ResultSets[0].Results;return r.map(function(e){return function(e,t){try{var r=!!e.Source.LastShared&&!e.Source.WebUrl,n=e.Source.Author?e.Source.Author.DisplayName:"";return{Author:n,CreatedBy:n,DateAccessed:e.Source.LastAccessDateTime,DateCreated:null,DateModified:e.Source.LastModifiedDateTime,Endpoint:t?3:r?2:1,FileExtension:e.Source.FileExtension,FileName:e.Source.FileName,FileSize:e.Source.FileSize,FileSourceType:e.ContentSource||e.Provenance,Id:r?e.Source.LastShared.AttachmentId:e.Id,ModifiedBy:v(e),ReferenceId:e.ReferenceId,SourceTitle:e.Source.SiteTitle||e.Source.LastShared.SharingSubject,Text:e.Source.Title,Title:e.Source.Title,Url:e.Source.Url}}catch(e){return m.d.info("[convertMRUAttachmentToReplyWithAttachmentSuggestion] Error accessing MRUAttachment properties: "+e.message),null}}(e,t)})}catch(e){return m.d.info("[fetchMRUSuggestions_getAttachmentsFromResponse] Error: "+e.message),[]}}(d,!!e),r=t.length,[3,6];case 5:n=u?u.status+"-"+u.statusText:"No response",f.label=6;case 6:return[3,9];case 7:return l=f.sent(),n=l.message,[3,9];case 8:return n&&m.d.info("getMRUSuggestions: Error "+n),o.addCustomData({numResults:r}),n?o.endWithError("ServerError",new Error(n)):o.end(),[2,t];case 9:return[2]}})})}function A(){return p.__awaiter(this,void 0,void 0,function(){var e,t,r;return p.__generator(this,function(n){switch(n.label){case 0:return e=p.__read(Object(O.getAccessTokenforResourceAsLazy)(window.location.origin),2),t=e[0],r=e[1],t?[3,2]:[4,r];case 1:t=n.sent(),n.label=2;case 2:return[2,t]}})})}Object(n.orchestrator)(d,function(e){return p.__awaiter(this,void 0,void 0,function(){var t,r;return p.__generator(this,function(n){switch(n.label){case 0:return t=e.referenceItemId,a.H.items.get(t)?[4,w(t)]:[3,2];case 1:r=n.sent(),c(t,r),n.label=2;case 2:return[2]}})})}),Object(n.orchestrator)(l,function(){return p.__awaiter(this,void 0,void 0,function(){var e;return p.__generator(this,function(t){switch(t.label){case 0:return[4,w(null)];case 1:return(e=t.sent())&&s(e),[2]}})})});var P=r(955),C=r(954),E=r(308),x=r.n(E),R=r(494),T=r.n(R),D="EntityExtraction/SubstrateSearchSuggestions",M="EntityExtraction/ReplyWithQueryCoverage",F=x()({PropertyName:D,DistinguishedPropertySetId:"Common",PropertyType:"String"}),L=x()({PropertyName:M,DistinguishedPropertySetId:"Common",PropertyType:"String"});function U(e){return p.__awaiter(this,void 0,void 0,function(){var t,r,n,o,a;return p.__generator(this,function(i){switch(i.label){case 0:return null!=(t=N(e)).SubstrateSearchSuggestions||null!=t.ReplyWithQueryCoverage?[3,2]:(r=T()({BaseShape:"IdOnly",AdditionalProperties:[F,L]}),[4,Object(P.a)([e.ItemId.Id],r,null,null,e.MailboxInfo&&e.MailboxInfo.requestOptions)]);case 1:n=i.sent(),Object(C.a)(n[0])&&((o=n[0])&&o.Items&&o.Items[0]?(a=o.Items[0],t=N(a)):m.d.info("getReplyWithProperties: Unable to parse GetItem response properly.")),i.label=2;case 2:return[2,t]}})})}function N(e){var t={SubstrateSearchSuggestions:null,ReplyWithQueryCoverage:null},r=e.ExtendedProperty;if(r)for(var n=r.length,o=0;o<n;o++){var a=r[o];a.ExtendedFieldURI.PropertyName===D?t.SubstrateSearchSuggestions=a:a.ExtendedFieldURI.PropertyName===M&&(t.ReplyWithQueryCoverage=a)}return t}var k=r(65),B="/ows/search/api/v1/";function W(e){return p.__awaiter(this,void 0,void 0,function(){var t,r,n,o,a=this;return p.__generator(this,function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),t=function(e){var t={},r=function(e){var t=[];if(null!=e.ReplyWithQueryCoverage)for(var r=JSON.parse(e.ReplyWithQueryCoverage.Value)[0],n=r.coverageCheckResults,o=Object.keys(n),a=0;a<o.length;a++){var i=o[a];n[i]||t.push(i)}return t}(e);return JSON.parse(e.SubstrateSearchSuggestions.Value)[0].requests.forEach(function(e){var n=e.InputText;if(!r.includes(n)){var o=function(e,t){for(var r,n,o=B+e,a=0;a<t.length;a++)r=t[a].Key,n=t[a].Value,o+=0==a?"?":"&",o+=r+"="+n;return o}(e.Endpoint,e.UrlParameters);t[n]=o}}),t}(e),r={},(n=Object.keys(t)).length>0?(Object(b.o)("ReplyWithQueryExecuted"),[4,Promise.all(n.map(function(e){return p.__awaiter(a,void 0,void 0,function(){var n,o;return p.__generator(this,function(a){switch(a.label){case 0:return n=r,o=e,[4,z(t[e])];case 1:return[2,n[o]=a.sent()]}})})}))]):[3,2];case 1:return i.sent(),[2,G(r)];case 2:return[3,4];case 3:return o=i.sent(),m.d.info("Failed to parse property, error: "+o.message),[3,4];case 4:return[2,null]}})})}function z(e){return p.__awaiter(this,void 0,void 0,function(){var t,r,n,o,a;return p.__generator(this,function(i){switch(i.label){case 0:t=null,r=0,n="",o=null,i.label=1;case 1:return i.trys.push([1,3,4,5]),(o=new b.a("QueryResponseInformation")).addCustomData({endpoint:0}),[4,Object(k.b)(e)];case 2:return t=i.sent(),o.addCheckmark("Response"),t&&0!=t.length||(n="No response payload"),[3,5];case 3:return a=i.sent(),n=a.message,[3,5];case 4:return r=function(e){try{return e.Groups[0].Suggestions.length}catch(e){return 0}}(t),o.addCustomData({numResults:r}),n?o.endWithError("ServerError",new Error(n)):o.end(),[2,t];case 5:return[2]}})})}function G(e){try{var t={};return Object.keys(e).forEach(function(r){t[r]=e[r].Groups[0].Suggestions;for(var n=0;n<t[r].length;n++)t[r][n].Endpoint=0}),t}catch(e){return m.d.info("getSentenceToAttachmentSuggestionsMap: Failed to execute, error: "+e.message),null}}function V(e){return p.__awaiter(this,void 0,void 0,function(){var t,r;return p.__generator(this,function(n){switch(n.label){case 0:return t=null,[4,U(e)];case 1:return(r=n.sent())?[4,W(r)]:[3,3];case 2:t=n.sent(),n.label=3;case 3:return[2,t]}})})}Object(n.orchestrator)(f,function(e){return p.__awaiter(this,void 0,void 0,function(){var t,r,n;return p.__generator(this,function(o){switch(o.label){case 0:return t=e.referenceItemId,!(r=a.H.items.get(t))||r.AttachmentSuggestions?[3,2]:[4,V(r)];case 1:n=o.sent(),i(t,n),o.label=2;case 2:return[2]}})})});var X=r(1518),H=r(3626);function Q(e,t){return p.__awaiter(this,void 0,void 0,function(){var r;return p.__generator(this,function(n){switch(n.label){case 0:return r=null,Object(H.i)()!==H.c.NotLoaded?[3,2]:[4,H.k.import()];case 1:return n.sent()(function(n){r=q(Object(H.g)(),e),t(r)}),[3,3];case 2:r=q(Object(H.g)(),e),t(r),n.label=3;case 3:return[2]}})})}function q(e,t){var r=function(e){for(var t=0;t<e.length;t++)if(0==e[t].type)return e[t].model.Id;return m.d.warn("createCloudFileFromAttachmentData: Could not get OneDrive Pro provider ID. Attachment will not upload."),""}(e);return{fileType:3===t.Endpoint?X.a.ContextualSuggestion:X.a.CloudSuggestion,name:t.FileName,size:null,providerId:r,providerType:0,location:t.Url,providerEndpointUrl:null,isFolder:!1,fileId:t.Id,fileParentId:null,thumbnailUrl:null,previewUrl:null,type:null}}r.d(t,"getAttachmentSuggestionsAction",function(){return o}),r.d(t,"createCloudFileFromAttachmentData",function(){return Q})},3554:function(e,t,r){"use strict";var n=r(2),o=r(7),a=r(3641),i={providers:new o.ObservableMap,loadState:a.a.NotLoaded,removalPending:new o.ObservableMap},c=Object(n.createStore)("fileProviderStoreV2",i);t.a=c},3567:function(e,t,r){"use strict";r.d(t,"b",function(){return a}),r.d(t,"a",function(){return o}),r.d(t,"c",function(){return i});var n=r(2),o=Object(n.action)("FILE_PROVIDER_ADDED",function(e){return{providerViewState:e}}),a=Object(n.action)("FILE_PROVIDER_REMOVED",function(e){return{providerType:e}}),i=Object(n.action)("PROVIDERS_LOADED",function(e){return{providers:e}})},3594:function(e,t,r){"use strict";var n=r(0),o=r(4056),a=r.n(o),i=r(3774),c=r.n(i);function u(e){var t=c()({ProviderType:e});return a()(t)}var s=r(4057),d=r.n(s),l=r(3775),f=r.n(l);function h(e){var t=f()({ProviderType:e});return d()(t)}var p=r(4018),m=r(6);r.d(t,"a",function(){return j}),r.d(t,"b",function(){return A});var v="code",b="token",g=3e3,O=3;function y(e){return{state:e}}function S(e){return e.state}function I(e){return e.code}function j(e,t,r,o,a){var i={providerType:e,getAuthUrlInfo:null,getCSRFToken:S,getOAuthCode:I};return function e(t,r,o,a,i,c,s){return n.__awaiter(this,void 0,void 0,function(){var d,l;return n.__generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,5,,6]),d=void 0,7!==t&&9!==t&&8!==t?[3,2]:[4,h(t)];case 1:return l=n.sent(),d=l.AttachmentDataProviderCreator.ProviderAppKey,o=l.AttachmentDataProviderCreator.AuthorizationUri,[3,4];case 2:return[4,u(t)];case 3:l=n.sent(),d=l.ProviderAppKey,n.label=4;case 4:return r.getAuthUrlInfo=Object(p.d)(t,o,a,d,i,c),[3,6];case 5:return n.sent(),s>0&&setTimeout(function(){return e(t,r,o,a,i,c,--s)},g),[3,6];case 6:return[2]}})})}(e,i,t,r,o,a,O),i}var _=null;function w(){if(!_){(_={})[3]=j(3,"https://app.box.com/api/oauth2/authorize",Object(p.c)(3),v,y),_[2]=j(2,"https://www.dropbox.com/oauth2/authorize",Object(p.b)(2),v,y);var e=j(6,"https://www.facebook.com/dialog/oauth",Object(p.b)(6),b,function(e){return{state:e,scope:"user_photos,email"}});e.getCSRFToken=S,e.getOAuthCode=function(e){return e.access_token},_[6]=e;var t=j(5,"https://accounts.google.com/o/oauth2/auth",p.a+"/ADPRedirect.aspx",v,function(e){var t={state:e,provider:5..toString(),url:Object(p.b)()};return{state:JSON.stringify(t),scope:"https://www.googleapis.com/auth/drive",access_type:"offline",prompt:"consent",include_granted_scopes:"true"}});t.getCSRFToken=function(e){return JSON.parse(e.state).state},_[5]=t,_[1]=j(1,"https://login.live.com/oauth20_authorize.srf",Object(p.c)(1),v,function(e){return{state:e,scope:"wl.basic onedrive.readwrite wl.offline_access"}}),Object(m.e)("doc-fileProvider-wopiClient")&&(_[7]=j(7,"",Object(p.c)(7),v,y),_[8]=j(8,"",Object(p.c)(8),v,y),_[9]=j(9,"",Object(p.c)(9),v,y))}return _}function A(e){var t=w();return e in t?t[e]:null}},3601:function(e,t,r){"use strict";r.d(t,"b",function(){return a}),r.d(t,"a",function(){return i});var n=r(0),o=r(3554),a=function(){return n.__spread(Object(o.a)().providers.values())},i=function(e){return Object(o.a)().providers.get(e)||null}},3617:function(e,t,r){"use strict";r.d(t,"b",function(){return n}),r.d(t,"a",function(){return a}),r.d(t,"c",function(){return i});var n,o=r(0);!function(e){e[e.Groups=1e4]="Groups"}(n||(n={}));var a=Object.freeze([1,3,2,6,5,7,8,9]),i=Object.freeze(o.__spread(a,[0,4,10]))},3626:function(e,t,r){"use strict";var n=r(3),o=r(3748),a=r(3694),i=(r(3554),r(3567)),c=r(3617),u=(r(3979),r(3960),r(3601));var s=r(3679),d=r(3641),l=r(3594);r.d(t,"k",function(){return h}),r.d(t,"m",function(){return p}),r.d(t,"j",function(){return m}),r.d(t,"l",function(){return v}),r.d(t,"b",function(){return o.a}),r.d(t,"h",function(){return a.a}),r.d(t,"d",function(){return i.a}),r.d(t,"e",function(){return i.b}),r.d(t,"n",function(){return i.c}),r.d(t,"a",function(){return c.b}),r.d(t,"g",function(){return u.b}),r.d(t,"i",function(){return s.a}),r.d(t,"c",function(){return d.a}),r.d(t,"f",function(){return l.b});var f=new n.c(function(){return Promise.all([r.e(6),r.e(7),r.e(9),r.e(14),r.e(226)]).then(r.bind(null,13752))}),h=new n.b(f,function(e){return e.loadProviders}),p=new n.b(f,function(e){return e.removeFileProvider}),m=new n.b(f,function(e){return e.addFileProvider}),v=new n.b(f,function(e){return e.removeAndAddFileProvider})},3641:function(e,t,r){"use strict";var n;r.d(t,"a",function(){return n}),function(e){e[e.Loaded=0]="Loaded",e[e.Loading=1]="Loading",e[e.NotLoaded=2]="NotLoaded"}(n||(n={}))},3679:function(e,t,r){"use strict";r.d(t,"a",function(){return o});var n=r(3554);function o(){return Object(n.a)().loadState}},3694:function(e,t,r){"use strict";r.d(t,"a",function(){return u});var n=r(4055),o=r(3959),a=r(4029),i=r(4),c=r(75);function u(e,t){if(void 0===t&&(t=!1),t)return"";switch(e){case 0:return Object(i.a)(a.b);case 1:return Object(i.a)(a.a);case 2:case 9:return Object(i.a)(n.b);case 3:case 7:return Object(i.a)(n.a);case 5:return Object(i.a)(n.e);case 6:return Object(i.a)(n.d);case 4:return Object(i.a)(n.f);case 10:return Object(i.a)(o.b);case 8:return Object(i.a)(n.c);default:return Object(c.a)(e)}}},3748:function(e,t,r){"use strict";var n;!function(e){e[e.None=0]="None",e[e.Images=1]="Images"}(n||(n={})),t.a=n},3774:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0);t.default=function(e){return n.__assign({__type:"GetNewAttachmentDataProviderCreationInfoRequest:#Exchange"},e)}},3775:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0);t.default=function(e){return n.__assign({__type:"GetAttachmentDataProviderCreatorRequest:#Exchange"},e)}},3959:function(e){e.exports={a:"SAa",b:"TAa"}},3960:function(e,t,r){"use strict";r.d(t,"a",function(){return c});var n=r(10),o=r(44),a=r(75),i=r(6);function c(e){var t=Object(n.a)();switch(e){case 5:return t.AttachmentPolicy.GoogleDriveAttachmentsEnabled&&t.AttachmentPolicy.ThirdPartyAttachmentsEnabled&&Object(i.e)("doc-fileProvider-gdrive");case 4:case 0:return!0;case 3:return t.AttachmentPolicy.BoxAttachmentsEnabled&&t.AttachmentPolicy.ThirdPartyAttachmentsEnabled&&Object(i.e)("doc-fileProvider-box");case 2:return t.AttachmentPolicy.DropboxAttachmentsEnabled&&t.AttachmentPolicy.ThirdPartyAttachmentsEnabled&&Object(i.e)("doc-fileProvider-dropbox");case 6:return t.AttachmentPolicy.ThirdPartyAttachmentsEnabled&&Object(i.e)("doc-fileProvider-facebook");case 1:return!!Object(o.a)()||Object(i.e)("doc-filePicker-oneDriveConsumerForO365")&&t.AttachmentPolicy.OnedriveAttachmentsEnabled&&t.AttachmentPolicy.ThirdPartyAttachmentsEnabled;case 10:return Object(i.e)("doc-filePicker-mailMessageAttachment");case 7:case 8:case 9:return t.AttachmentPolicy.ThirdPartyAttachmentsEnabled&&Object(i.e)("doc-fileProvider-wopiClient");default:return Object(a.a)(e)}}},3979:function(e,t,r){"use strict";r.d(t,"a",function(){return o}),r.d(t,"b",function(){return a});var n=r(3617),o="file provider is not addable";function a(e){return n.a.indexOf(e)>-1}},4018:function(e,t,r){"use strict";var n=r(53),o=r(15);function a(e,t,r){if(!e||!t||!r)throw new Error("Key and Value parameters should not be null");return e.indexOf("?")>0?e+"&"+t+"="+r:e+"?"+t+"="+r}r.d(t,"a",function(){return i}),r.d(t,"b",function(){return c}),r.d(t,"c",function(){return u}),r.d(t,"d",function(){return s});var i=Object(o.u)()?"https://exchangelabs.live-int.com/owa":"https://outlook.office.com/owa";function c(e){var t=e?encodeURIComponent("?provider="+e):"",r=e&&6===e?"AddFacebookFileProvider.html":"AddFileProvider.html";return Object(n.n)()+"/mail/"+r+t}function u(e){var t=Object(n.n)()+"/mail/AddFileProvider.html",r=encodeURIComponent("provider="+e+"&url="+t);return i+"/ADPRedirect.aspx?"+r}function s(e,t,r,n,o,i){return function(){var e=function(){for(var e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".split(""),t=e.length-1,r=[],n=0;n<16;n++)r.push(e[Math.round(Math.random()*t)]);return"owa_csrf_token_"+r.join("")}(),c=a(t,"client_id",n);if(c=a(c,"redirect_uri",r),c=a(c,"response_type",o),i){var u=i(e);c=Object.keys(u).reduce(function(e,t){return a(e,t,u[t])},c)}return{authUrl:c,redirectUrl:r,csrfToken:e}}}},4029:function(e){e.exports={b:"LBa",a:"MBa"}},4055:function(e){e.exports={b:"FBa",a:"GBa",e:"HBa",d:"IBa",f:"JBa",c:"KBa"}},4056:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(56),o=r(3774);t.default=function(e,t){return void 0===e||e.__type||(e=o.default(e)),n.makeServiceRequest("GetNewAttachmentDataProviderCreationInfo",e,t)}},4057:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(56),o=r(3775);t.default=function(e,t){return void 0===e||e.__type||(e=o.default(e)),n.makeServiceRequest("GetAttachmentDataProviderCreator",e,t)}},492:function(e,t,r){"use strict";function n(e){if(!e)return null;var t=e.lastIndexOf(".");return t>0?e.substr(t).toLowerCase():null}function o(e){var t=n(e);return t?t.replace(".",""):null}var a=r(1267),i=r(4);function c(e){var t;return e>=1073741824?(e/=1073741824,t=Object(i.a)(a.b)):e>=1048576?(e/=1048576,t=Object(i.a)(a.d)):e>=1024?(e/=1024,t=Object(i.a)(a.c)):t=Object(i.a)(a.a),Object(i.b)(t,Math.round(e))}function u(e){return e&&(t=e,(r=d.exec(t))&&r.length>1&&s[r[1].toLowerCase()]);var t,r}var s={"image/bmp":".bmp","image/x-ms-bmp":".bmp","image/gif":".gif","image/jpeg":".jpeg","image/png":".png","image/vnd.adobe.photoshop":".psd","image/tiff":".tiff"},d=/^\s*([^;\s]*)(?:;|\s|$)/;var l=r(77),f=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd"],h=[".tiff",".tif"];function p(e,t,r){void 0===r&&(r=!0);var o=n(e)||u(t);return!!o&&(f.indexOf(o.toLowerCase())>=0||r&&h.indexOf(o.toLowerCase())>=0&&(Object(l.d)()||Object(l.c)()||Object(l.g)()||Object(l.f)()&&!Object(l.i)()))}var m,v=r(6),b=[".pdf",".doc",".docx",".odt",".rtf",".ppt",".pptx",".pptm",".potx",".potm",".pot",".ppxx",".pps",".odp"];function g(e){if(!Object(v.e)("doc-attachment-documentThumbnail"))return!1;var t=n(e);return!!t&&b.indexOf(t.toLowerCase())>=0}function O(e){switch(e){case".doc":case".docm":case".docx":case".dot":case".dotm":case".dotx":case".odt":case".rtf":return m.Word;case".csv":case".ods":case".xls":case".xlsb":case".xlsm":case".xlsx":return m.Excel;case".odp":case".pot":case".potm":case".potx":case".pps":case".ppsm":case".ppsx":case".ppt":case".pptm":case".pptx":return m.PowerPoint;default:return null}}!function(e){e[e.Word=0]="Word",e[e.Excel=1]="Excel",e[e.PowerPoint=2]="PowerPoint"}(m||(m={})),r.d(t,"b",function(){return n}),r.d(t,"c",function(){return o}),r.d(t,"g",function(){return c}),r.d(t,"e",function(){return p}),r.d(t,"f",function(){return g}),r.d(t,"d",function(){return O}),r.d(t,"a",function(){return m})},887:function(e,t,r){"use strict";var n;r.d(t,"a",function(){return n}),function(e){e[e.Base64InlineImage=0]="Base64InlineImage",e[e.Cloud=1]="Cloud",e[e.Local=2]="Local",e[e.MailItem=3]="MailItem",e[e.Uri=4]="Uri",e[e.AttachmentItem=5]="AttachmentItem",e[e.CloudSuggestion=6]="CloudSuggestion",e[e.AttachmentItemSuggestion=7]="AttachmentItemSuggestion",e[e.Inline=8]="Inline",e[e.Smime=9]="Smime",e[e.FilesHub=10]="FilesHub",e[e.GroupFilesHub=11]="GroupFilesHub",e[e.MailSearchFileSuggestion=12]="MailSearchFileSuggestion",e[e.Unknown=13]="Unknown",e[e.ContextualSuggestion=14]="ContextualSuggestion"}(n||(n={}))}},0,[6,7,9,14,226,0,1,526,178,514,105,24,116]]);
//# sourceMappingURL=owa.AttachmentSuggestions.js.map
self.scriptsLoaded['owa.AttachmentSuggestions.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.AttachmentSuggestions.js'] = (new Date()).getTime();