self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.AddinsCommon.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[110],{12565:function(e){e.exports={a:"zPb"}},1287:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"MailboxMessageConfigurationOptions:#Exchange"},e)}},1288:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(56),o=n(982);t.default=function(e,t){return void 0===e||e.__type||(e=o.default(e)),r.makeServiceRequest("SetMailboxMessageConfiguration",e,t)}},13950:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n(25),i=n(4),a=n(12565),c=n(1),s=n(575),l=n(2976),u=n(28),d=n(18),f=Object(u.a)(function(){var e=Object(o.f)().UserOptions;return c.createElement(l.a,{defaultChecked:e.CheckForForgottenAttachments,onText:Object(i.a)(a.a),offText:Object(i.a)(a.a),onChange:h})});function h(e,t){Object(s.m)({CheckForForgottenAttachments:t});try{!function(e){r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(t){switch(t.label){case 0:return Object(d.o)("ForgottenAttachmentsSettingChange",{entrySource:"MailSendConfirmDialog",value:e}),[4,Object(s.l)([{propertyName:"CheckForForgottenAttachments",propertyType:"Boolean",propertyValue:""+e}],"OWA.UserOptions")];case 1:return t.sent(),[2]}})})}(t)}catch(e){Object(s.m)({CheckForForgottenAttachments:!t})}}n.d(t,"ForgottenAttachmentsDialogToggle",function(){return f})},2078:function(e,t,n){"use strict";var r=n(1625),o=n(0),i=n(1),a=n(185),c=n(867),s=Object(c.a)({disableCaching:!0}),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.as,n=void 0===t?"label":t,r=e.children,c=e.className,l=e.disabled,u=e.styles,d=e.required,f=e.theme,h=s(u,{className:c,disabled:l,required:d,theme:f});return i.createElement(n,o.__assign({},Object(a.j)(this.props,a.h),{className:h.root}),r)},t}(i.Component),u=n(13);n.d(t,"a",function(){return d});var d=Object(r.a)(l,function(e){var t,n=e.theme,r=e.className,o=e.disabled,i=e.required,a=n.semanticColors,c=u.FontWeights.semibold,s=a.bodyText,l=a.disabledBodyText,d=a.errorText;return{root:["ms-Label",n.fonts.medium,{fontWeight:c,color:s,boxSizing:"border-box",boxShadow:"none",margin:0,display:"block",padding:"5px 0",wordWrap:"break-word",overflowWrap:"break-word"},o&&{color:l,selectors:(t={},t[u.HighContrastSelector]={color:"GrayText"},t)},i&&{selectors:{"::after":{content:"' *'",color:d,paddingRight:12}}},r]}},void 0,{scope:"Label"})},2976:function(e,t,n){"use strict";var r=n(1625),o=n(0),i=n(1),a=n(867),c=n(135),s=n(185),l=n(274),u=n(2078),d=n(796),f=Object(a.a)(),h=function(e){function t(t){var n=e.call(this,t)||this;return n._toggleButton=i.createRef(),n._onClick=function(e){var t=n.props,r=t.disabled,o=t.checked,i=t.onChange,a=t.onChanged,c=t.onClick,s=n.state.checked;r||(void 0===o&&n.setState({checked:!s}),i&&i(e,!s),a&&a(!s),c&&c(e))},n._warnMutuallyExclusive({checked:"defaultChecked"}),n._warnDeprecations({onAriaLabel:"ariaLabel",offAriaLabel:void 0,onChanged:"onChange"}),n.state={checked:!(!t.checked&&!t.defaultChecked)},n._id=t.id||Object(c.c)("Toggle"),n}return o.__extends(t,e),t.getDerivedStateFromProps=function(e,t){return void 0===e.checked?t:o.__assign({},t,{checked:!!e.checked})},Object.defineProperty(t.prototype,"checked",{get:function(){return this.state.checked},enumerable:!0,configurable:!0}),t.prototype.render=function(){var e=this,t=this.props,n=t.as,r=void 0===n?"div":n,a=t.className,c=t.theme,l=t.disabled,h=t.keytipProps,g=t.label,m=t.ariaLabel,b=t.onAriaLabel,p=t.offAriaLabel,v=t.offText,y=t.onText,C=t.styles,O=t.inlineLabel,k=this.state.checked,_=k?y:v,x=k?b:p,S=Object(s.j)(this.props,s.o,["defaultChecked"]),j=f(C,{theme:c,className:a,disabled:l,checked:k,inlineLabel:O,onOffMissing:!y&&!v}),w=this._id+"-label",F=this._id+"-stateText",T=void 0;return m||x||(g?T=w:_&&(T=F)),i.createElement(r,{className:j.root,hidden:S.hidden},g&&i.createElement(u.a,{htmlFor:this._id,className:j.label,id:w},g),i.createElement("div",{className:j.container},i.createElement(d.a,{keytipProps:h,ariaDescribedBy:S["aria-describedby"],disabled:l},function(t){return i.createElement("button",o.__assign({},S,t,{className:j.pill,disabled:l,id:e._id,type:"button",role:"switch",ref:e._toggleButton,"aria-disabled":l,"aria-checked":k,"aria-label":m||x,"data-is-focusable":!0,onChange:e._noop,onClick:e._onClick,"aria-labelledby":T}),i.createElement("div",{className:j.thumb}))}),_&&i.createElement(u.a,{htmlFor:this._id,className:j.text,id:F},_)))},t.prototype.focus=function(){this._toggleButton.current&&this._toggleButton.current.focus()},t.prototype._noop=function(){},t}(l.a),g=n(13);n.d(t,"a",function(){return m});var m=Object(r.a)(h,function(e){var t,n,r,o,i,a,c,s=e.theme,l=e.className,u=e.disabled,d=e.checked,f=e.inlineLabel,h=e.onOffMissing,m=s.semanticColors,b=s.palette,p=m.bodyBackground,v=m.inputBackgroundChecked,y=b.themeDark,C=b.neutralDark,O=m.disabledBodySubtext,k=m.smallInputBorder,_=m.inputForegroundChecked,x=m.disabledBodySubtext,S=m.disabledBackground,j=m.smallInputBorder,w=m.inputBorderHovered,F=m.disabledBodySubtext,T=m.disabledText;return{root:["ms-Toggle",d&&"is-checked",!u&&"is-enabled",u&&"is-disabled",s.fonts.medium,{marginBottom:"8px"},f&&{display:"flex",alignItems:"center"},l],label:["ms-Toggle-label",u&&{color:T,selectors:(t={},t[g.HighContrastSelector]={color:"GrayText"},t)},f&&!h&&{marginRight:16},h&&f&&{order:1,marginLeft:16}],container:["ms-Toggle-innerContainer",{display:"inline-flex",position:"relative"}],pill:["ms-Toggle-background",Object(g.getFocusStyle)(s,{inset:-3}),{fontSize:"20px",boxSizing:"border-box",width:40,height:20,borderRadius:10,transition:"all 0.1s ease",border:"1px solid "+j,background:p,cursor:"pointer",display:"flex",alignItems:"center",padding:"0 3px"},!u&&[!d&&{selectors:{":hover":[{borderColor:w}],":hover .ms-Toggle-thumb":[{backgroundColor:C,selectors:(n={},n[g.HighContrastSelector]={borderColor:"Highlight"},n)}]}},d&&[{background:v,borderColor:"transparent",justifyContent:"flex-end"},{selectors:(r={":hover":[{backgroundColor:y,borderColor:"transparent",selectors:(o={},o[g.HighContrastSelector]={backgroundColor:"Highlight"},o)}]},r[g.HighContrastSelector]={backgroundColor:"WindowText"},r)}]],u&&[{cursor:"default"},!d&&[{borderColor:F}],d&&[{backgroundColor:O,borderColor:"transparent",justifyContent:"flex-end"}]],!u&&{selectors:{"&:hover":{selectors:(i={},i[g.HighContrastSelector]={borderColor:"Highlight"},i)}}}],thumb:["ms-Toggle-thumb",{width:12,height:12,borderRadius:"50%",transition:"all 0.1s ease",backgroundColor:k,borderColor:"transparent",borderWidth:".28em",borderStyle:"solid",boxSizing:"border-box"},!u&&d&&[{backgroundColor:_,selectors:(a={},a[g.HighContrastSelector]={backgroundColor:"Window",borderColor:"Window"},a)}],u&&[!d&&[{backgroundColor:x}],d&&[{backgroundColor:S}]]],text:["ms-Toggle-stateText",{selectors:{"&&":{padding:"0",margin:"0 8px",userSelect:"none",fontWeight:g.FontWeights.regular}}},u&&{selectors:{"&&":{color:T,selectors:(c={},c[g.HighContrastSelector]={color:"GrayText"},c)}}}]}},void 0,{scope:"Toggle"})},3037:function(e,t,n){"use strict";n.r(t);var r,o=n(1429),i=n(691),a="FileAttachment:#Exchange",c="ItemAttachment:#Exchange",s="ReferenceAttachment:#Exchange";function l(e){var t=[];return e&&(e.inlineAttachments&&e.inlineAttachments.forEach(function(e){var n=d(e);t.push(n)}),e.docViewAttachments&&e.docViewAttachments.forEach(function(e){var n=d(e);t.push(n)}),e.imageViewAttachments&&e.imageViewAttachments.forEach(function(e){var n=d(e);t.push(n)})),t}function u(e){switch(e){case a:return r.File;case c:return r.Item;case s:return r.Cloud;default:throw new Error("Invalid type of attachment "+e)}}function d(e){var t=void 0,n=Object(o.a)(e.attachmentId);if(n&&n.model){Object(i.b)(n.model)&&(t=n.model.AttachLongPathName);var r={id:e.attachmentId.Id,name:n.model.Name,contentType:n.model.ContentType,size:n.model.Size,attachmentType:u(n.model.__type),isInline:n.model.IsInline,url:t}}return r}!function(e){e[e.File=0]="File",e[e.Item=1]="Item",e[e.Cloud=2]="Cloud"}(r||(r={}));var f,h=n(0),g=n(1957),m=n(543),b=n(75),p="IPM.Note";function v(e,t){return h.__awaiter(this,void 0,void 0,function(){var t,n,r,i,a,c,s,l,u,d;return h.__generator(this,function(h){switch(h.label){case 0:return t=null,n=null,null,r=null,i={content:"",format:f.Base64},a=Object(o.a)(e.attachmentId),[4,g.c.importAndExecute(a.model.__type)];case 1:return(c=h.sent())!==m.k.Item?[3,4]:(t=a.download.url,[4,fetch(t)]);case 2:return[4,h.sent().text()];case 3:return r=h.sent(),s=a.model.EmbeddedItemClass||p,i.format="IPM.Note"===s?f.Eml:f.Ical,i.content=r,[3,9];case 4:return c!==m.k.Cloud?[3,5]:(t=a.download.url,l=new URLSearchParams(t),u=l.get("location"),d=decodeURIComponent(u),i.format=f.Url,i.content=d,[3,9]);case 5:return c!==m.k.File?[3,8]:(t=a.download.url+"&asDataUri=true",[4,fetch(t)]);case 6:return[4,h.sent().text()];case 7:return r=h.sent(),n=r.substr(r.indexOf(",")+1),n=(v=n)?v.replace(/\s+/g,""):v,i.format=f.Base64,i.content=n,[3,9];case 8:Object(b.a)(c),h.label=9;case 9:return[2,i]}var v})})}!function(e){e.Base64="base64",e.Eml="eml",e.Url="url",e.Ical="iCalendar"}(f||(f={})),n.d(t,"getAllAttachments",function(){return l}),n.d(t,"getAttachmentContentHelper",function(){return v}),n.d(t,"getTypeOfAttachment",function(){return u})},575:function(e,t,n){"use strict";var r=n(3),o=n(162),i=n.n(o),a=n(104),c=n.n(a),s=n(183);function l(e,t){return void 0===t&&(t="OWA.UserOptions"),Object(s.a)(t,e.map(function(e){return i()({DictionaryKey:c()({Type:"String",Value:[e.propertyName]}),DictionaryValue:c()({Type:e.propertyType,Value:Array.isArray(e.propertyValue)?e.propertyValue:[e.propertyValue]})})}))}var u=n(1287),d=n.n(u),f=n(982),h=n.n(f),g=n(1288),m=n.n(g),b=n(26);function p(e){return m()(h()({Header:Object(b.getJsonRequestHeader)(),Options:d()(e)}))}function v(e,t){return null===e?t:e}var y=n(2),C=n(25),O=n(179),k=Object(y.mutatorAction)("updateSessionSettings",function(e){O(Object(C.f)().SessionSettings,e)}),_=n(179),x=Object(y.mutatorAction)("updateUserOptions",function(e){_(Object(C.f)().UserOptions,e)});function S(e){var t=A(e);return!!t&&t.reduce(function(e,t){return e||t.fullOptionFormSettings.isDirty()},!1)}function j(e){var t=A(e);return t&&t.reduce(function(e,t){return e&&!!t.fullOptionFormSettings.hideSaveDiscard&&t.fullOptionFormSettings.hideSaveDiscard()},!0)}function w(e){var t=A(e);return!t||t.filter(function(e){return e.fullOptionFormSettings.isDirty()}).reduce(function(e,t){return e&&!!t.fullOptionFormSettings.disableSave&&t.fullOptionFormSettings.disableSave()},!0)}var F=n(0);function T(e,t,n,o,i){var a=new r.b(t,n),c=o&&i?new r.b(o,i):null;return F.__assign({},e,{tryImportFullOptionFormSettingsSync:function(){return a.tryImportForRender()},tryImportQuickOptionSettingsSync:c?function(){return c.tryImportForRender()}:void 0})}function A(e){var t=e.options.map(function(e){return function(e){return"fullOptionFormSettings"in e}(e)?e:F.__assign({},e,{fullOptionFormSettings:e.tryImportFullOptionFormSettingsSync()})});return t.some(function(e){return!e.fullOptionFormSettings})?null:t}var I=Object(y.action)("HIDE_FULL_OPTION",function(e){return{showQuickOptions:e}});n.d(t,"g",function(){return N}),n.d(t,"a",function(){return B}),n.d(t,"l",function(){return l}),n.d(t,"h",function(){return p}),n.d(t,"c",function(){return v}),n.d(t,"k",function(){return k}),n.d(t,"m",function(){return x}),n.d(t,"f",function(){return S}),n.d(t,"e",function(){return j}),n.d(t,"i",function(){return w}),n.d(t,"b",function(){return T}),n.d(t,"j",function(){return A}),n.d(t,"d",function(){return I});var E=new r.c(function(){return Promise.all([n.e(5),n.e(15),n.e(40),n.e(85),n.e(344)]).then(n.bind(null,13901))}),N=new r.a(E,function(e){return e.confirmOptionNavigation}),B=Object(r.d)(E,function(e){return e.OptionsEditor})},691:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"b",function(){return i});var r=n(956);function o(e){return a(e.type)}function i(e){return a(Object(r.a)(e))}function a(e){return 1===e||3===e}},982:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"SetMailboxMessageConfigurationRequest:#Exchange"},e)}}},0,[5,15,40,85,344,514,105,24,116]]);
//# sourceMappingURL=owa.AddinsCommon.js.map
self.scriptsLoaded['owa.AddinsCommon.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.AddinsCommon.js'] = (new Date()).getTime();