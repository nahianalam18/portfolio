self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.18.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[18],{1065:function(r,t,e){"use strict";function c(r){return!!r&&(!!r.LocationUri||!(!r.Latitude||!r.Longitude))}e.d(t,"a",function(){return c})},1567:function(r,t,e){"use strict";function c(r){var t=[];return r&&r.forEach(function(r){t.push({Id:r.personaId,DisplayName:r.displayName,PostalAddress:r.postalAddress})}),t}e.d(t,"a",function(){return c})},320:function(r,t,e){"use strict";e.d(t,"w",function(){return c}),e.d(t,"n",function(){return n}),e.d(t,"y",function(){return a}),e.d(t,"z",function(){return _}),e.d(t,"x",function(){return s}),e.d(t,"m",function(){return o}),e.d(t,"v",function(){return u}),e.d(t,"g",function(){return i}),e.d(t,"o",function(){return p}),e.d(t,"p",function(){return d}),e.d(t,"e",function(){return l}),e.d(t,"A",function(){return y}),e.d(t,"r",function(){return f}),e.d(t,"a",function(){return b}),e.d(t,"t",function(){return h}),e.d(t,"c",function(){return A}),e.d(t,"h",function(){return m}),e.d(t,"f",function(){return g}),e.d(t,"B",function(){return P}),e.d(t,"s",function(){return v}),e.d(t,"b",function(){return O}),e.d(t,"u",function(){return j}),e.d(t,"d",function(){return S}),e.d(t,"l",function(){return w}),e.d(t,"i",function(){return L}),e.d(t,"j",function(){return k}),e.d(t,"k",function(){return R}),e.d(t,"q",function(){return C});var c="Sunday",n="Monday",a="Tuesday",_="Wednesday",s="Thursday",o="Friday",u="Saturday",i=[c,n,a,_,s,o,u],p=["January","February","March","April","May","June","July","August","September","October","November","December"],d="None",l="DailyRecurrence",y="WeeklyRecurrence",f="RelativeMonthlyRecurrence",b="AbsoluteMonthlyRecurrence",h="RelativeYearlyRecurrence",A="AbsoluteYearlyRecurrence",m=["None","First","Second","Third","Fourth","Last"],g="DailyRecurrence:#Exchange",P="WeeklyRecurrence:#Exchange",v="RelativeMonthlyRecurrence:#Exchange",O="AbsoluteMonthlyRecurrence:#Exchange",j="RelativeYearlyRecurrence:#Exchange",S="AbsoluteYearlyRecurrence:#Exchange",w="EndDateRecurrence:#Exchange",L=3,k=25,R=1,C=[1,2,3,4,5,6,7,8,9,10]},502:function(r,t,e){"use strict";var c=e(10),n=e(70),a="en-us",_={"am-et":"a_c_pc_pr_ctry","ar-dz":"a_pc_c_pr_ctry","ar-bh":"a_pc_c_pr_ctry","ar-eg":"a_ctry_c_pr_pc","ar-iq":"a_pc_c_pr_ctry","ar-jo":"a_c_pc_pr_ctry","ar-kw":"a_pc_c_pr_ctry","ar-lb":"a_c_pc_pr_ctry","ar-ly":"a_pc_c_pr_ctry","ar-ma":"a_pc_c_pr_ctry","ar-om":"a_c_pr_ctry_pc","ar-qa":"a_pc_c_pr_ctry","ar-sa":"a_c_pc_pr_ctry","ar-sy":"a_pc_c_pr_ctry","ar-tn":"a_pc_c_pr_ctry","ar-ae":"a_pc_c_pr_ctry","ar-ye":"a_pc_c_pr_ctry","eu-es":"a_pc_c_pr_ctry","bn-in":"a_c_pc_pr_ctry","bg-bg":"a_pc_c_pr_ctry","ca-es":"a_pc_c_pr_ctry","zh-cn":"pc_ctry_pr_c_a","zh-sg":"a_c_pc_pr_ctry","zh-hk":"ctry_pc_pr_c_a","zh-mo":"ctry_pr_c_pc_a","zh-tw":"pc_ctry_pr_c_a","hr-hr":"a_pc_c_pr_ctry","cs-cz":"a_pc_c_pr_ctry","da-dk":"a_pc_c_pr_ctry","nl-be":"a_pc_c_pr_ctry","nl-nl":"a_pc_c_pr_ctry","en-au":"a_c_pc_pr_ctry","en-bz":"a_pc_c_pr_ctry","en-ca":"a_c_pc_pr_ctry","en-ie":"a_c_pc_pr_ctry","en-jm":"a_pc_c_pr_ctry","en-nz":"a_c_pc_pr_ctry","en-ph":"a_pc_pr_c_ctry","en-za":"a_c_pc_pr_ctry","en-tt":"a_pc_c_pr_ctry","en-gb":"a_c_pc_pr_ctry","en-us":"a_c_pr_pc_ctry","en-zw":"a_pc_c_pr_ctry","et-ee":"a_pc_c_pr_ctry","fil-ph":"a_pc_pr_c_ctry","fi-fi":"a_pc_c_pr_ctry","fr-be":"a_pc_c_pr_ctry","fr-ca":"a_c_pc_pr_ctry","fr-fr":"a_pc_c_pr_ctry","fr-lu":"a_pc_c_pr_ctry","fr-mc":"a_pc_c_pr_ctry","fr-ch":"a_pc_c_pr_ctry","gl-es":"a_pc_c_pr_ctry","de-at":"a_pc_c_pr_ctry","de-de":"a_pc_c_pr_ctry","de-li":"a_pc_c_pr_ctry","de-lu":"a_pc_c_pr_ctry","de-ch":"a_pc_c_pr_ctry","el-gr":"a_pc_c_pr_ctry","gu-in":"a_c_pc_pr_ctry","he-il":"a_pc_c_pr_ctry","hi-in":"a_c_pc_pr_ctry","hu-hu":"c_a_pc_pr_ctry","is-is":"a_pc_c_pr_ctry","id-id":"a_c_pc_pr_ctry","it-it":"a_pc_c_pr_ctry","it-ch":"a_pc_c_pr_ctry","ja-jp":"pc_pr_c_a_ctry","kn-in":"a_c_pc_pr_ctry","kk-kz":"ctry_pr_c_pc_a","sw-ke":"a_c_pc_pr_ctry","ko-kr":"pc_pr_c_a_ctry","lv-lv":"a_c_pc_pr_ctry","lt-lt":"a_c_pc_pr_ctry","ms-bn":"a_c_pc_pr_ctry","ms-my":"a_pc_c_pr_ctry","ml-in":"a_c_pc_pr_ctry","mr-in":"a_c_pc_pr_ctry","nb-no":"a_pc_c_pr_ctry","or-in":"a_c_pc_pr_ctry","fa-ir":"a_c_pc_pr_ctry","pl-pl":"a_pc_c_pr_ctry","pt-br":"a_pc_c_pr_ctry","pt-pt":"a_pc_c_pr_ctry","ro-ro":"a_pc_c_pr_ctry","ru-ru":"ctry_pc_pr_c_a","sr-cyrl-cs":"a_pc_c_pr_ctry","sk-sk":"a_pc_c_pr_ctry","sl-si":"a_pc_c_pr_ctry","es-ar":"a_pc_c_pr_ctry","es-bo":"a_pc_c_pr_ctry","es-cl":"a_pc_c_pr_ctry","es-co":"a_pc_c_pr_ctry","es-cr":"a_pc_c_pr_ctry","es-do":"a_pc_c_pr_ctry","es-ec":"a_pc_c_pr_ctry","es-sv":"a_c_pc_pr_ctry","es-gt":"a_pc_c_pr_ctry","es-hn":"a_pc_c_pr_ctry","es-mx":"a_pc_c_pr_ctry","es-ni":"a_c_pc_pr_ctry","es-pa":"a_pc_c_pr_ctry","es-py":"a_pc_c_pr_ctry","es-pe":"a_pc_c_pr_ctry","es-pr":"a_c_pc_pr_ctry","es-es":"a_pc_c_pr_ctry","es-us":"a_c_pc_pr_ctry","es-uy":"a_pc_c_pr_ctry","es-ve":"a_pc_c_pr_ctry","sv-fi":"a_pc_c_pr_ctry","sv-se":"a_pc_c_pr_ctry","ta-in":"a_c_pc_pr_ctry","te-in":"a_c_pc_pr_ctry","th-th":"a_c_pc_pr_ctry","tr-tr":"a_pc_pr_c_ctry","uk-ua":"ctry_pc_pr_c_a","ur-pk":"a_c_pc_pr_ctry","cy-gb":"a_c_pc_pr_ctry"};var s=", ";function o(r,t,e,c,a,_){var s=[];Object(n.b)(r)||(s[s.length]=r);var o="";return Object(n.b)(t)||(o=t),Object(n.b)(e)||(o=Object(n.b)(o)?e:o+_+e),Object(n.b)(c)||(o=Object(n.b)(o)?c:o+_+c),Object(n.b)(o)||(s[s.length]=o),Object(n.b)(a)||(s[s.length]=a),s}function u(r,t,e,u,i){var p=function(){var r=Object(c.a)(),t="";r&&r.SessionSettings&&!Object(n.b)(r.SessionSettings.UserCulture)&&(t=r.SessionSettings.UserCulture.toLowerCase());var e=_[t];return null==e&&(e=_[a]),e}(),d=[],l=s;switch(p){case"a_c_pc_pr_ctry":d=o(r,t,e,u,i,l);break;case"a_c_pr_ctry_pc":d=o(r,t,u,i,e,l);break;case"a_c_pr_pc_ctry":d=o(r,t,u,e,i,l);break;case"a_ctry_c_pr_pc":d=o(r,i,t,u,e,l);break;case"a_pc_c_pr_ctry":d=o(r,e,t,u,i,l);break;case"a_pc_pr_c_ctry":d=o(r,e,u,t,i,l);break;case"c_a_pc_pr_ctry":d=o(t,r,e,u,i,l);break;case"ctry_pc_pr_c_a":d=o(i,e,u,t,r,l);break;case"ctry_pr_c_pc_a":d=o(i,u,t,e,r,l);break;case"pc_ctry_pr_c_a":d=o(e,i,u,t,r,l);break;case"pc_pr_c_a_ctry":d=o(e,u,t,r,i,l)}return d.join(l)}function i(r){return r?u(r.Street,r.City,r.PostalCode,r.State,r.Country):""}function p(r,t){return Object(n.b)(r)?i(t):r}var d=e(4);function l(r,t,e){var c=i(t);return Object(n.b)(r)?c:""==c||e?r:Object(d.b)("{0} ({1})",r,c)}e.d(t,"a",function(){return i}),e.d(t,"b",function(){return u}),e.d(t,"c",function(){return p}),e.d(t,"d",function(){return l})},505:function(r,t,e){"use strict";e.d(t,"a",function(){return n});var c=e(1065);function n(r){return Object(c.a)(r)&&"Resource"===r.LocationSource}},618:function(r,t,e){"use strict";e.d(t,"d",function(){return n}),e.d(t,"a",function(){return _}),e.d(t,"c",function(){return s}),e.d(t,"b",function(){return o});var c=e(505);function n(r,t){if(null==r&&null!=t||null!=r&&null==t)return!1;if(null==r&&null==t)return!0;if(0==r.length&&0==t.length)return!0;if(r.length!=t.length)return!1;for(var e=0;e<r.length;){if(!a(r[e],t[e]))return!1;e++}return!0}function a(r,t){return!(!r&&t||r&&!t)&&(r.Id===t.Id||Object(c.a)(r.PostalAddress)&&Object(c.a)(t.PostalAddress)&&r.PostalAddress.LocationUri.toLowerCase()===t.PostalAddress.LocationUri.toLowerCase())}function _(r,t){return r&&Object(c.a)(t.PostalAddress)?s(r,t.PostalAddress.LocationUri):o(r,t.Id)}function s(r,t){return r&&r.some(function(r){return Object(c.a)(r.PostalAddress)&&r.PostalAddress.LocationUri.toLowerCase()===t.toLowerCase()})}function o(r,t){return r&&r.some(function(r){return r.Id===t})}},788:function(r,t,e){"use strict";e.d(t,"a",function(){return n}),e.d(t,"e",function(){return a}),e.d(t,"i",function(){return _}),e.d(t,"b",function(){return s}),e.d(t,"c",function(){return o}),e.d(t,"f",function(){return u}),e.d(t,"g",function(){return i}),e.d(t,"d",function(){return p}),e.d(t,"h",function(){return d});var c=e(320);function n(r){return r?p(r)?c.e:d(r)?c.A:u(r)?c.r:s(r)?c.a:i(r)?c.t:o(r)?c.c:c.p:c.p}function a(r){return s(r)||u(r)}function _(r){return o(r)||i(r)}function s(r){return r&&r.RecurrencePattern&&r.RecurrencePattern.__type==c.b}function o(r){return r&&r.RecurrencePattern&&r.RecurrencePattern.__type==c.d}function u(r){return r&&r.RecurrencePattern&&r.RecurrencePattern.__type==c.s}function i(r){return r&&r.RecurrencePattern&&r.RecurrencePattern.__type==c.u}function p(r){return r&&r.RecurrencePattern&&r.RecurrencePattern.__type==c.f}function d(r){return r&&r.RecurrencePattern&&r.RecurrencePattern.__type==c.B}},966:function(r,t,e){"use strict";e.d(t,"a",function(){return a});var c=e(3),n=new c.c(function(){return Promise.all([e.e(6),e.e(7),e.e(9),e.e(14),e.e(240)]).then(e.bind(null,2609))}),a=new c.b(n,function(r){return r.logServiceCallForDiagnostics})},980:function(r,t,e){"use strict";var c=e(618);e(1567);function n(r){var t=[];return r&&"string"!=typeof r&&t.push({Id:r.personaId,DisplayName:r.displayName,PostalAddress:r.postalAddress}),t}var a=/\(([^)]*)\)/gi,_=/\([^)]*\)|[\0-\u001F\!-\/:-@\[-`\{-\u00BF\u0250-\u036F\uD800-\uFFFF]/gi,s=/\s+/gi;function o(r){var t="";if(!r)return t;var e=(r=(r=(r=(r=r.replace(a,"")).replace(_,"")).replace(s," ")).trim()).split(" ");return e.length>=2?(t+=e[0].charAt(0).toUpperCase(),t+=e[e.length-1].charAt(0).toUpperCase()):0!=e.length&&(t+=e[0].charAt(0).toUpperCase()),t}var u=e(14),i=Object.keys(u.a).length/2;function p(r){if(!r)return null;for(var t=0,e=r.length-1;e>=0;e--){var c=r.charCodeAt(e),n=e%8;t^=(c<<n)+(c>>8-n)}return t%i}function d(r){return{personaId:r,displayName:r,postalAddress:{Type:"Business",LocationSource:"None"},displayAddress:"",initials:o(r),textBoyColor:p(r),selectionSource:"ExplicitTyping",personaType:"Unknown",personaControlId:r}}var l=e(502),y=e(70);function f(r){if(r){var t=function(r){return r?null!=r.HomeAddressesArray&&r.HomeAddressesArray.length>0?r.HomeAddressesArray[0].Value:null!=r.BusinessAddressesArray&&r.BusinessAddressesArray.length>0?r.BusinessAddressesArray[0].Value:null!=r.OtherAddressesArray&&r.OtherAddressesArray.length>0?r.OtherAddressesArray[0].Value:null:null}(r),e=Object(l.c)(r.DisplayName,t);return"Room"==r.PersonaTypeString&&(t.LocationUri=r.EmailAddress.EmailAddress),{personaId:r.PersonaId&&r.PersonaId.Id,feedbackId:r.FeedbackId,displayName:e,postalAddress:t,emailAddress:r.EmailAddress,displayAddress:Object(l.a)(t),initials:o(e),textBoyColor:p(e),selectionSource:"LocationWell",personaType:Object(y.b)(r.PersonaTypeString)?"Unknown":r.PersonaTypeString,personaControlId:null==r.PersonaId?r.FeedbackId:r.PersonaId.Id,availability:r.Availability,numberOfAvailableTimeSlots:r.NumberOfAvailableTimeSlots,totalNumberOfTimeSlots:r.TotalNumberOfTimeSlots,isPartialAvailability:r.IsPartialAvailability,capacity:r.Capacity}}return null}var b=e(505);function h(r){if(r&&r.DisplayName&&r.PostalAddress){var t=Object(l.c)(r.DisplayName,r.PostalAddress),e=Object(b.a)(r.PostalAddress)&&!Object(y.b)(r.PostalAddress.LocationUri)?{EmailAddress:r.PostalAddress.LocationUri}:null;return{personaId:r.Id,displayName:r.DisplayName,postalAddress:r.PostalAddress,emailAddress:e,displayAddress:Object(l.a)(r.PostalAddress),initials:o(t),textBoyColor:p(t),personaType:Object(b.a)(r.PostalAddress)?"Room":"Unknown",personaControlId:r.DisplayName}}return null}var A=e(0),m=e(1),g=e(4),P=e(10);function v(r,t,e,c){var n=Object(P.a)(),a="",_="",s="";return null!=n&&null!=n.ApplicationSettings&&null!=n.SessionSettings&&null!=n.PolicySettings&&n.PolicySettings.PlacesEnabled&&(a=n.ApplicationSettings.StaticMapUrl,_=n.ApplicationSettings.MapControlKey,s=n.SessionSettings.UserCulture),Object(y.b)(a)||Object(y.b)(_)||Object(y.b)(s)||!r||!t?"":Object(g.b)(a+"?centerPoint={0},{1}&pp={0},{1};51&ms={2},{3}&fmt=png&key={4}&c={5}",r,t,e,c,_,s)}var O=100,j=64,S=64;var w=e(19),L=e(2065),k=e(11),R=e(179),C=function(r){function t(t){var e=r.call(this,t)||this;return e.onCompleteDownload=function(r){e.setState({blobUrl:r}),r?e.requestStatus="success":(e.requestStatus="failed",k.d.warn("getLocationPhoto.downloadLocationPhoto failed"))},e.state={blobUrl:null},e}return A.__extends(t,r),t.prototype.componentDidMount=function(){this.fetchPersonaPhoto(this.props)},t.prototype.UNSAFE_componentWillReceiveProps=function(r){this.fetchPersonaPhoto(r)},t.prototype.fetchPersonaPhoto=function(r){r.locationPersona.postalAddress&&r.locationPersona.postalAddress.Latitude&&r.locationPersona.postalAddress.Longitude&&!Object(y.b)(r.locationPersona.displayName)&&!this.state.blobUrl&&"pending"!=this.requestStatus&&"failed"!=this.requestStatus&&(this.requestStatus="pending",function(r,t){var e="";if(r.postalAddress&&r.postalAddress.Latitude&&r.postalAddress.Longitude&&(e=v(r.postalAddress.Latitude,r.postalAddress.Longitude,j,S)),Object(y.b)(e))t(null);else{var c=new XMLHttpRequest;c.open("GET",e,!0),c.responseType="blob",c.onreadystatechange=function(){if(4===c.readyState){var r=null,e=!1;if(200===c.status){r=c.response;var n=c.getResponseHeader("Content-Type");e=n&&0==n.toLowerCase().indexOf("image")&&r instanceof Blob}var a=void 0;e&&r&&r.size>O&&(a=URL.createObjectURL(r)),t(a)}},c.send()}}(r.locationPersona,this.onCompleteDownload))},t.prototype.render=function(){var r=this.props,t=r.locationPersona,e=r.className,c=r.size,n=r.showPersonaDetails;if(t){var a={};return Object(y.b)(this.state.blobUrl)?R(a,{imageInitials:t.initials,initialsColor:t.textBoyColor}):R(a,{imageUrl:this.state.blobUrl,imageShouldFadeIn:!1}),m.createElement(L.a,A.__assign({className:e,presence:u.b.none,hidePersonaDetails:!n,size:c,text:t.displayName,secondaryText:t.displayAddress},a))}return null},t=A.__decorate([w.observer],t)}(m.Component),N="https://www.bing.com/maps?v=2&rtp=~pos.{0}_{1}_{2}_{3}",U="https://www.bing.com/maps?v=2&rtp=~adr.{0}_{1}";function I(r,t,e,c){return r&&t?Object(g.b)(N,r.toString(),t.toString(),e,c):e?Object(g.b)(U,e,c):null}var T=e(1065),D=e(86),x=e(418);function z(r){var t=r&&r.accessibleText&&r.accessibleText.msColorWhiteBackground||Object(D.g)().themePrimary,e=r?r.calDarker:Object(D.g)().themeDarker;return Object(x.a)({color:t,cursor:"pointer",selectors:{"&:hover":{color:e},"&:focus":{color:e}}})}var E=e(3);function B(r,t){return{Id:t,DisplayName:r,PostalAddress:{LocationSource:"Resource",LocationUri:t,Type:"Business"}}}function F(r){return{EmailAddress:r.PostalAddress.LocationUri,Name:r.DisplayName}}function M(r){return{Id:r,DisplayName:r,PostalAddress:{Type:"Business",LocationSource:"None"}}}function q(r,t,e,c){return r?{PostalAddress:{LocationUri:e,LocationSource:c,Type:t,Street:r.streetAddress,City:r.addressLocality,State:r.addressRegion,Country:r.addressCountry,PostalCode:r.postalCode,PostOfficeBox:r.postOfficeBoxNumber,Longitude:r.longitude,Latitude:r.latitude}}:null}function W(r){return!Object(T.a)(r.PostalAddress)&&/^((http[s]?:\/\/)|(www\.)?){1}[a-z0-9]+([\-\.]{1}[a-z0-9]+)*\.[a-z]{2,6}\b([-a-zA-Z0-9@:*%_\+.~#?&\/\/=]*)/i.test(r.DisplayName)}function H(r){return function(){var t=/^http*/i.test(r)?r:"//"+r;window.open(t,"_blank")}}e.d(t,"s",function(){return J}),e.d(t,"l",function(){return d}),e.d(t,"k",function(){return f}),e.d(t,"j",function(){return h}),e.d(t,"a",function(){return C}),e.d(t,"m",function(){return I}),e.d(t,"b",function(){return v}),e.d(t,"p",function(){return T.a}),e.d(t,"q",function(){return b.a}),e.d(t,"n",function(){return z}),e.d(t,"f",function(){return B}),e.d(t,"c",function(){return c.a}),e.d(t,"d",function(){return c.b}),e.d(t,"e",function(){return c.c}),e.d(t,"o",function(){return F}),e.d(t,"g",function(){return M}),e.d(t,"i",function(){return n}),e.d(t,"h",function(){return q}),e.d(t,"t",function(){return H}),e.d(t,"r",function(){return W});var Y=new E.c(function(){return e.e(926).then(e.bind(null,13994))}),J=new E.b(Y,function(r){return r.createTxpPostalAddressFromLocationPersona})}}]);
//# sourceMappingURL=owa.18.js.map
self.scriptsLoaded['owa.18.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.18.js'] = (new Date()).getTime();