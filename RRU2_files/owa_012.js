self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.ExpandedListSelectionActions~TabView~smime.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[51],{1267:function(t){t.exports={b:"Wba",d:"Xba",c:"Yba",a:"Zba"}},1561:function(t,e,n){"use strict";n.d(e,"a",function(){return i});var i={attachmentTypes:{FILE_ATTACHMENT_TYPE:"FileAttachment:#Exchange",ITEM_ATTACHMENT_TYPE:"ItemAttachment:#Exchange",ITEM_ID_ATTACHMENT_TYPE:"ItemIdAttachment:#Exchange",REFERENCE_ATTACHMENT_TYPE:"ReferenceAttachment:#Exchange"}}},1677:function(t){t.exports={a:"Jba",b:"Kba"}},1777:function(t,e,n){"use strict";n.d(e,"b",function(){return o});var i=n(2),c=n(2108),r={installationStatus:0,isBrowserSupportActiveX:Object(c.a)(),version:""},o=Object(i.createStore)("SmimeStore",r),a=o();e.a=a},1783:function(t,e,n){"use strict";n.d(e,"a",function(){return c});var i=n(1777);function c(){var t=Object(i.b)();return 9==t.installationStatus||6==t.installationStatus}},2108:function(t,e,n){"use strict";n.d(e,"a",function(){return c});var i=n(125);function c(){if(Object(i.h)())try{return new ActiveXObject("htmlfile"),!0}catch(t){return!1}return!1}},2123:function(t,e,n){"use strict";var i=n(2593);e.a=function(t){var e=function(t){return t&&t.Attachments&&t.Attachments.length&&t.Attachments[0]}(t);return Object(i.a)(e)?e:null}},2267:function(t,e,n){"use strict";n.d(e,"a",function(){return r});var i=n(3),c=new i.c(function(){return Promise.all([n.e(591),n.e(508)]).then(n.bind(null,3400))}),r=new i.b(c,function(t){return t.SmimeAdapter})},2467:function(t,e,n){"use strict";n.d(e,"n",function(){return s}),n.d(e,"m",function(){return u}),n.d(e,"j",function(){return l}),n.d(e,"i",function(){return d}),n.d(e,"k",function(){return f}),n.d(e,"f",function(){return h}),n.d(e,"a",function(){return p}),n.d(e,"c",function(){return m}),n.d(e,"g",function(){return b}),n.d(e,"d",function(){return y}),n.d(e,"h",function(){return g}),n.d(e,"e",function(){return v}),n.d(e,"l",function(){return A}),n.d(e,"b",function(){return C});var i=n(2512),c=n(2108),r=n(125),o=n(504),a=n(10);function s(){return Object(r.d)()}function u(t){return function(t){if(t.length<2)return!1;var e=t[0]-parseInt(o.b),n=t[1]-parseInt(o.c);return 0==e&&n>=0}("string"==typeof t?t.split(".").map(function(t){return parseInt(t)}):[])}function l(t){var e="string"==typeof t?t.split("."):[];return e.length&&e[0]!=o.b}function d(){return Object(r.l)()&&(Object(r.h)()&&Object(r.b)()[0]==o.i&&Object(c.a)()||Object(i.a)())}function f(t){return 0!==t}function h(t){var e=[];e.push(t.UserEmailAddress),e.push(t.LogonEmailAddress),e.push(t.UserPrincipalName),e.push(t.UserLegacyExchangeDN);var n=t.UserProxyAddresses;return n&&n.length>0&&n.forEach(function(t){e.indexOf(t)>=0||e.push(t)}),e}function p(t){var e=65001;return t.UseGB18030?e=54936:t.UseISO885915&&(e=28605),e}function m(t){return{AllowUserChoiceOfSigningCertificate:t.AllowUserChoiceOfSigningCertificate,IncludeCertificateChainWithoutRootCertificate:t.IncludeCertificateChainWithoutRootCertificate,IncludeCertificateChainAndRootCertificate:t.IncludeCertificateChainAndRootCertificate,EncryptTemporaryBuffers:t.EncryptTemporaryBuffers,SignedEmailCertificateInclusion:t.SignedEmailCertificateInclusion,IncludeSmimeCapabilitiesInMessage:t.IncludeSMIMECapabilitiesInMessage,CopyRecipientHeaders:t.CopyRecipientHeaders,OnlyUseSmartCard:t.OnlyUseSmartCard,EncryptionAlgorithms:t.EncryptionAlgorithms,SigningAlgorithms:t.SigningAlgorithms}}function b(t,e){var n=Object(a.a)().SmimeAdminSettings.ClearSign;return e||t&&!n?o.e:o.f}function y(t){return btoa(unescape(encodeURIComponent(t)))}function g(t,e){var n=Object(a.a)().SmimeAdminSettings;return t&&e?n.TripleWrapSignedEncryptedMail?14:12:t?n.ClearSign?11:10:6}function P(){return(Math.floor(4026531839*Math.random())+268435456).toString(16)}function v(){return o.m+P()+P()+P()+P()}function A(t,e){return e.IsInline&&-1===t.indexOf(e.ContentId)}function C(){return o.d+P()+"@"+P()+"."+P()}},2512:function(t,e,n){"use strict";n.d(e,"a",function(){return r});var i=n(125),c=n(504);function r(){return Object(i.d)()&&Object(i.k)([c.g])||Object(i.f)()&&Object(i.k)([c.h])}},2593:function(t,e,n){"use strict";n.d(e,"a",function(){return s});var i=n(504),c=function(t,e){return t.substring(0,e.length)===e},r=function(t,e){return t.substring(t.length-e.length)===e},o=function(t){return t.ContentType&&(c(t.ContentType,i.w)||c(t.ContentType,i.l))},a=function(t){return t.ContentType&&t.ContentType===i.j};function s(t){return t&&t.Name&&r(t.Name,i.u)&&(o(t)||a(t))}},492:function(t,e,n){"use strict";function i(t){if(!t)return null;var e=t.lastIndexOf(".");return e>0?t.substr(e).toLowerCase():null}function c(t){var e=i(t);return e?e.replace(".",""):null}var r=n(1267),o=n(4);function a(t){var e;return t>=1073741824?(t/=1073741824,e=Object(o.a)(r.b)):t>=1048576?(t/=1048576,e=Object(o.a)(r.d)):t>=1024?(t/=1024,e=Object(o.a)(r.c)):e=Object(o.a)(r.a),Object(o.b)(e,Math.round(t))}function s(t){return t&&(e=t,(n=l.exec(e))&&n.length>1&&u[n[1].toLowerCase()]);var e,n}var u={"image/bmp":".bmp","image/x-ms-bmp":".bmp","image/gif":".gif","image/jpeg":".jpeg","image/png":".png","image/vnd.adobe.photoshop":".psd","image/tiff":".tiff"},l=/^\s*([^;\s]*)(?:;|\s|$)/;var d=n(77),f=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd"],h=[".tiff",".tif"];function p(t,e,n){void 0===n&&(n=!0);var c=i(t)||s(e);return!!c&&(f.indexOf(c.toLowerCase())>=0||n&&h.indexOf(c.toLowerCase())>=0&&(Object(d.d)()||Object(d.c)()||Object(d.g)()||Object(d.f)()&&!Object(d.i)()))}var m,b=n(6),y=[".pdf",".doc",".docx",".odt",".rtf",".ppt",".pptx",".pptm",".potx",".potm",".pot",".ppxx",".pps",".odp"];function g(t){if(!Object(b.e)("doc-attachment-documentThumbnail"))return!1;var e=i(t);return!!e&&y.indexOf(e.toLowerCase())>=0}function P(t){switch(t){case".doc":case".docm":case".docx":case".dot":case".dotm":case".dotx":case".odt":case".rtf":return m.Word;case".csv":case".ods":case".xls":case".xlsb":case".xlsm":case".xlsx":return m.Excel;case".odp":case".pot":case".potm":case".potx":case".pps":case".ppsm":case".ppsx":case".ppt":case".pptm":case".pptx":return m.PowerPoint;default:return null}}!function(t){t[t.Word=0]="Word",t[t.Excel=1]="Excel",t[t.PowerPoint=2]="PowerPoint"}(m||(m={})),n.d(e,"b",function(){return i}),n.d(e,"c",function(){return c}),n.d(e,"g",function(){return a}),n.d(e,"e",function(){return p}),n.d(e,"f",function(){return g}),n.d(e,"d",function(){return P}),n.d(e,"a",function(){return m})},518:function(t,e,n){"use strict";var i,c,r;n.d(e,"c",function(){return i}),n.d(e,"b",function(){return c}),n.d(e,"a",function(){return r}),function(t){t[t.Compose=0]="Compose",t[t.Extensibility=1]="Extensibility",t[t.ReadingPane=2]="ReadingPane",t[t.Fileshub=3]="Fileshub",t[t.Txp=4]="Txp"}(i||(i={})),function(t){t[t.SmimeSignature=0]="SmimeSignature",t[t.Safety=1]="Safety",t[t.Error=2]="Error",t[t.Info=3]="Info",t[t.Encryption=4]="Encryption",t[t.Translation=5]="Translation",t[t.Sensitivity=6]="Sensitivity"}(c||(c={})),function(t){t[t.Grey=0]="Grey",t[t.Red=1]="Red",t[t.Green=2]="Green",t[t.Yellow=3]="Yellow",t[t.Orange=4]="Orange",t[t.Green20=5]="Green20"}(r||(r={}))},893:function(t,e,n){"use strict";var i;!function(t){t.InfoRestrictedAccess="infoRestrictedAccess"}(i||(i={}));var c=n(75);function r(t){switch(t){case 0:return i.InfoRestrictedAccess;default:return Object(c.a)(t)}}var o=n(10);function a(t){switch(t){case 0:return(e=Object(o.a)().AttachmentPolicy).ConditionalAccessDirectFileAccessOnPrivateComputersBlocked||e.ConditionalAccessDirectFileAccessOnPublicComputersBlocked||e.ConditionalAccessPrintWithoutDownloadBlocked||e.ConditionalAccessWacViewingOnPrivateComputersBlocked||e.ConditionalAccessWacViewingOnPublicComputersBlocked;default:return Object(c.a)(t)}var e}var s=[0],u=n(1561);function l(){return s.filter(a)}function d(t){return t&&t.length>0&&function(t){return t.some(function(t){return!((e=t).IsInline&&!function(t){return t.__type===u.a.attachmentTypes.REFERENCE_ATTACHMENT_TYPE}(e));var e})}(t)?s.filter(a):[]}var f=n(1677),h=n(4),p=n(518);function m(t){switch(t){case i.InfoRestrictedAccess:return{key:"access_control_info_bar",source:p.c.Compose,rank:p.b.Error,messageParts:[Object(h.a)(f.b),(e="https://docs.microsoft.com/en-us/intune-user-help/use-managed-devices-to-get-work-done",{text:Object(h.a)(f.a),action:function(){window.open(e,"_blank")}})],color:p.a.Red};default:return Object(c.a)(t)}var e}var b,y=n(492);!function(t){t[t.Undefined=0]="Undefined",t[t.Block=1]="Block",t[t.ForceSave=2]="ForceSave",t[t.Allow=3]="Allow",t[t.ConditionalAccess=4]="ConditionalAccess"}(b||(b={}));var g=function(){function t(t,e){this.attachmentPolicy=t,this.shouldTreatAsPublicLogon=e,this.shouldTreatAsPublicLogon?this.directFileAccessEnabled=this.attachmentPolicy.DirectFileAccessOnPublicComputersEnabled:this.directFileAccessEnabled=this.attachmentPolicy.DirectFileAccessOnPrivateComputersEnabled,this.saveAttachmentsToCloudEnabled=this.attachmentPolicy.AttachmentDataProviderAvailable&&this.attachmentPolicy.SaveAttachmentsToCloudEnabled,this.convertClassicToCloudyEnabled=this.attachmentPolicy.AttachmentDataProviderAvailable&&this.attachmentPolicy.ReferenceAttachmentsEnabled,this.convertCloudyToClassicEnabled=this.attachmentPolicy.AttachmentDataProviderAvailable&&this.attachmentPolicy.ClassicAttachmentsEnabled,this.fileTypeToPolicyMap=this.createPolicyMap(this.attachmentPolicy.BlockedFileTypes,this.attachmentPolicy.ForceSaveFileTypes,this.attachmentPolicy.AllowedFileTypes),this.mimeTypeToPolicyMap=this.createPolicyMap(this.attachmentPolicy.BlockedMimeTypes,this.attachmentPolicy.ForceSaveMimeTypes,this.attachmentPolicy.AllowedMimeTypes),this.policyForUnknownTypes=b[this.attachmentPolicy.ActionForUnknownFileAndMIMETypes],this.printWithoutDownloadEnabled=this.attachmentPolicy.PrintWithoutDownloadEnabled}return t.prototype.getPolicyInfo=function(t,e,n,i){t&&(t=t.toLowerCase());var c=this.getFileAccessLevel(t,e),r=!1,o=!1,a=!1,s="ReferenceAttachment:#Exchange"===i;return c!==b.Block&&n&&(this.isWacViewingEnabled(t)&&(r=!0),!this.directFileAccessEnabled&&s&&(r=!1),o=this.isForceBrowserViewingFirst(r),r&&null!=this.attachmentPolicy.WacEditableFileTypes&&null!=t&&(a="FileAttachment:#Exchange"===i?this.attachmentPolicy.WacEditableFileTypes.indexOf(t)>=0||this.attachmentPolicy.WacConvertibleFileTypes.indexOf(t)>=0:this.attachmentPolicy.WacEditableFileTypes.indexOf(t)>=0&&-1===this.attachmentPolicy.WacConvertibleFileTypes.indexOf(t)),r||this.directFileAccessEnabled||(c=b.ConditionalAccess)),{directFileAccessEnabled:this.directFileAccessEnabled,level:c,useWac:r,forceBrowserViewingFirst:o,wacEdit:a}},t.prototype.isPdfPreviewEnabled=function(){return this.shouldTreatAsPublicLogon?this.attachmentPolicy.WacViewingOnPublicComputersEnabled||this.attachmentPolicy.DirectFileAccessOnPublicComputersEnabled:this.attachmentPolicy.WacViewingOnPrivateComputersEnabled||this.attachmentPolicy.DirectFileAccessOnPrivateComputersEnabled},t.prototype.getFileAccessLevel=function(t,e){var n=this.fileTypeToPolicyMap[t];if(n||(n=b.Undefined),n===b.Block)return b.Block;var i=this.mimeTypeToPolicyMap[e];return i===b.Block?b.Block:n===b.ForceSave||i===b.ForceSave?b.ForceSave:n===b.Allow||i===b.Allow?b.Allow:this.policyForUnknownTypes},t.prototype.isWacViewingEnabled=function(t){return(this.shouldTreatAsPublicLogon?this.attachmentPolicy.WacViewingOnPublicComputersEnabled:this.attachmentPolicy.WacViewingOnPrivateComputersEnabled)&&this.attachmentPolicy.WacViewableFileTypes.indexOf(t)>=0},t.prototype.isForceBrowserViewingFirst=function(t){return!!t&&(this.shouldTreatAsPublicLogon?this.attachmentPolicy.ForceWacViewingFirstOnPublicComputers:this.attachmentPolicy.ForceWacViewingFirstOnPrivateComputers)},t.prototype.addPolicyIntoMap=function(t,e,n){e&&e.forEach(function(e){t[e]=n})},t.prototype.createPolicyMap=function(t,e,n){var i={};return this.addPolicyIntoMap(i,n,b.Allow),this.addPolicyIntoMap(i,e,b.ForceSave),this.addPolicyIntoMap(i,t,b.Block),i},t}(),P=null,v=null;function A(){if(!P){var t=Object(o.a)(),e=t.AttachmentPolicy,n=t.SessionSettings.IsPublicLogon||t.PublicComputersDetectionEnabled&&t.SessionSettings.IsPublicComputerSession;P=new g(e,n),n&&(v=P)}return P}function C(t,e){var n=Object(y.b)(t.Name),i=t.ContentType;return A().getPolicyInfo(n,i,e,t.__type)}function E(t,e){var n=Object(y.b)(t.Name),i=t.ContentType;return function(){if(!v){var t=Object(o.a)();if(t.SessionSettings.IsPublicLogon||t.PublicComputersDetectionEnabled&&t.SessionSettings.IsPublicComputerSession)return A();v=new g(t.AttachmentPolicy,!0)}return v}().getPolicyInfo(n,i,e,t.__type)}function T(t,e,n,i){if(i)return!1;var c=C(t,!0),r=A();return c.level!==b.Block&&r.saveAttachmentsToCloudEnabled&&!e&&n}n.d(e,"a",function(){return s}),n.d(e,"i",function(){return m}),n.d(e,"b",function(){return i}),n.d(e,"d",function(){return l}),n.d(e,"e",function(){return d}),n.d(e,"h",function(){return r}),n.d(e,"j",function(){return T}),n.d(e,"c",function(){return b}),n.d(e,"f",function(){return C}),n.d(e,"g",function(){return E}),n.d(e,"k",function(){return A})}}]);
//# sourceMappingURL=owa.ExpandedListSelectionActions~TabView~smime.js.map
self.scriptsLoaded['owa.ExpandedListSelectionActions~TabView~smime.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.ExpandedListSelectionActions~TabView~smime.js'] = (new Date()).getTime();